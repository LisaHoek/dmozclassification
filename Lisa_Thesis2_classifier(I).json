{"paragraphs":[{"text":"%pyspark\nspark.sql(\"DROP TABLE IF EXISTS cccc\")\nspark.sql(\n    \"CREATE TABLE cccc(categories STRING, title STRING, url STRING, cleaned_content STRING, maincategory STRING) \" +\n    \"USING parquet PARTITIONED BY(maincategory) CLUSTERED BY(categories) INTO 12 BUCKETS \" +\n    \"LOCATION 'hdfs:/user/arjen/cccc'\"\n)\nspark.sql(\"MSCK REPAIR TABLE cccc\")","user":"lisa","dateUpdated":"2021-01-15T11:44:12+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=2","$$hashKey":"object:2514"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608035171689_1330727932","id":"paragraph_1608035171689_1330727932","dateCreated":"2020-12-15T12:26:11+0000","dateStarted":"2021-01-15T11:44:12+0000","dateFinished":"2021-01-15T11:44:24+0000","status":"FINISHED","focus":true,"$$hashKey":"object:588"},{"text":"%pyspark\ndf = spark.table(\"CCCC\")\ndf.show()","user":"lisa","dateUpdated":"2021-01-15T11:46:38+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=3","$$hashKey":"object:2582"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608035211269_984239908","id":"paragraph_1608035211269_984239908","dateCreated":"2020-12-15T12:26:51+0000","dateStarted":"2021-01-15T11:46:38+0000","dateFinished":"2021-01-15T11:46:52+0000","status":"FINISHED","$$hashKey":"object:589","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+------------+\n|          categories|               title|                 url|     cleaned_content|maincategory|\n+--------------------+--------------------+--------------------+--------------------+------------+\n|Top/Computers/Sof...|    A Real Validator|http://arealvalid...|real validator tr...|   Computers|\n|Top/Computers/Sys...|AROS: Amiga Resea...|http://aros.sourc...|aros research ope...|   Computers|\n|Top/Computers/Sof...|            Homebrew|     http://brew.sh/|homebrew missing ...|   Computers|\n|Top/Computers/Pro...|            SQLiteDB|http://code.jense...|sqlitedb sqlite p...|   Computers|\n|Top/Computers/Pro...|SQL Injection - C...|http://shiflett.o...|sql injection chr...|   Computers|\n|Top/Computers/Sof...|      Alien Software|http://www.aliens...|health network he...|   Computers|\n|Top/Computers/Sof...|United Systems Te...|http://www.asyst3...|home ddrjquery wi...|   Computers|\n|Top/Computers/Rob...|Chicago Area Robo...|http://www.chibot...|chibots < >< cdat...|   Computers|\n|Top/Computers/Sof...|CreativeMac: Core...|http://www.creati...|corel painter ix ...|   Computers|\n|Top/Computers/Mul...|      SoundConverter|http://www.dekort...|                    |   Computers|\n|Top/Computers/Sof...|    Desktop Icon Toy|http://www.idesks...|desktop icon toy ...|   Computers|\n|Top/Computers/Sof...|     Internet-Drafts|http://www.ietf.o...|internet draft d ...|   Computers|\n|Top/Computers/Sof...|Raise the Red Fla...|http://www.linuxj...|window nreum nreu...|   Computers|\n|Top/Computers/Pro...|     LK Bin Database|http://www.lksoft...|function w c { w ...|   Computers|\n|Top/Computers/Int...|    Response-O-Matic|http://www.respon...|create online con...|   Computers|\n|Top/Computers/Sof...|    SoftwareArchives|http://www.softwa...|softwarearchives ...|   Computers|\n|Top/Computers/Int...|          TweetsWind|http://www.tweets...|tweetswind displa...|   Computers|\n|Top/Computers/Pro...|Jini Security : A...|http://citeseerx....|citeseerx securit...|   Computers|\n|Top/Computers/Pro...|             WebMail|http://jwebmail.s...|             webmail|   Computers|\n|Top/Computers/Sof...|               VVCap|   http://vvcap.com/|vvcap screenshots...|   Computers|\n+--------------------+--------------------+--------------------+--------------------+------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\ndf.count()","user":"lisa","dateUpdated":"2021-01-15T11:46:41+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"514506\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=4","$$hashKey":"object:2617"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609248892111_-450385923","id":"paragraph_1609248892111_-450385923","dateCreated":"2020-12-29T13:34:52+0000","dateStarted":"2021-01-15T11:46:41+0000","dateFinished":"2021-01-15T11:46:54+0000","status":"FINISHED","$$hashKey":"object:590"},{"text":"%pyspark\nspark.sql(\"SELECT maincategory FROM CCCC GROUP BY maincategory\").count()","user":"lisa","dateUpdated":"2020-12-29T13:30:18+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"13\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=484","$$hashKey":"object:1407"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609248607139_2124632467","id":"paragraph_1609248607139_2124632467","dateCreated":"2020-12-29T13:30:07+0000","dateStarted":"2020-12-29T13:30:18+0000","dateFinished":"2020-12-29T13:30:19+0000","status":"FINISHED","$$hashKey":"object:592"},{"text":"%pyspark\nspark.sql(\"SELECT maincategory, count(maincategory) AS count FROM CCCC GROUP BY maincategory ORDER BY count DESC\").show()","user":"lisa","dateUpdated":"2021-01-15T11:51:58+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=15","$$hashKey":"object:3130"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1610711223373_1795475343","id":"paragraph_1610711223373_1795475343","dateCreated":"2021-01-15T11:47:03+0000","status":"FINISHED","focus":true,"$$hashKey":"object:2622","dateFinished":"2021-01-15T11:52:11+0000","dateStarted":"2021-01-15T11:51:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+\n|maincategory|count|\n+------------+-----+\n|     Society|91861|\n|        Arts|87685|\n|    Business|77658|\n|  Recreation|39940|\n|   Computers|39180|\n|     Science|38795|\n|      Sports|37373|\n|    Shopping|33588|\n|   Reference|21179|\n|      Health|20423|\n|       Games|14221|\n|        Home| 9175|\n|        News| 3428|\n+------------+-----+\n\n"}]}},{"text":"%pyspark\nindexer = StringIndexer(inputCol=\"maincategory\", outputCol=\"label\", handleInvalid=\"keep\")\ntrainpl = Pipeline(stages=[indexer])\n\nindexermodel = trainpl.fit(df)\nd = indexermodel.transform(df)\nd.show()","user":"lisa","dateUpdated":"2021-01-04T11:12:03+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+------------+-----+\n|          categories|               title|                 url|     cleaned_content|maincategory|label|\n+--------------------+--------------------+--------------------+--------------------+------------+-----+\n|Top/Computers/Sof...|    A Real Validator|http://arealvalid...|real validator tr...|   Computers|  4.0|\n|Top/Computers/Sys...|AROS: Amiga Resea...|http://aros.sourc...|aros research ope...|   Computers|  4.0|\n|Top/Computers/Sof...|            Homebrew|     http://brew.sh/|homebrew missing ...|   Computers|  4.0|\n|Top/Computers/Pro...|            SQLiteDB|http://code.jense...|sqlitedb sqlite p...|   Computers|  4.0|\n|Top/Computers/Pro...|SQL Injection - C...|http://shiflett.o...|sql injection chr...|   Computers|  4.0|\n|Top/Computers/Sof...|      Alien Software|http://www.aliens...|health network he...|   Computers|  4.0|\n|Top/Computers/Sof...|United Systems Te...|http://www.asyst3...|home ddrjquery wi...|   Computers|  4.0|\n|Top/Computers/Rob...|Chicago Area Robo...|http://www.chibot...|chibots < >< cdat...|   Computers|  4.0|\n|Top/Computers/Sof...|CreativeMac: Core...|http://www.creati...|corel painter ix ...|   Computers|  4.0|\n|Top/Computers/Mul...|      SoundConverter|http://www.dekort...|                    |   Computers|  4.0|\n|Top/Computers/Sof...|    Desktop Icon Toy|http://www.idesks...|desktop icon toy ...|   Computers|  4.0|\n|Top/Computers/Sof...|     Internet-Drafts|http://www.ietf.o...|internet draft d ...|   Computers|  4.0|\n|Top/Computers/Sof...|Raise the Red Fla...|http://www.linuxj...|window nreum nreu...|   Computers|  4.0|\n|Top/Computers/Pro...|     LK Bin Database|http://www.lksoft...|function w c { w ...|   Computers|  4.0|\n|Top/Computers/Int...|    Response-O-Matic|http://www.respon...|create online con...|   Computers|  4.0|\n|Top/Computers/Sof...|    SoftwareArchives|http://www.softwa...|softwarearchives ...|   Computers|  4.0|\n|Top/Computers/Int...|          TweetsWind|http://www.tweets...|tweetswind displa...|   Computers|  4.0|\n|Top/Computers/Pro...|Jini Security : A...|http://citeseerx....|citeseerx securit...|   Computers|  4.0|\n|Top/Computers/Pro...|             WebMail|http://jwebmail.s...|             webmail|   Computers|  4.0|\n|Top/Computers/Sof...|               VVCap|   http://vvcap.com/|vvcap screenshots...|   Computers|  4.0|\n+--------------------+--------------------+--------------------+--------------------+------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=258","$$hashKey":"object:1458"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=259","$$hashKey":"object:1459"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608564959859_1664349283","id":"paragraph_1608564959859_1664349283","dateCreated":"2020-12-21T15:35:59+0000","dateStarted":"2020-12-27T15:44:57+0000","dateFinished":"2020-12-27T15:45:00+0000","status":"ABORT","$$hashKey":"object:593"},{"text":"%pyspark\nsplits = d.randomSplit([0.75, 0.25], 24)\ntrainDF = splits[0]\ntestDF = splits[1]","user":"lisa","dateUpdated":"2021-01-04T11:12:06+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1606312510272_-502942537","id":"paragraph_1606305261163_-476012457","dateCreated":"2020-11-25T13:55:10+0000","dateStarted":"2020-12-27T15:45:00+0000","dateFinished":"2020-12-27T15:45:00+0000","status":"ABORT","$$hashKey":"object:594"},{"text":"%pyspark\ntrainDF.show()","user":"lisa","dateUpdated":"2020-12-27T15:45:03+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+------------+-----+\n|          categories|               title|                 url|     cleaned_content|maincategory|label|\n+--------------------+--------------------+--------------------+--------------------+------------+-----+\n|Top/Arts/Animatio...| El Cesto de Papeles|http://www.angelf...|el cesto de papel...|        Arts|  1.0|\n|Top/Arts/Animatio...|Endy-chan's Anime...|http://www.angelf...|endy chan anime h...|        Arts|  1.0|\n|Top/Arts/Animatio...|  Eternal Collective|http://eternalevi...|gone figure want ...|        Arts|  1.0|\n|Top/Arts/Animatio...|    Everything Anime|http://www.angelf...|everything anime ...|        Arts|  1.0|\n|Top/Arts/Animatio...| Fandub Voice Acting|http://utenaangel...|fan voice acting ...|        Arts|  1.0|\n|Top/Arts/Animatio...|Swift Foot Produc...|http://www.angelf...|summer page owner...|        Arts|  1.0|\n|Top/Arts/Animatio...|        Genesoul.net|http://www.geneso...|art stuart ng hom...|        Arts|  1.0|\n|Top/Arts/Animatio...|     Rays of Joy Jam|http://lazy.evils...|bendyzoo document...|        Arts|  1.0|\n|Top/Arts/Animatio...|Under the Sakura ...|http://underthesa...|sakura tree sign ...|        Arts|  1.0|\n|Top/Arts/Animatio...|Utena's Fanart Ga...|http://revogutena...|utena fanart gall...|        Arts|  1.0|\n|Top/Arts/Animatio...|Jada's Fanfiction...|http://www.angelf...|owneriq var oiq p...|        Arts|  1.0|\n|Top/Arts/Animatio...|Neoqueen's Fanfic...|http://www.angelf...|owneriq var oiq p...|        Arts|  1.0|\n|Top/Arts/Animatio...|      Blackmoontides|http://www.blackm...|blackmoontides ~ ...|        Arts|  1.0|\n|Top/Arts/Animatio...|             Blaster|http://c30blaster...|< body { scrollba...|        Arts|  1.0|\n|Top/Arts/Animatio...|    Galaxy Anime.org|http://sathotmis9...|g l x n e r g v 6...|        Arts|  1.0|\n|Top/Arts/Animatio...|    Garnet's Sanctum|http://cardinalga...|garnet sanctum ho...|        Arts|  1.0|\n|Top/Arts/Animatio...|Greenbean's Home ...|http://gbeans.tyr...|greenbean home pa...|        Arts|  1.0|\n|Top/Arts/Animatio...|         Greg's Page|http://grekomon.f...|www grekomon free...|        Arts|  1.0|\n|Top/Arts/Animatio...|Junboy's Cantelou...|http://junboy0.tr...|home page radical...|        Arts|  1.0|\n|Top/Arts/Animatio...|         K-Bug Anime|http://capsule-j....|k bug anime owner...|        Arts|  1.0|\n+--------------------+--------------------+--------------------+--------------------+------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=260","$$hashKey":"object:1559"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1606312841446_-2144843225","id":"paragraph_1606312841446_-2144843225","dateCreated":"2020-11-25T14:00:41+0000","dateStarted":"2020-12-27T15:45:03+0000","dateFinished":"2020-12-27T15:45:04+0000","status":"FINISHED","$$hashKey":"object:595"},{"text":"%pyspark\nfrom pyspark.ml import Pipeline, PipelineModel\nfrom pyspark.ml.classification import LogisticRegression\nfrom pyspark.ml.feature import HashingTF, Tokenizer, StringIndexer, IndexToString\n\n# Configure an ML pipeline\ntokenizer = Tokenizer(inputCol=\"cleaned_content\", outputCol=\"words\")\nhashingTF = HashingTF(inputCol=tokenizer.getOutputCol(), outputCol=\"features\")\nlr = LogisticRegression(maxIter=10, regParam=0.001)\npipeline = Pipeline(stages=[tokenizer, hashingTF, lr])\n\n# Fit the pipeline to training documents.\nmodel = pipeline.fit(trainDF)","user":"lisa","dateUpdated":"2021-01-04T11:12:13+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=261","$$hashKey":"object:1610"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=262","$$hashKey":"object:1611"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=263","$$hashKey":"object:1612"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=264","$$hashKey":"object:1613"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=265","$$hashKey":"object:1614"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=266","$$hashKey":"object:1615"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=267","$$hashKey":"object:1616"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=268","$$hashKey":"object:1617"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=269","$$hashKey":"object:1618"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=270","$$hashKey":"object:1619"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=271","$$hashKey":"object:1620"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=272","$$hashKey":"object:1621"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=273","$$hashKey":"object:1622"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1606312510272_1668934461","id":"paragraph_1606248095976_-1153341034","dateCreated":"2020-11-25T13:55:10+0000","dateStarted":"2020-12-27T15:45:10+0000","dateFinished":"2020-12-27T15:46:24+0000","status":"ABORT","$$hashKey":"object:596"},{"text":"%pyspark\n# Now we can optionally save the fitted pipeline to disk\nmodel.write().overwrite().save(\"/tmp/pyspark-logistic-regression-model\")\n\n# And load it back in during production\nsameModel = PipelineModel.load(\"/tmp/pyspark-logistic-regression-model\")","user":"lisa","dateUpdated":"2021-01-04T11:12:17+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1606312510272_-1681231370","id":"paragraph_1606305708742_17736437","dateCreated":"2020-11-25T13:55:10+0000","dateStarted":"2020-12-16T15:16:15+0000","dateFinished":"2020-12-16T15:16:28+0000","status":"ABORT","$$hashKey":"object:597"},{"text":"%pyspark\nfrom pyspark.ml.feature import StringIndexerModel\n\n# Annoying put important value to convert the labels back to its corresponding category\nlabels= (indexermodel.stages[0]).labels\nprint(labels)","user":"lisa","dateUpdated":"2020-12-27T15:45:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Society', 'Arts', 'Business', 'Recreation', 'Computers', 'Science', 'Sports', 'Shopping', 'Reference', 'Health', 'Games', 'Home', 'News']\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1606312510272_1051318249","id":"paragraph_1606301372436_-1545138065","dateCreated":"2020-11-25T13:55:10+0000","dateStarted":"2020-12-27T15:45:14+0000","dateFinished":"2020-12-27T15:46:24+0000","status":"FINISHED","$$hashKey":"object:598"},{"text":"%pyspark\n# Make predictions on test documents.\ntestSet = model.transform(testDF)\n\nconverter = IndexToString(inputCol=\"prediction\", outputCol=\"predicted_category\", labels=labels)\nconverted = converter.transform(testSet)\nconverted.select(\"maincategory\",\"title\",\"url\",\"words\",\"predicted_category\").show()","user":"lisa","dateUpdated":"2020-12-27T15:45:17+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":534,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+--------------------+------------------+\n|maincategory|               title|                 url|               words|predicted_category|\n+------------+--------------------+--------------------+--------------------+------------------+\n|        Arts|          Eta - Naru|http://eta-naru.t...|[link, {, text, d...|              Arts|\n|        Arts|The eMotions's An...|http://eavss.trip...|[h1, {, color, 1f...|              Arts|\n|        Arts|            BlackCat|http://auroreblac...|[blackcat, artwor...|              Arts|\n|        Arts|Anime Art Goddess...|http://www.webrin...|[1, 10, 12, next,...|              Arts|\n|        Arts|        Galaxy Anime|http://www.angelf...|[ga, moretitle, >...|              Arts|\n|        Arts|Gally's Anime Han...|http://www.angelf...|[gally, anime, ha...|              Arts|\n|        Arts|Giovanni's Evil E...|http://www.angelf...|[owneriq, var, oi...|              Arts|\n|        Arts|     The Girl's Site|http://girlsite.5...|[free, web, site,...|              Arts|\n|        Arts|Japanimation Infa...|http://www.angelf...|[welcome, japanim...|              Arts|\n|        Arts|                Kage|http://www.angelf...|[<, a, {, text, d...|              Arts|\n|        Arts|           KayJayGee|http://www.angelf...|[kayjaygee, owner...|              Arts|\n|        Arts|Keiko's J-pop and...|http://www.angelf...|[hi, ^, ^, welcom...|              Arts|\n|        Arts|Kerenza's Site, o...|http://www.angelf...|[kerenza, site, e...|              Arts|\n|        Arts|Ki Tenno's House ...|http://www.angelf...|[ki, tenno, house...|              Arts|\n|        Arts|    Kim's Anime Page|http://animegurl2...|[kim, anime, page...|              Arts|\n|        Arts|           PBX Anime|http://www.pbxani...|[pbx, anime, com,...|              Arts|\n|        Arts|   Tower of Tinabula|http://angiwyn.tr...|[tower, tinabula,...|              Arts|\n|        Arts|       Animation MP3|http://luisangel....|[animania, v8, ne...|           Society|\n|        Arts|Josh's Anime Musi...|http://josh.agarr...|[josh, anime, she...|          Business|\n|        Arts|Mitsuishi Kotono ...|http://www.seiyuu...|[mitsuishi, koton...|              Arts|\n+------------+--------------------+--------------------+--------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=274","$$hashKey":"object:1811"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608035708276_-1631112905","id":"paragraph_1608035708276_-1631112905","dateCreated":"2020-12-15T12:35:08+0000","dateStarted":"2020-12-27T15:46:24+0000","dateFinished":"2020-12-27T15:46:26+0000","status":"FINISHED","$$hashKey":"object:599"},{"text":"%pyspark\nconverted.sample(False, 0.0003).select(\"maincategory\",\"url\",\"words\",\"predicted_category\").withColumn(\"correct\",col(\"maincategory\")==col(\"predicted_category\")).show()","user":"lisa","dateUpdated":"2020-12-27T15:57:06+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":474,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+------------------+-------+\n|maincategory|                 url|               words|predicted_category|correct|\n+------------+--------------------+--------------------+------------------+-------+\n|   Computers|http://www.the-sz...|[royal, read, r, ...|         Computers|   true|\n|     Society|http://ndpr.nd.ed...|[window, nreum, n...|           Society|   true|\n|      Sports|http://www.thurle...|[thurles, golf, c...|              Arts|  false|\n|      Sports|http://redwoodfal...|[redwood, fall, g...|         Reference|  false|\n|        Arts|http://www.imdb.c...|[var, ue, t0, win...|              Arts|   true|\n|   Reference|http://www.hangar...|[function, id, {,...|        Recreation|  false|\n|     Science|http://www.ucmp.b...|[introduction, sc...|           Science|   true|\n|    Shopping|http://www.finess...|[finesse, pinstri...|        Recreation|  false|\n|    Business|http://www.mcleod...|[trucking, softwa...|          Business|   true|\n|   Computers|http://www.newmil...|[new, millennium,...|         Computers|   true|\n|        News|http://www.newsqu...|[wonderpluginslid...|            Sports|  false|\n|  Recreation|http://webspace.w...|[radio, controlle...|        Recreation|   true|\n|   Reference|http://cos.arizon...|[ua, college, sci...|           Science|  false|\n|    Shopping|http://www.metros...|[metro, swim, sho...|          Shopping|   true|\n|        Arts|http://www.imdb.c...|[var, ue, t0, win...|              Arts|   true|\n|        Arts|http://www.fabulo...|[fabulous, emma, ...|           Society|  false|\n|   Computers|http://www.whetst...|[online, classroo...|          Business|  false|\n|     Science|http://www.outlaw...|[geometrical, dim...|           Science|   true|\n|  Recreation|http://people.del...|[mcconaughy, bird...|        Recreation|   true|\n|    Shopping|http://www.aurell...|[fantasy, art, ni...|              Arts|  false|\n+------------+--------------------+--------------------+------------------+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=312","$$hashKey":"object:1862"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=313","$$hashKey":"object:1863"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=314","$$hashKey":"object:1864"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608116808031_-1398199692","id":"paragraph_1608116808031_-1398199692","dateCreated":"2020-12-16T11:06:48+0000","dateStarted":"2020-12-27T15:57:06+0000","dateFinished":"2020-12-27T15:57:11+0000","status":"FINISHED","$$hashKey":"object:600"},{"text":"%pyspark\nfrom pyspark.mllib.evaluation import MulticlassMetrics\nfrom pyspark.sql.functions import col\n\npredictionAndLabels = testSet.select(col(\"prediction\"),col(\"label\")).rdd\nmetrics = MulticlassMetrics(predictionAndLabels)","user":"lisa","dateUpdated":"2020-12-27T15:48:24+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1606316071641_1150212398","id":"paragraph_1606316071641_1150212398","dateCreated":"2020-11-25T14:54:31+0000","dateStarted":"2020-12-27T15:48:24+0000","dateFinished":"2020-12-27T15:48:24+0000","status":"FINISHED","$$hashKey":"object:602"},{"text":"%pyspark\ndict = d.select(\"label\",\"maincategory\").distinct().rdd.collectAsMap()\nprint(dict)","user":"lisa","dateUpdated":"2020-12-21T16:57:17+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{8.0: 'Reference', 11.0: 'Home', 9.0: 'Health', 7.0: 'Shopping', 6.0: 'Sports', 12.0: 'News', 3.0: 'Recreation', 4.0: 'Computers', 5.0: 'Science', 0.0: 'Society', 10.0: 'Games', 2.0: 'Business', 1.0: 'Arts'}\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=76","$$hashKey":"object:2058"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608563122641_1638931330","id":"paragraph_1608563122641_1638931330","dateCreated":"2020-12-21T15:05:22+0000","dateStarted":"2020-12-21T16:57:17+0000","dateFinished":"2020-12-21T16:57:30+0000","status":"FINISHED","$$hashKey":"object:604"},{"text":"%pyspark\n\n# Overall statistics\nprecision = metrics.precision()\nrecall = metrics.recall()\nf1Score = metrics.fMeasure()\nprint(\"Summary Stats\")\nprint(\"Precision = %s\" % precision)\nprint(\"Recall = %s\" % recall)\nprint(\"F1 Score = %s\" % f1Score)\n\n# Statistics by class\nclasses = d.select(\"label\").rdd.flatMap(lambda x:x).distinct().collect()\nfor label in sorted(classes):\n    print(\"Class %s precision = %s\" % (dict.get(label), metrics.precision(label)))\n    print(\"Class %s recall = %s\" % (dict.get(label), metrics.recall(label)))\n    print(\"Class %s F1 Measure = %s\" % (dict.get(label), metrics.fMeasure(label, beta=1.0)))\n    \n# Weighted statsclas\nprint(\"Weighted recall = %s\" % metrics.weightedRecall)\nprint(\"Weighted precision = %s\" % metrics.weightedPrecision)\nprint(\"Weighted F(1) Score = %s\" % metrics.weightedFMeasure())\nprint(\"Weighted F(0.5) Score = %s\" % metrics.weightedFMeasure(beta=0.5))\nprint(\"Weighted false positive rate = %s\" % metrics.weightedFalsePositiveRate)","user":"lisa","dateUpdated":"2020-12-21T16:03:08+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Summary Stats\nPrecision = 0.5396448506457615\nRecall = 0.5396448506457615\nF1 Score = 0.5396448506457615\nClass Society precision = 0.49717268377555457\nClass Society recall = 0.6953158946728079\nClass Society F1 Measure = 0.5797826086956521\nClass Arts precision = 0.5174616116320152\nClass Arts recall = 0.6995499219252319\nClass Arts F1 Measure = 0.5948838117555164\nClass Business precision = 0.42972636815920395\nClass Business recall = 0.6397160931954945\nClass Business F1 Measure = 0.5141050282100563\nClass Recreation precision = 0.6153719552337064\nClass Recreation recall = 0.3742742742742743\nClass Recreation F1 Measure = 0.4654549981327026\nClass Computers precision = 0.6842105263157895\nClass Computers recall = 0.4646661204424416\nClass Computers F1 Measure = 0.5534614211649894\nClass Science precision = 0.6685074155885137\nClass Science recall = 0.4414461346113774\nClass Science F1 Measure = 0.5317520080321285\nClass Sports precision = 0.773841961852861\nClass Sports recall = 0.49177489177489175\nClass Sports F1 Measure = 0.6013763896241398\nClass Shopping precision = 0.6051130776794493\nClass Shopping recall = 0.3616171112939241\nClass Shopping F1 Measure = 0.45269972046491097\nClass Reference precision = 0.5809338521400779\nClass Reference recall = 0.2796403820940251\nClass Reference F1 Measure = 0.3775445694778101\nClass Health precision = 0.7334354653389505\nClass Health recall = 0.37534300274402194\nClass Health F1 Measure = 0.4965642421885129\nClass Games precision = 0.8268733850129198\nClass Games recall = 0.35965158752458554\nClass Games F1 Measure = 0.501272762874486\nClass Home precision = 0.7229800629590766\nClass Home recall = 0.30622222222222223\nClass Home F1 Measure = 0.4302216671870122\nClass News precision = 0.6699507389162561\nClass News recall = 0.15614236509758897\nClass News F1 Measure = 0.2532588454376164\nWeighted recall = 0.5396448506457614\nWeighted precision = 0.5807938914427939\nWeighted F(1) Score = 0.5323351545556393\nWeighted F(0.5) Score = 0.552281495703739\nWeighted false positive rate = 0.07978241125860192\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=74","$$hashKey":"object:2109"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608562469466_2067663985","id":"paragraph_1608562469466_2067663985","dateCreated":"2020-12-21T14:54:29+0000","dateStarted":"2020-12-21T15:51:44+0000","dateFinished":"2020-12-21T15:51:48+0000","status":"FINISHED","$$hashKey":"object:605"},{"text":"%pyspark\nconfusionMatrix = metrics.confusionMatrix()\nprint(confusionMatrix)","user":"lisa","dateUpdated":"2020-12-21T16:19:27+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DenseMatrix([[1.6002e+04, 2.8530e+03, 2.2920e+03, 3.5400e+02, 3.0100e+02,\n              3.8000e+02, 1.7700e+02, 2.1300e+02, 2.1300e+02, 1.5100e+02,\n              2.5000e+01, 4.4000e+01, 9.0000e+00],\n             [2.9250e+03, 1.5232e+04, 2.0880e+03, 3.3300e+02, 2.3300e+02,\n              1.8700e+02, 1.8500e+02, 2.8000e+02, 1.6000e+02, 3.8000e+01,\n              6.8000e+01, 2.7000e+01, 1.8000e+01],\n             [2.6610e+03, 1.9900e+03, 1.2438e+04, 3.0900e+02, 4.2300e+02,\n              3.5200e+02, 1.7000e+02, 7.5500e+02, 1.2900e+02, 1.4300e+02,\n              2.2000e+01, 4.4000e+01, 7.0000e+00],\n             [1.9150e+03, 1.7920e+03, 1.6020e+03, 3.7390e+03, 1.5400e+02,\n              1.9700e+02, 1.8900e+02, 2.3700e+02, 4.3000e+01, 5.9000e+01,\n              2.3000e+01, 3.5000e+01, 5.0000e+00],\n             [1.1270e+03, 1.1020e+03, 2.2700e+03, 1.1800e+02, 4.5370e+03,\n              2.7800e+02, 6.7000e+01, 1.0800e+02, 6.7000e+01, 2.9000e+01,\n              4.5000e+01, 1.3000e+01, 3.0000e+00],\n             [1.5490e+03, 8.7300e+02, 1.8330e+03, 1.8200e+02, 3.7600e+02,\n              4.2370e+03, 6.4000e+01, 8.6000e+01, 2.7400e+02, 7.7000e+01,\n              1.7000e+01, 2.7000e+01, 3.0000e+00],\n             [1.4230e+03, 1.4550e+03, 1.1490e+03, 3.4400e+02, 6.8000e+01,\n              5.4000e+01, 4.5440e+03, 9.0000e+01, 5.5000e+01, 2.4000e+01,\n              1.8000e+01, 8.0000e+00, 8.0000e+00],\n             [9.5000e+02, 1.4210e+03, 2.2890e+03, 2.9200e+02, 1.0100e+02,\n              8.7000e+01, 1.2200e+02, 3.0770e+03, 2.4000e+01, 8.4000e+01,\n              1.9000e+01, 4.1000e+01, 2.0000e+00],\n             [1.2370e+03, 6.5900e+02, 1.1230e+03, 9.8000e+01, 1.3800e+02,\n              2.8900e+02, 1.4900e+02, 7.5000e+01, 1.4930e+03, 5.2000e+01,\n              1.3000e+01, 8.0000e+00, 5.0000e+00],\n             [1.2360e+03, 4.9600e+02, 9.9000e+02, 8.6000e+01, 4.2000e+01,\n              1.2300e+02, 6.9000e+01, 5.8000e+01, 6.3000e+01, 1.9150e+03,\n              6.0000e+00, 1.6000e+01, 2.0000e+00],\n             [4.4600e+02, 9.8100e+02, 3.8200e+02, 9.2000e+01, 2.0200e+02,\n              4.8000e+01, 6.3000e+01, 4.2000e+01, 1.3000e+01, 9.0000e+00,\n              1.2800e+03, 1.0000e+00, 0.0000e+00],\n             [4.4700e+02, 4.1400e+02, 3.2800e+02, 1.1100e+02, 3.9000e+01,\n              8.6000e+01, 2.5000e+01, 5.9000e+01, 1.4000e+01, 2.4000e+01,\n              9.0000e+00, 6.8900e+02, 5.0000e+00],\n             [2.6800e+02, 1.6800e+02, 1.6000e+02, 1.8000e+01, 1.7000e+01,\n              2.0000e+01, 4.8000e+01, 5.0000e+00, 2.2000e+01, 6.0000e+00,\n              3.0000e+00, 0.0000e+00, 1.3600e+02]])\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608566045195_1326606234","id":"paragraph_1608566045195_1326606234","dateCreated":"2020-12-21T15:54:05+0000","dateStarted":"2020-12-21T16:19:27+0000","dateFinished":"2020-12-21T16:19:27+0000","status":"FINISHED","$$hashKey":"object:606"},{"text":"%pyspark\nprint(sorted(classes))","user":"lisa","dateUpdated":"2020-12-21T17:04:07+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608566727656_-934546122","id":"paragraph_1608566727656_-934546122","dateCreated":"2020-12-21T16:05:27+0000","dateStarted":"2020-12-21T17:04:07+0000","dateFinished":"2020-12-21T17:04:07+0000","status":"FINISHED","$$hashKey":"object:607"}],"name":"Lisa_Thesis2_classifier(I)","id":"2FRFXM6HX","defaultInterpreterGroup":"spark","version":"0.9.0-SNAPSHOT","permissions":{"owners":["lisa"]},"noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/Lisa_Thesis2_classifier(I)"}