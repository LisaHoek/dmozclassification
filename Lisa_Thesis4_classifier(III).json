{"paragraphs":[{"text":"%pyspark\nspark.sql(\"DROP TABLE IF EXISTS cccc\")\nspark.sql(\n    \"CREATE TABLE cccc(categories STRING, title STRING, url STRING, cleaned_content STRING, maincategory STRING) \" +\n    \"USING parquet PARTITIONED BY(maincategory) CLUSTERED BY(categories) INTO 12 BUCKETS \" +\n    \"LOCATION 'hdfs:/user/arjen/cccc'\"\n)\nspark.sql(\"MSCK REPAIR TABLE cccc\")","user":"lisa","dateUpdated":"2021-01-15T11:54:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=16","$$hashKey":"object:1609"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341622_-1348968792","id":"paragraph_1608035171689_1330727932","dateCreated":"2020-12-22T11:59:01+0000","status":"FINISHED","focus":true,"$$hashKey":"object:62","dateFinished":"2021-01-15T11:54:31+0000","dateStarted":"2021-01-15T11:54:22+0000"},{"text":"%pyspark\nspark.sql(\"SELECT maincategory, count(*) AS c FROM CCCC GROUP BY maincategory ORDER BY c DESC\").show()","user":"lisa","dateUpdated":"2021-01-15T11:54:23+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+\n|maincategory|    c|\n+------------+-----+\n|     Society|91861|\n|        Arts|87685|\n|    Business|77658|\n|  Recreation|39940|\n|   Computers|39180|\n|     Science|38795|\n|      Sports|37373|\n|    Shopping|33588|\n|   Reference|21179|\n|      Health|20423|\n|       Games|14221|\n|        Home| 9175|\n|        News| 3428|\n+------------+-----+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=17","$$hashKey":"object:1646"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638389399_-236707096","id":"paragraph_1608638389399_-236707096","dateCreated":"2020-12-22T11:59:49+0000","dateStarted":"2021-01-15T11:54:23+0000","dateFinished":"2021-01-15T11:54:35+0000","status":"FINISHED","$$hashKey":"object:63"},{"text":"%md \nWe're going to make a more balanced dataset than above\n","user":"lisa","dateUpdated":"2020-12-22T12:59:00+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We're going to make a more balanced dataset than above</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608641910943_-755376959","id":"paragraph_1608641910943_-755376959","dateCreated":"2020-12-22T12:58:30+0000","dateStarted":"2020-12-22T12:58:58+0000","dateFinished":"2020-12-22T12:58:58+0000","status":"FINISHED","$$hashKey":"object:64"},{"text":"%md\nThese are the three biggest classes we are going to split","user":"lisa","dateUpdated":"2020-12-22T13:00:14+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>These are the three biggest classes we are going to split</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608641983301_2062082417","id":"paragraph_1608641983301_2062082417","dateCreated":"2020-12-22T12:59:43+0000","dateStarted":"2020-12-22T13:00:14+0000","dateFinished":"2020-12-22T13:00:14+0000","status":"FINISHED","$$hashKey":"object:65"},{"text":"%pyspark\ndf1 = spark.sql(\"SELECT maincategory,regexp_replace(categories, 'Top/([^/]+)(/[^/]+)?/?.*?$', '$1$2') as categories,title,url,cleaned_content FROM CCCC WHERE maincategory=='Society' or maincategory=='Arts' or maincategory=='Business'\")\ndf1.count()","user":"lisa","dateUpdated":"2021-01-15T11:54:42+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"257204\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=18","$$hashKey":"object:1717"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638559064_468714955","id":"paragraph_1608638559064_468714955","dateCreated":"2020-12-22T12:02:39+0000","dateStarted":"2021-01-15T11:54:42+0000","dateFinished":"2021-01-15T11:54:45+0000","status":"FINISHED","$$hashKey":"object:66"},{"text":"%pyspark\ndf1.show()","user":"lisa","dateUpdated":"2021-01-15T11:54:46+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+--------------------+--------------------+\n|maincategory|          categories|               title|                 url|     cleaned_content|\n+------------+--------------------+--------------------+--------------------+--------------------+\n|     Society|  Society/Paranormal|It's The End Of T...|http://alma-geddo...|end world know < ...|\n|     Society|Society/Religion_...|Cornerstone Commu...| http://ccchurch.ca/|try { typekit loa...|\n|     Society|Society/Religion_...|   Holiness Movement|http://gameo.org/...|holiness movement...|\n|     Society|Society/Religion_...|       Naaman's Life|http://grailboy.b...|naaman life < blo...|\n|     Society|Society/Religion_...|Immanuel Korean P...|http://members.tr...|ikpc3 owneriq var...|\n|     Society|Society/Relations...|Gumby and Pokey's...|http://members.tr...|gumby pokey parad...|\n|     Society|Society/Gay,_Lesb...|               Prism|http://niu.edu/lg...|prism niu lgbt st...|\n|     Society|Society/Religion_...|The Templet Famil...|http://thetemplet...|templet family ba...|\n|     Society|      Society/People| Rob and Deb's World|http://www.angelf...|rob deb world own...|\n|     Society|Society/Religion_...|General Instructi...|http://www.cathol...|catholic liturgic...|\n|     Society|Society/Religion_...|Cumberland Presby...|http://www.cumber...|cumberland presby...|\n|     Society|     Society/History|Dartmouth College...|http://www.dartmo...|doris kearns good...|\n|     Society|         Society/Law|Davies, Barrell, ...|http://www.dbwle....|home culpeper att...|\n|     Society|  Society/Philosophy|An Interview with...|http://www.ditext...|untitled jenny da...|\n|     Society|Society/Religion_...| The Gospel of Peter|http://www.earlyc...|gospel peter body...|\n|     Society|       Society/Death|E.J.Herbert &amp;...|http://www.ejherb...|home jquery windo...|\n|     Society|   Society/Ethnicity|     Emigrant Online|http://www.emigra...|page exist span12...|\n|     Society|     Society/History|  Der Fuehrer's Face|http://www.fact-i...|der fuehrer face ...|\n|     Society|Society/Religion_...|Saints Faith, Hop...|http://www.faithh...|saint faith hope ...|\n|     Society|Society/Religion_...|First Baptist Chu...|http://www.fbcbra...|home function kee...|\n+------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=19","$$hashKey":"object:1787"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608639179578_1441653098","id":"paragraph_1608639179578_1441653098","dateCreated":"2020-12-22T12:12:59+0000","dateStarted":"2021-01-15T11:54:46+0000","dateFinished":"2021-01-15T11:54:47+0000","status":"FINISHED","$$hashKey":"object:67"},{"text":"%pyspark\ndf1.createGlobalTempView(\"df1\")","user":"lisa","dateUpdated":"2021-01-15T11:55:37+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608639472465_736270402","id":"paragraph_1608639472465_736270402","dateCreated":"2020-12-22T12:17:52+0000","dateStarted":"2021-01-15T11:55:37+0000","dateFinished":"2021-01-15T11:55:37+0000","status":"FINISHED","$$hashKey":"object:68"},{"text":"%md\nThey will be split in the following classes","user":"lisa","dateUpdated":"2020-12-22T13:00:35+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>They will be split in the following classes</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608641959955_-1232572613","id":"paragraph_1608641959955_-1232572613","dateCreated":"2020-12-22T12:59:19+0000","dateStarted":"2020-12-22T13:00:32+0000","dateFinished":"2020-12-22T13:00:32+0000","status":"FINISHED","$$hashKey":"object:69"},{"text":"%pyspark\nspark.sql(\"SELECT categories, count(*) AS c FROM global_temp.df GROUP BY categories HAVING COUNT(categories) > 4000 ORDER BY c DESC\").collect()","user":"lisa","dateUpdated":"2021-01-15T11:54:52+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(categories='Society/Religion_and_Spirituality', c=45752), Row(categories='Arts/Music', c=26729), Row(categories='Arts/Movies', c=11888), Row(categories='Arts/Literature', c=9206), Row(categories='Society/Law', c=8651), Row(categories='Arts/Performing_Arts', c=7917), Row(categories='Business/Construction_and_Maintenance', c=7539), Row(categories='Business/Industrial_Goods_and_Services', c=7138), Row(categories='Business/Arts_and_Entertainment', c=6615), Row(categories='Business/Business_Services', c=6181), Row(categories='Business/Consumer_Goods_and_Services', c=6109), Row(categories='Arts/Visual_Arts', c=6026), Row(categories='Society/Issues', c=5670), Row(categories='Society/People', c=5377), Row(categories='Business/Textiles_and_Nonwovens', c=4908), Row(categories='Society/History', c=4299), Row(categories='Society/Organizations', c=4206)]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=20","$$hashKey":"object:1887"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=21","$$hashKey":"object:1888"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608639855129_93150124","id":"paragraph_1608639855129_93150124","dateCreated":"2020-12-22T12:24:15+0000","dateStarted":"2021-01-15T11:54:52+0000","dateFinished":"2021-01-15T11:54:54+0000","status":"FINISHED","$$hashKey":"object:70"},{"text":"%md\nWe chose to split classes when there were more than 4000 items. The remaining smaller classes will all be dumped back into the original Society, Arts and Business classes","user":"lisa","dateUpdated":"2020-12-22T13:04:12+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We chose to split classes when there were more than 4000 items. The remaining smaller classes will all be dumped back into the original Society, Arts and Business classes</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608642164317_1621655286","id":"paragraph_1608642164317_1621655286","dateCreated":"2020-12-22T13:02:44+0000","dateStarted":"2020-12-22T13:04:10+0000","dateFinished":"2020-12-22T13:04:10+0000","status":"FINISHED","$$hashKey":"object:71"},{"text":"%pyspark\ndf3 = spark.sql(\"SELECT maincategory,title,url,cleaned_content FROM global_temp.df WHERE NOT categories='Society/Religion_and_Spirituality' AND NOT categories='Arts/Music' AND NOT categories='Arts/Movies'AND NOT categories= 'Arts/Literature'AND NOT categories='Society/Law'AND NOT categories='Arts/Performing_Arts'AND NOT categories='Business/Construction_and_Maintenance'AND NOT categories='Business/Industrial_Goods_and_Services'AND NOT categories='Business/Arts_and_Entertainment'AND NOT categories='Business/Business_Services'AND NOT categories='Business/Consumer_Goods_and_Services'AND NOT categories='Arts/Visual_Arts'AND NOT categories='Society/Issues'AND NOT categories='Society/People'AND NOT categories='Business/Textiles_and_Nonwovens'AND NOT categories='Society/History'AND NOT categories='Society/Organizations'\")\ndf3.show()","user":"lisa","dateUpdated":"2021-01-15T11:54:54+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+--------------------+\n|maincategory|               title|                 url|     cleaned_content|\n+------------+--------------------+--------------------+--------------------+\n|     Society|It's The End Of T...|http://alma-geddo...|end world know < ...|\n|     Society|Gumby and Pokey's...|http://members.tr...|gumby pokey parad...|\n|     Society|               Prism|http://niu.edu/lg...|prism niu lgbt st...|\n|     Society|An Interview with...|http://www.ditext...|untitled jenny da...|\n|     Society|E.J.Herbert &amp;...|http://www.ejherb...|home jquery windo...|\n|     Society|     Emigrant Online|http://www.emigra...|page exist span12...|\n|     Society|Merry Christmas F...|http://www.merryc...|                    |\n|     Society|            Robodial|http://www.robodi...|robodial 1 roboca...|\n|     Society|The Direction of ...|http://www.rzuser...|time direction ht...|\n|     Society|       WheelchairNet|http://www.wheelc...|iswp home interna...|\n|     Society|Center for Health...|http://centerforh...|sex addiction tre...|\n|     Society|Darkdragon's Ghos...|http://darkdragon...|< var dir window ...|\n|     Society|  Enea Funeral Homes|http://eneafunera...|home enea family ...|\n|     Society|    Heraldic America|http://pages.infi...|heraldicamerica c...|\n|     Society|Creepy Ghost Stories|http://www.creepy...|creepy ghost stor...|\n|     Society|Gay and Lesbian Y...|http://www.glyp.com/|gay lesbian yello...|\n|     Society|    Heart for Africa|http://www.heartf...|welcome heart afr...|\n|     Society| PinkBananaMedia.com|http://www.pinkba...|pinkbananamedia c...|\n|     Society|Ellen Bommarito L...|http://www.umflin...|ellen bommarito l...|\n|     Society|United States-Ind...|http://www.usief....|welcome usief mak...|\n+------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=22","$$hashKey":"object:1955"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608640455009_466337308","id":"paragraph_1608640455009_466337308","dateCreated":"2020-12-22T12:34:15+0000","dateStarted":"2021-01-15T11:54:54+0000","dateFinished":"2021-01-15T11:54:55+0000","status":"FINISHED","$$hashKey":"object:72"},{"text":"%pyspark\ndf3.count()","user":"lisa","dateUpdated":"2021-01-15T11:54:59+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"82993\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=23","$$hashKey":"object:2020"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608640572946_1066508612","id":"paragraph_1608640572946_1066508612","dateCreated":"2020-12-22T12:36:12+0000","dateStarted":"2021-01-15T11:54:59+0000","dateFinished":"2021-01-15T11:55:00+0000","status":"FINISHED","$$hashKey":"object:73"},{"text":"%pyspark\ndf3.createGlobalTempView(\"df3\")","user":"lisa","dateUpdated":"2021-01-15T11:55:02+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608641416436_191452674","id":"paragraph_1608641416436_191452674","dateCreated":"2020-12-22T12:50:16+0000","dateStarted":"2021-01-15T11:55:02+0000","dateFinished":"2021-01-15T11:55:02+0000","status":"FINISHED","$$hashKey":"object:74"},{"text":"%pyspark\ndf5 = spark.sql(\"SELECT maincategory as categories,title,url,cleaned_content FROM global_temp.df3\")\ndf5.show()","user":"lisa","dateUpdated":"2021-01-15T11:55:03+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------------+--------------------+--------------------+\n|categories|               title|                 url|     cleaned_content|\n+----------+--------------------+--------------------+--------------------+\n|   Society|It's The End Of T...|http://alma-geddo...|end world know < ...|\n|   Society|Gumby and Pokey's...|http://members.tr...|gumby pokey parad...|\n|   Society|               Prism|http://niu.edu/lg...|prism niu lgbt st...|\n|   Society|An Interview with...|http://www.ditext...|untitled jenny da...|\n|   Society|E.J.Herbert &amp;...|http://www.ejherb...|home jquery windo...|\n|   Society|     Emigrant Online|http://www.emigra...|page exist span12...|\n|   Society|Merry Christmas F...|http://www.merryc...|                    |\n|   Society|            Robodial|http://www.robodi...|robodial 1 roboca...|\n|   Society|The Direction of ...|http://www.rzuser...|time direction ht...|\n|   Society|       WheelchairNet|http://www.wheelc...|iswp home interna...|\n|   Society|Center for Health...|http://centerforh...|sex addiction tre...|\n|   Society|Darkdragon's Ghos...|http://darkdragon...|< var dir window ...|\n|   Society|  Enea Funeral Homes|http://eneafunera...|home enea family ...|\n|   Society|    Heraldic America|http://pages.infi...|heraldicamerica c...|\n|   Society|Creepy Ghost Stories|http://www.creepy...|creepy ghost stor...|\n|   Society|Gay and Lesbian Y...|http://www.glyp.com/|gay lesbian yello...|\n|   Society|    Heart for Africa|http://www.heartf...|welcome heart afr...|\n|   Society| PinkBananaMedia.com|http://www.pinkba...|pinkbananamedia c...|\n|   Society|Ellen Bommarito L...|http://www.umflin...|ellen bommarito l...|\n|   Society|United States-Ind...|http://www.usief....|welcome usief mak...|\n+----------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=24","$$hashKey":"object:2102"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608641380147_2045916726","id":"paragraph_1608641380147_2045916726","dateCreated":"2020-12-22T12:49:40+0000","dateStarted":"2021-01-15T11:55:03+0000","dateFinished":"2021-01-15T11:55:04+0000","status":"FINISHED","$$hashKey":"object:75"},{"text":"%md\nThis is the dataset of split classes from the three biggest ones","user":"lisa","dateUpdated":"2020-12-22T13:02:21+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>This is the dataset of split classes from the three biggest ones</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608642058538_706654166","id":"paragraph_1608642058538_706654166","dateCreated":"2020-12-22T13:00:58+0000","dateStarted":"2020-12-22T13:02:20+0000","dateFinished":"2020-12-22T13:02:20+0000","status":"FINISHED","$$hashKey":"object:76"},{"text":"%pyspark\ndf4 = spark.sql(\"SELECT categories,title,url,cleaned_content FROM global_temp.df1 WHERE categories='Society/Religion_and_Spirituality' or categories='Arts/Music' or categories='Arts/Movies'or categories= 'Arts/Literature'or categories='Society/Law'or categories='Arts/Performing_Arts'or categories='Business/Construction_and_Maintenance'or categories='Business/Industrial_Goods_and_Services'or categories='Business/Arts_and_Entertainment'or categories='Business/Business_Services'or categories='Business/Consumer_Goods_and_Services'or categories='Arts/Visual_Arts'or categories='Society/Issues'or categories='Society/People'or categories='Business/Textiles_and_Nonwovens'or categories='Society/History'or categories='Society/Organizations'\")\ndf4.show()","user":"lisa","dateUpdated":"2021-01-15T11:55:43+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+\n|          categories|               title|                 url|     cleaned_content|\n+--------------------+--------------------+--------------------+--------------------+\n|Society/Religion_...|Cornerstone Commu...| http://ccchurch.ca/|try { typekit loa...|\n|Society/Religion_...|   Holiness Movement|http://gameo.org/...|holiness movement...|\n|Society/Religion_...|       Naaman's Life|http://grailboy.b...|naaman life < blo...|\n|Society/Religion_...|Immanuel Korean P...|http://members.tr...|ikpc3 owneriq var...|\n|Society/Religion_...|The Templet Famil...|http://thetemplet...|templet family ba...|\n|      Society/People| Rob and Deb's World|http://www.angelf...|rob deb world own...|\n|Society/Religion_...|General Instructi...|http://www.cathol...|catholic liturgic...|\n|Society/Religion_...|Cumberland Presby...|http://www.cumber...|cumberland presby...|\n|     Society/History|Dartmouth College...|http://www.dartmo...|doris kearns good...|\n|         Society/Law|Davies, Barrell, ...|http://www.dbwle....|home culpeper att...|\n|Society/Religion_...| The Gospel of Peter|http://www.earlyc...|gospel peter body...|\n|     Society/History|  Der Fuehrer's Face|http://www.fact-i...|der fuehrer face ...|\n|Society/Religion_...|Saints Faith, Hop...|http://www.faithh...|saint faith hope ...|\n|Society/Religion_...|First Baptist Chu...|http://www.fbcbra...|home function kee...|\n|Society/Religion_...|First United Meth...|http://www.fumcdp...|first united meth...|\n|Society/Religion_...|Church of the Goo...|http://www.goodsh...|church good sheph...|\n|         Society/Law|Howard Klebanoff, PC|http://www.howard...|howard klebanoff ...|\n|     Society/History|Henry Clay: An In...|http://www.let.ru...|henry clay 1777 1...|\n|Society/Religion_...|Mahomet United Me...|http://www.mumc.org/|mahomet united me...|\n|         Society/Law|North Carolina Ba...|http://www.ncbar....|north carolina ba...|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=25","$$hashKey":"object:2183"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608639535763_750341771","id":"paragraph_1608639535763_750341771","dateCreated":"2020-12-22T12:18:55+0000","dateStarted":"2021-01-15T11:55:43+0000","dateFinished":"2021-01-15T11:55:44+0000","status":"FINISHED","$$hashKey":"object:77"},{"text":"%pyspark\ndf4.count()","user":"lisa","dateUpdated":"2021-01-15T11:55:47+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"174211\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=26","$$hashKey":"object:2253"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608640579313_-269023424","id":"paragraph_1608640579313_-269023424","dateCreated":"2020-12-22T12:36:19+0000","dateStarted":"2021-01-15T11:55:47+0000","dateFinished":"2021-01-15T11:55:48+0000","status":"FINISHED","$$hashKey":"object:78"},{"text":"%md\nThis is the dataset except the three biggest classes","user":"lisa","dateUpdated":"2020-12-22T13:01:47+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>This is the dataset except the three biggest classes</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608642093951_925586691","id":"paragraph_1608642093951_925586691","dateCreated":"2020-12-22T13:01:33+0000","dateStarted":"2020-12-22T13:01:37+0000","dateFinished":"2020-12-22T13:01:37+0000","status":"FINISHED","$$hashKey":"object:79"},{"text":"%pyspark\ndf2 = spark.sql(\"SELECT maincategory as categories,title,url,cleaned_content FROM CCCC WHERE NOT maincategory='Society' AND NOT maincategory='Arts' AND NOT maincategory='Business'\")\ndf2.count()","user":"lisa","dateUpdated":"2021-01-15T11:55:50+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"257302\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=27","$$hashKey":"object:2323"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638879585_-1411918623","id":"paragraph_1608638879585_-1411918623","dateCreated":"2020-12-22T12:07:59+0000","dateStarted":"2021-01-15T11:55:50+0000","dateFinished":"2021-01-15T11:55:51+0000","status":"FINISHED","$$hashKey":"object:80"},{"text":"%pyspark\ndf2.show()","user":"lisa","dateUpdated":"2021-01-15T11:55:54+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+--------------------+--------------------+--------------------+\n|categories|               title|                 url|     cleaned_content|\n+----------+--------------------+--------------------+--------------------+\n| Computers|    A Real Validator|http://arealvalid...|real validator tr...|\n| Computers|AROS: Amiga Resea...|http://aros.sourc...|aros research ope...|\n| Computers|            Homebrew|     http://brew.sh/|homebrew missing ...|\n| Computers|            SQLiteDB|http://code.jense...|sqlitedb sqlite p...|\n| Computers|SQL Injection - C...|http://shiflett.o...|sql injection chr...|\n| Computers|      Alien Software|http://www.aliens...|health network he...|\n| Computers|United Systems Te...|http://www.asyst3...|home ddrjquery wi...|\n| Computers|Chicago Area Robo...|http://www.chibot...|chibots < >< cdat...|\n| Computers|CreativeMac: Core...|http://www.creati...|corel painter ix ...|\n| Computers|      SoundConverter|http://www.dekort...|                    |\n| Computers|    Desktop Icon Toy|http://www.idesks...|desktop icon toy ...|\n| Computers|     Internet-Drafts|http://www.ietf.o...|internet draft d ...|\n| Computers|Raise the Red Fla...|http://www.linuxj...|window nreum nreu...|\n| Computers|     LK Bin Database|http://www.lksoft...|function w c { w ...|\n| Computers|    Response-O-Matic|http://www.respon...|create online con...|\n| Computers|    SoftwareArchives|http://www.softwa...|softwarearchives ...|\n| Computers|          TweetsWind|http://www.tweets...|tweetswind displa...|\n| Computers|Jini Security : A...|http://citeseerx....|citeseerx securit...|\n| Computers|             WebMail|http://jwebmail.s...|             webmail|\n| Computers|               VVCap|   http://vvcap.com/|vvcap screenshots...|\n+----------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=28","$$hashKey":"object:2393"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608639190716_524883085","id":"paragraph_1608639190716_524883085","dateCreated":"2020-12-22T12:13:10+0000","dateStarted":"2021-01-15T11:55:54+0000","dateFinished":"2021-01-15T11:55:54+0000","status":"FINISHED","$$hashKey":"object:81"},{"text":"%md\nWe union the three datasets.\nDF4 is all two-level categories\nDF5 is all Society,Arts,Business but without the two-level categories from DF4\nDF2 is all data except Society,Arts,Business","user":"lisa","dateUpdated":"2020-12-22T13:07:26+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We union the three datasets.\n<br  />DF4 is all two-level categories\n<br  />DF5 is all Society,Arts,Business but without the two-level categories from DF4\n<br  />DF2 is all data except Society,Arts,Business</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608642296721_1954480946","id":"paragraph_1608642296721_1954480946","dateCreated":"2020-12-22T13:04:56+0000","dateStarted":"2020-12-22T13:07:24+0000","dateFinished":"2020-12-22T13:07:24+0000","status":"FINISHED","$$hashKey":"object:82"},{"text":"%pyspark\ndf6 = df4.union(df5)\ndf7 = df6.union(df2)","user":"lisa","dateUpdated":"2021-01-15T11:55:56+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608641608648_-377162672","id":"paragraph_1608641608648_-377162672","dateCreated":"2020-12-22T12:53:28+0000","dateStarted":"2021-01-15T11:55:56+0000","dateFinished":"2021-01-15T11:55:56+0000","status":"FINISHED","$$hashKey":"object:83"},{"text":"%md\nAll partial counts were checked and also the final sum corresponds to its original value","user":"lisa","dateUpdated":"2020-12-22T13:08:22+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>All partial counts were checked and also the final sum corresponds to its original value</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608642461246_-1667689806","id":"paragraph_1608642461246_-1667689806","dateCreated":"2020-12-22T13:07:41+0000","dateStarted":"2020-12-22T13:08:21+0000","dateFinished":"2020-12-22T13:08:21+0000","status":"FINISHED","$$hashKey":"object:84"},{"text":"%pyspark\ndf7.count()","user":"lisa","dateUpdated":"2021-01-15T11:55:58+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"514506\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=29","$$hashKey":"object:2470"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608641702121_851258745","id":"paragraph_1608641702121_851258745","dateCreated":"2020-12-22T12:55:02+0000","dateStarted":"2021-01-15T11:55:59+0000","dateFinished":"2021-01-15T11:56:01+0000","status":"FINISHED","$$hashKey":"object:85"},{"text":"%md\nNow, we have the following distribution:","user":"lisa","dateUpdated":"2020-12-22T13:08:44+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now, we have the following distribution:</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608642510798_-1887702384","id":"paragraph_1608642510798_-1887702384","dateCreated":"2020-12-22T13:08:30+0000","dateStarted":"2020-12-22T13:08:42+0000","dateFinished":"2020-12-22T13:08:42+0000","status":"FINISHED","$$hashKey":"object:86"},{"text":"%pyspark\ndf7.groupby('categories').count().sort('count', ascending=False).show(40)","user":"lisa","dateUpdated":"2021-01-15T11:56:24+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":628,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|          categories|count|\n+--------------------+-----+\n|Society/Religion_...|45752|\n|          Recreation|39940|\n|           Computers|39180|\n|            Business|39168|\n|             Science|38795|\n|              Sports|37373|\n|            Shopping|33588|\n|          Arts/Music|26729|\n|                Arts|25919|\n|           Reference|21179|\n|              Health|20423|\n|             Society|17906|\n|               Games|14221|\n|         Arts/Movies|11888|\n|     Arts/Literature| 9206|\n|                Home| 9175|\n|         Society/Law| 8651|\n|Arts/Performing_Arts| 7917|\n|Business/Construc...| 7539|\n|Business/Industri...| 7138|\n|Business/Arts_and...| 6615|\n|Business/Business...| 6181|\n|Business/Consumer...| 6109|\n|    Arts/Visual_Arts| 6026|\n|      Society/Issues| 5670|\n|      Society/People| 5377|\n|Business/Textiles...| 4908|\n|     Society/History| 4299|\n|Society/Organizat...| 4206|\n|                News| 3428|\n+--------------------+-----+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=30","$$hashKey":"object:2535"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608641788010_1268411262","id":"paragraph_1608641788010_1268411262","dateCreated":"2020-12-22T12:56:28+0000","dateStarted":"2021-01-15T11:56:24+0000","dateFinished":"2021-01-15T11:56:30+0000","status":"FINISHED","$$hashKey":"object:87"},{"text":"%pyspark\ndf7.write.format(\"parquet\").option(\"compression\",\"none\").partitionBy(\"categories\").option(\"path\",\"hdfs:/user/lisa/balancedDF\").saveAsTable('balancedDF')","user":"lisa","dateUpdated":"2020-12-22T13:09:58+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=186","$$hashKey":"object:1013"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=187","$$hashKey":"object:1014"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608642565669_-1077808040","id":"paragraph_1608642565669_-1077808040","dateCreated":"2020-12-22T13:09:25+0000","dateStarted":"2020-12-22T13:09:58+0000","dateFinished":"2020-12-22T13:10:18+0000","status":"FINISHED","$$hashKey":"object:88"},{"text":"%md\n## Start training data","user":"lisa","dateUpdated":"2021-01-15T12:13:06+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Start training data</h2>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608644308565_-1772060108","id":"paragraph_1608644308565_-1772060108","dateCreated":"2020-12-22T13:38:28+0000","dateStarted":"2021-01-15T12:13:04+0000","dateFinished":"2021-01-15T12:13:04+0000","status":"FINISHED","$$hashKey":"object:89"},{"text":"%pyspark\ndfc = spark.table(\"balancedDF\")\ndfc.show()","user":"lisa","dateUpdated":"2020-12-27T16:04:05+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+\n|               title|                 url|     cleaned_content|          categories|\n+--------------------+--------------------+--------------------+--------------------+\n|Covenant Network ...|http://covnetpres...|covenant network ...|Society/Religion_...|\n|Roman Catholics a...|http://nationalhu...|roman catholic im...|Society/Religion_...|\n|St. Francis Xavie...|http://pweb.sophi...|pdf 1 5 615 0 obj...|Society/Religion_...|\n|Welcome to my World.|http://spacebabyd...|welcome world own...|Society/Religion_...|\n|Index of 19th Cen...|http://twain.lib....|index text index ...|Society/Religion_...|\n|Anglican Diocese ...|http://www.bathur...|welcome bathurst ...|Society/Religion_...|\n|Black Diamond Gos...| http://www.bdgc.ca/|black diamond gos...|Society/Religion_...|\n|Discovery United ...|http://www.discov...|discovery umc pag...|Society/Religion_...|\n|East Hills Allian...|http://www.easthi...|east hill allianc...|Society/Religion_...|\n|First Baptist Chu...|http://www.fbctul...|first baptist tul...|Society/Religion_...|\n| Salem: First Church|http://www.firstc...|first church sale...|Society/Religion_...|\n|Jewish Encycloped...|http://www.jewish...|ahab jewishencycl...|Society/Religion_...|\n|        KHCR 97.7 FM|http://www.joyfmo...|var promoitems { ...|Society/Religion_...|\n|        KRSS 93.5 FM| http://www.krss.me/|welcome cross rad...|Society/Religion_...|\n|Abraham, The Boso...|http://www.newadv...|catholic encyclop...|Society/Religion_...|\n|Anchor (as Symbol...|http://www.newadv...|catholic encyclop...|Society/Religion_...|\n|             Antioch|http://www.newadv...|catholic encyclop...|Society/Religion_...|\n|  Apostolic Churches|http://www.newadv...|catholic encyclop...|Society/Religion_...|\n|    Archinto, Filipo|http://www.newadv...|catholic encyclop...|Society/Religion_...|\n|               Forli|http://www.newadv...|catholic encyclop...|Society/Religion_...|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=316","$$hashKey":"object:1043"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609084937651_-1750118019","id":"paragraph_1609084937651_-1750118019","dateCreated":"2020-12-27T16:02:17+0000","dateStarted":"2020-12-27T16:04:05+0000","dateFinished":"2020-12-27T16:04:12+0000","status":"FINISHED","$$hashKey":"object:90"},{"text":"%pyspark\nindexer = StringIndexer(inputCol=\"categories\", outputCol=\"label\", handleInvalid=\"keep\")\ntrainpl = Pipeline(stages=[indexer])\n\nindexermodel = trainpl.fit(dfc)\nd = indexermodel.transform(dfc)\nd.show()","user":"lisa","dateUpdated":"2020-12-27T16:04:16+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+-----+\n|               title|                 url|     cleaned_content|          categories|label|\n+--------------------+--------------------+--------------------+--------------------+-----+\n|Covenant Network ...|http://covnetpres...|covenant network ...|Society/Religion_...|  0.0|\n|Roman Catholics a...|http://nationalhu...|roman catholic im...|Society/Religion_...|  0.0|\n|St. Francis Xavie...|http://pweb.sophi...|pdf 1 5 615 0 obj...|Society/Religion_...|  0.0|\n|Welcome to my World.|http://spacebabyd...|welcome world own...|Society/Religion_...|  0.0|\n|Index of 19th Cen...|http://twain.lib....|index text index ...|Society/Religion_...|  0.0|\n|Anglican Diocese ...|http://www.bathur...|welcome bathurst ...|Society/Religion_...|  0.0|\n|Black Diamond Gos...| http://www.bdgc.ca/|black diamond gos...|Society/Religion_...|  0.0|\n|Discovery United ...|http://www.discov...|discovery umc pag...|Society/Religion_...|  0.0|\n|East Hills Allian...|http://www.easthi...|east hill allianc...|Society/Religion_...|  0.0|\n|First Baptist Chu...|http://www.fbctul...|first baptist tul...|Society/Religion_...|  0.0|\n| Salem: First Church|http://www.firstc...|first church sale...|Society/Religion_...|  0.0|\n|Jewish Encycloped...|http://www.jewish...|ahab jewishencycl...|Society/Religion_...|  0.0|\n|        KHCR 97.7 FM|http://www.joyfmo...|var promoitems { ...|Society/Religion_...|  0.0|\n|        KRSS 93.5 FM| http://www.krss.me/|welcome cross rad...|Society/Religion_...|  0.0|\n|Abraham, The Boso...|http://www.newadv...|catholic encyclop...|Society/Religion_...|  0.0|\n|Anchor (as Symbol...|http://www.newadv...|catholic encyclop...|Society/Religion_...|  0.0|\n|             Antioch|http://www.newadv...|catholic encyclop...|Society/Religion_...|  0.0|\n|  Apostolic Churches|http://www.newadv...|catholic encyclop...|Society/Religion_...|  0.0|\n|    Archinto, Filipo|http://www.newadv...|catholic encyclop...|Society/Religion_...|  0.0|\n|               Forli|http://www.newadv...|catholic encyclop...|Society/Religion_...|  0.0|\n+--------------------+--------------------+--------------------+--------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=317","$$hashKey":"object:1058"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=318","$$hashKey":"object:1059"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341622_107374740","id":"paragraph_1608564959859_1664349283","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-27T16:04:16+0000","dateFinished":"2020-12-27T16:04:19+0000","status":"FINISHED","$$hashKey":"object:91"},{"text":"%pyspark\nsplits = d.randomSplit([0.75, 0.25], 24)\ntrainDF = splits[0]\ntestDF = splits[1]","user":"lisa","dateUpdated":"2020-12-27T16:04:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341622_-1029989279","id":"paragraph_1606305261163_-476012457","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-27T16:04:18+0000","dateFinished":"2020-12-27T16:04:19+0000","status":"FINISHED","$$hashKey":"object:92"},{"text":"%pyspark\ntrainDF.show()","user":"lisa","dateUpdated":"2020-12-27T16:04:20+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+-----+\n|               title|                 url|     cleaned_content|          categories|label|\n+--------------------+--------------------+--------------------+--------------------+-----+\n|\"\"\"Anti-Christian...|http://www.neopag...|anti christianity...|Society/Religion_...|  0.0|\n|\"\"\"Deo est Gloria...|http://www.deoest...|deo est gloria re...|Society/Religion_...|  0.0|\n|   \"\"\"On the Trinity|http://pvspade.co...|pdf 1 3 61 0 obj ...|Society/Religion_...|  0.0|\n|\"\"\"Unconditional ...|http://www.the-hi...|unconditional ele...|Society/Religion_...|  0.0|\n|\"Background to \"\"...|http://courses.wc...|margery kempe med...|Society/Religion_...|  0.0|\n|\"Doctor Mike: The...|http://www.angelf...|living god home p...|Society/Religion_...|  0.0|\n|\"Great Yarmouth:\"...|http://www.ukunit...|old meeting unita...|Society/Religion_...|  0.0|\n|\"Julian of Norwic...|http://www.umilta...|julian norwich sh...|Society/Religion_...|  0.0|\n|\"KHA Records' Gur...|  http://www.kha.it/|gurdjieff lecuona...|Society/Religion_...|  0.0|\n|\"Olodumare, \"\"Own...|http://www.angelf...|soulchango produc...|Society/Religion_...|  0.0|\n|\"Our Righteous Fa...|http://www.orthod...|st john climacus ...|Society/Religion_...|  0.0|\n|\"Outdoor Ceremoni...|http://adventurer...|adventure rabbi d...|Society/Religion_...|  0.0|\n|\"The \"\"Christian\"...|http://www.acts17...|christian identit...|Society/Religion_...|  0.0|\n|\"The \"\"Days\"\" of ...|http://www.grisda...|hasel g f day cre...|Society/Religion_...|  0.0|\n|\"Zoo Torah -- Gam...|http://www.zootor...|zoo torah try { t...|Society/Religion_...|  0.0|\n|10th Enfield Boys...|http://10enfield....|10th enfield boy ...|Society/Religion_...|  0.0|\n|130th Glasgow Com...|http://www.130thg...|home 130th glasgo...|Society/Religion_...|  0.0|\n|1517 The Legacy P...|http://www.1517le...|blog 1517 legacy ...|Society/Religion_...|  0.0|\n|17th Hull Boys Br...|http://17hull.boy...|17th hull boy bri...|Society/Religion_...|  0.0|\n|1913 Catholic Enc...|http://www.newadv...|catholic encyclop...|Society/Religion_...|  0.0|\n+--------------------+--------------------+--------------------+--------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=319","$$hashKey":"object:1088"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341622_256270436","id":"paragraph_1606312841446_-2144843225","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-27T16:04:20+0000","dateFinished":"2020-12-27T16:04:21+0000","status":"FINISHED","$$hashKey":"object:93"},{"text":"%pyspark\nfrom pyspark.ml import Pipeline, PipelineModel\nfrom pyspark.ml.classification import LogisticRegression\nfrom pyspark.ml.feature import HashingTF, Tokenizer, StringIndexer, IndexToString\n\n# Configure an ML pipeline\ntokenizer = Tokenizer(inputCol=\"cleaned_content\", outputCol=\"words\")\nhashingTF = HashingTF(inputCol=tokenizer.getOutputCol(), outputCol=\"features\")\nlr = LogisticRegression(maxIter=10, regParam=0.001)\npipeline = Pipeline(stages=[tokenizer, hashingTF, lr])\n\n# Fit the pipeline to training documents.\nmodel = pipeline.fit(trainDF)","user":"lisa","dateUpdated":"2020-12-27T16:04:23+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=320","$$hashKey":"object:1103"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=321","$$hashKey":"object:1104"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=322","$$hashKey":"object:1105"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=323","$$hashKey":"object:1106"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=324","$$hashKey":"object:1107"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=325","$$hashKey":"object:1108"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=326","$$hashKey":"object:1109"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=327","$$hashKey":"object:1110"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=328","$$hashKey":"object:1111"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=329","$$hashKey":"object:1112"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=330","$$hashKey":"object:1113"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=331","$$hashKey":"object:1114"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=332","$$hashKey":"object:1115"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_2112325515","id":"paragraph_1606248095976_-1153341034","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-27T16:04:23+0000","dateFinished":"2020-12-27T16:06:08+0000","status":"FINISHED","$$hashKey":"object:94"},{"text":"%pyspark\n# Now we can optionally save the fitted pipeline to disk\nmodel.write().overwrite().save(\"/tmp/pyspark-logistic-regression-model\")\n\n# And load it back in during production\nsameModel = PipelineModel.load(\"/tmp/pyspark-logistic-regression-model\")","user":"lisa","dateUpdated":"2020-12-22T13:39:59+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_2026928097","id":"paragraph_1606305708742_17736437","dateCreated":"2020-12-22T11:59:01+0000","status":"READY","$$hashKey":"object:95"},{"text":"%md\n## Test model","user":"lisa","dateUpdated":"2021-01-15T12:13:42+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1610712797317_-2062897244","id":"paragraph_1610712797317_-2062897244","dateCreated":"2021-01-15T12:13:17+0000","status":"FINISHED","focus":true,"$$hashKey":"object:2587","dateFinished":"2021-01-15T12:13:40+0000","dateStarted":"2021-01-15T12:13:40+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Test model</h2>\n"}]}},{"text":"%pyspark\nfrom pyspark.ml.feature import StringIndexerModel\n\n# Annoying put important value to convert the labels back to its corresponding category\nlabels= (indexermodel.stages[0]).labels\nprint(labels)","user":"lisa","dateUpdated":"2020-12-27T16:04:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Society/Religion_and_Spirituality', 'Recreation', 'Computers', 'Business', 'Science', 'Sports', 'Shopping', 'Arts/Music', 'Arts', 'Reference', 'Health', 'Society', 'Games', 'Arts/Movies', 'Arts/Literature', 'Home', 'Society/Law', 'Arts/Performing_Arts', 'Business/Construction_and_Maintenance', 'Business/Industrial_Goods_and_Services', 'Business/Arts_and_Entertainment', 'Business/Business_Services', 'Business/Consumer_Goods_and_Services', 'Arts/Visual_Arts', 'Society/Issues', 'Society/People', 'Business/Textiles_and_Nonwovens', 'Society/History', 'Society/Organizations', 'News']\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_-486783103","id":"paragraph_1606301372436_-1545138065","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-27T16:04:26+0000","dateFinished":"2020-12-27T16:06:08+0000","status":"FINISHED","$$hashKey":"object:96"},{"text":"%pyspark\n# Make predictions on test documents.\ntestSet = model.transform(testDF)\n\nconverter = IndexToString(inputCol=\"prediction\", outputCol=\"predicted_category\", labels=labels)\nconverted = converter.transform(testSet)\nconverted.select(\"categories\",\"title\",\"url\",\"words\",\"predicted_category\").show()","user":"lisa","dateUpdated":"2020-12-27T16:04:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{"0":{"graph":{"mode":"table","height":534,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+--------------------+\n|          categories|               title|                 url|               words|  predicted_category|\n+--------------------+--------------------+--------------------+--------------------+--------------------+\n|Society/Religion_...|\"\"\"Mental Health\"...|http://www.sptime...|[worldandnation, ...|           Computers|\n|Society/Religion_...|\"\"\"Ut Sit\"\" The A...|http://www.ewtn.c...|[john, paul, ii, ...|Society/Religion_...|\n|Society/Religion_...|\"Teresa de Jesús ...|http://www.vatica...|[teresa, de, jess...|Society/Religion_...|\n|Society/Religion_...|\"The Archives of ...|http://warrior.xe...|[mark, plummer, a...|Society/Religion_...|\n|Society/Religion_...|\"Tsung-Mi and the...|http://ccbs.ntu.e...|[tsung, mi, singl...|             Society|\n|Society/Religion_...|          107 Theses|http://www.wphafm...|[steve, camp, 107...|Society/Religion_...|\n|Society/Religion_...|          123 Cacher|http://www.123cac...|[restaurant, cach...|          Recreation|\n|Society/Religion_...|1662 Book of Comm...|http://www.eskimo...|[1662, book, comm...|            Shopping|\n|Society/Religion_...|16th Liverpool Bo...|http://16bb.merse...|[16th, liverpool,...|           Computers|\n|Society/Religion_...|1999 Catholic Int...|http://www.cathol...|[1999, catholic, ...|Society/Religion_...|\n|Society/Religion_...|       1st Biorhythm|http://www.velns....|[biorhythms, 1st,...|           Computers|\n|Society/Religion_...|         1st Ethical|http://www.1steth...|[1stethical, insp...|Society/Religion_...|\n|Society/Religion_...|1stA Birmingham B...|http://1abirmingh...|[1sta, birmingham...|             Science|\n|Society/Religion_...|2! A Book about S...|  http://www.two.cc/|[sign, god, coinc...|Society/Religion_...|\n|Society/Religion_...|219th General Ass...|http://ga219.pcus...|[219th, general, ...|Society/Religion_...|\n|Society/Religion_...|30th Avenue Bapti...|http://www.30thav...|[home, 30th, aven...|Society/Religion_...|\n|Society/Religion_...|          39 Stripes|http://www.39stri...|[home, window, ad...|          Recreation|\n|Society/Religion_...|3rd Day Worship C...|http://www.3rdday...|[3rd, day, worshi...|          Recreation|\n|Society/Religion_...|                4HIM|http://www.4him.net/|[4him, religion, ...|          Arts/Music|\n|Society/Religion_...|          4th Vision|http://www.4thvis...|[color, used, des...|            Business|\n+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=333","$$hashKey":"object:1178"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_842545287","id":"paragraph_1608035708276_-1631112905","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-27T16:06:09+0000","dateFinished":"2020-12-27T16:06:10+0000","status":"FINISHED","$$hashKey":"object:97"},{"text":"%pyspark\nconverted.sample(False, 0.0003).select(\"categories\",\"url\",\"words\",\"predicted_category\").withColumn(\"correct\",col(\"categories\")==col(\"predicted_category\")).show()","user":"lisa","dateUpdated":"2020-12-27T16:08:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{"0":{"graph":{"mode":"table","height":474,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+-------+\n|          categories|                 url|               words|  predicted_category|correct|\n+--------------------+--------------------+--------------------+--------------------+-------+\n|Society/Religion_...|http://www.newadv...|[catholic, encycl...|Society/Religion_...|   true|\n|Society/Religion_...|http://www.emanue...|[emanuel, luthera...|Society/Religion_...|   true|\n|Society/Religion_...|http://www.newadv...|[catholic, encycl...|Society/Religion_...|   true|\n|Society/Religion_...|http://www.thezen...|[thezensite, teis...|Society/Religion_...|   true|\n|             Science|http://www.fields...|[field, institute...|             Science|   true|\n|Society/Religion_...|http://www.sbbc.c...|[sbbc, beat, mess...|Society/Religion_...|   true|\n|           Computers|  http://www.h5.com/|[h5, e, discovery...|            Business|  false|\n|            Business|http://www.blueri...|[blue, ridge, tra...|            Shopping|  false|\n|            Business|http://www.pan-pi...|[wire, drawing, m...|            Business|   true|\n|             Science|http://www.antiqu...|[antiquity, man, ...|             Science|   true|\n|            Business|http://www.alpaca...|[error, page, can...|           Computers|  false|\n|            Business|http://www.carein...|[st, louis, misso...|              Health|  false|\n|            Business|http://iechristma...|[inland, empire, ...|           Computers|  false|\n|           Computers|http://www.tutori...|[blender, game, e...|              Health|  false|\n|          Recreation|http://www.pbase....|[pbase, com, impo...|          Recreation|   true|\n|          Recreation|https://www.caese...|[caeses, software...|           Computers|  false|\n|          Recreation|http://www.greyho...|[home, greyhound,...|          Recreation|   true|\n|             Society|http://www.crstru...|[body, {, backgro...|Society/Religion_...|  false|\n|              Health|http://www.mcmc.net/|[mid, columbia, m...|            Business|  false|\n|          Arts/Music|http://www.ipl.or...|[ipl2, page, move...|             Science|  false|\n+--------------------+--------------------+--------------------+--------------------+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=364","$$hashKey":"object:1193"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=365","$$hashKey":"object:1194"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=366","$$hashKey":"object:1195"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_1426589064","id":"paragraph_1608116808031_-1398199692","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-27T16:08:31+0000","dateFinished":"2020-12-27T16:08:35+0000","status":"FINISHED","$$hashKey":"object:98"},{"text":"%md\n## Evaluation","user":"lisa","dateUpdated":"2021-01-15T12:14:04+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1610712831227_-484996408","id":"paragraph_1610712831227_-484996408","dateCreated":"2021-01-15T12:13:51+0000","status":"FINISHED","focus":true,"$$hashKey":"object:2683","dateFinished":"2021-01-15T12:14:02+0000","dateStarted":"2021-01-15T12:14:02+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Evaluation</h2>\n"}]}},{"text":"%pyspark\nfrom pyspark.mllib.evaluation import MulticlassMetrics\nfrom pyspark.sql.functions import col\n\npredictionAndLabels = testSet.select(col(\"prediction\"),col(\"label\")).rdd\nmetrics = MulticlassMetrics(predictionAndLabels)","user":"lisa","dateUpdated":"2020-12-22T13:45:13+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_-2107937700","id":"paragraph_1606316071641_1150212398","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-22T13:45:13+0000","dateFinished":"2020-12-22T13:45:13+0000","status":"FINISHED","$$hashKey":"object:99"},{"text":"%pyspark\ndict = d.select(\"label\",\"categories\").distinct().rdd.collectAsMap()\nprint(dict)","user":"lisa","dateUpdated":"2020-12-22T13:45:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{24.0: 'Society/Issues', 13.0: 'Arts/Movies', 6.0: 'Shopping', 27.0: 'Society/History', 14.0: 'Arts/Literature', 7.0: 'Arts/Music', 25.0: 'Society/People', 17.0: 'Arts/Performing_Arts', 19.0: 'Business/Industrial_Goods_and_Services', 26.0: 'Business/Textiles_and_Nonwovens', 29.0: 'News', 8.0: 'Arts', 18.0: 'Business/Construction_and_Maintenance', 11.0: 'Society', 3.0: 'Business', 20.0: 'Business/Arts_and_Entertainment', 12.0: 'Games', 23.0: 'Arts/Visual_Arts', 5.0: 'Sports', 1.0: 'Recreation', 2.0: 'Computers', 4.0: 'Science', 16.0: 'Society/Law', 10.0: 'Health', 0.0: 'Society/Religion_and_Spirituality', 15.0: 'Home', 21.0: 'Business/Business_Services', 28.0: 'Society/Organizations', 9.0: 'Reference', 22.0: 'Business/Consumer_Goods_and_Services'}\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=208","$$hashKey":"object:1226"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_-85718452","id":"paragraph_1608563122641_1638931330","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-22T13:45:31+0000","dateFinished":"2020-12-22T13:45:34+0000","status":"FINISHED","$$hashKey":"object:100"},{"text":"%pyspark\n\n# Overall statistics\nprecision = metrics.precision()\nrecall = metrics.recall()\nf1Score = metrics.fMeasure()\nprint(\"Summary Stats\")\nprint(\"Precision = %s\" % precision)\nprint(\"Recall = %s\" % recall)\nprint(\"F1 Score = %s\" % f1Score)\n\n# Statistics by class\nclasses = d.select(\"label\").rdd.flatMap(lambda x:x).distinct().collect()\nfor label in sorted(classes):\n    print(\"Class %s precision = %s\" % (dict.get(label), metrics.precision(label)))\n    print(\"Class %s recall = %s\" % (dict.get(label), metrics.recall(label)))\n    print(\"Class %s F1 Measure = %s\" % (dict.get(label), metrics.fMeasure(label, beta=1.0)))\n    \n# Weighted statsclas\nprint(\"Weighted recall = %s\" % metrics.weightedRecall)\nprint(\"Weighted precision = %s\" % metrics.weightedPrecision)\nprint(\"Weighted F(1) Score = %s\" % metrics.weightedFMeasure())\nprint(\"Weighted F(0.5) Score = %s\" % metrics.weightedFMeasure(beta=0.5))\nprint(\"Weighted false positive rate = %s\" % metrics.weightedFalsePositiveRate)","user":"lisa","dateUpdated":"2020-12-22T13:45:36+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Summary Stats\nPrecision = 0.44515040283696766\nRecall = 0.44515040283696766\nF1 Score = 0.44515040283696766\nClass Society/Religion_and_Spirituality precision = 0.42015153006002165\nClass Society/Religion_and_Spirituality recall = 0.7497805092186128\nClass Society/Religion_and_Spirituality F1 Measure = 0.5385294488586203\nClass Recreation precision = 0.3516143584455758\nClass Recreation recall = 0.5496675397944791\nClass Recreation F1 Measure = 0.42888024210981407\nClass Computers precision = 0.49500554938956715\nClass Computers recall = 0.5942400327969662\nClass Computers F1 Measure = 0.5401024685607825\nClass Business precision = 0.29246378583216187\nClass Business recall = 0.4888639149979567\nClass Business F1 Measure = 0.3659795785689702\nClass Science precision = 0.49265772298767224\nClass Science recall = 0.5630373977001968\nClass Science F1 Measure = 0.5255015711868504\nClass Sports precision = 0.5912936985081274\nClass Sports recall = 0.5607052364864865\nClass Sports F1 Measure = 0.5755933672916441\nClass Shopping precision = 0.4016048910966756\nClass Shopping recall = 0.4968092649491846\nClass Shopping F1 Measure = 0.4441627047015319\nClass Arts/Music precision = 0.6910451363746077\nClass Arts/Music recall = 0.42987987987987986\nClass Arts/Music F1 Measure = 0.5300379524206238\nClass Arts precision = 0.43221649484536084\nClass Arts recall = 0.25788097801014914\nClass Arts F1 Measure = 0.3230280265819127\nClass Reference precision = 0.5160508782556027\nClass Reference recall = 0.3146814404432133\nClass Reference F1 Measure = 0.39096019272685556\nClass Health precision = 0.6369565217391304\nClass Health recall = 0.4078345595545834\nClass Health F1 Measure = 0.4972723966541399\nClass Society precision = 0.5487538259728902\nClass Society recall = 0.2750383519614289\nClass Society F1 Measure = 0.3664233576642336\nClass Games precision = 0.2992\nClass Games recall = 0.4815450643776824\nClass Games F1 Measure = 0.36907894736842106\nClass Arts/Movies precision = 0.6548792927575654\nClass Arts/Movies recall = 0.6526601152151813\nClass Arts/Movies F1 Measure = 0.6537678207739307\nClass Arts/Literature precision = 0.5992982456140351\nClass Arts/Literature recall = 0.38537906137184114\nClass Arts/Literature F1 Measure = 0.46910189508376815\nClass Home precision = 0.6443202979515829\nClass Home recall = 0.30498016747465845\nClass Home F1 Measure = 0.4139994017349686\nClass Society/Law precision = 0.7465475223395613\nClass Society/Law recall = 0.4182976786527082\nClass Society/Law F1 Measure = 0.5361726954492415\nClass Arts/Performing_Arts precision = 0.6300940438871473\nClass Arts/Performing_Arts recall = 0.10213414634146341\nClass Arts/Performing_Arts F1 Measure = 0.17577612592916483\nClass Business/Construction_and_Maintenance precision = 0.45416666666666666\nClass Business/Construction_and_Maintenance recall = 0.11401673640167365\nClass Business/Construction_and_Maintenance F1 Measure = 0.18227424749163879\nClass Business/Industrial_Goods_and_Services precision = 0.520618556701031\nClass Business/Industrial_Goods_and_Services recall = 0.1704161979752531\nClass Business/Industrial_Goods_and_Services F1 Measure = 0.25677966101694916\nClass Business/Arts_and_Entertainment precision = 0.5333333333333333\nClass Business/Arts_and_Entertainment recall = 0.09981285090455397\nClass Business/Arts_and_Entertainment F1 Measure = 0.16815554387808726\nClass Business/Business_Services precision = 0.22356495468277945\nClass Business/Business_Services recall = 0.047435897435897434\nClass Business/Business_Services F1 Measure = 0.07826546800634585\nClass Business/Consumer_Goods_and_Services precision = 0.1095890410958904\nClass Business/Consumer_Goods_and_Services recall = 0.01034928848641656\nClass Business/Consumer_Goods_and_Services F1 Measure = 0.018912529550827423\nClass Arts/Visual_Arts precision = 0.5546875\nClass Arts/Visual_Arts recall = 0.048365122615803814\nClass Arts/Visual_Arts F1 Measure = 0.08897243107769423\nClass Society/Issues precision = 0.5050709939148073\nClass Society/Issues recall = 0.1781115879828326\nClass Society/Issues F1 Measure = 0.2633527234267583\nClass Society/People precision = 0.13307984790874525\nClass Society/People recall = 0.02521613832853026\nClass Society/People F1 Measure = 0.04239854633555421\nClass Business/Textiles_and_Nonwovens precision = 0.4444444444444444\nClass Business/Textiles_and_Nonwovens recall = 0.12830793905372895\nClass Business/Textiles_and_Nonwovens F1 Measure = 0.19912881144990666\nClass Society/History precision = 0.5492700729927007\nClass Society/History recall = 0.2789620018535681\nClass Society/History F1 Measure = 0.3700061462814997\nClass Society/Organizations precision = 0.7419354838709677\nClass Society/Organizations recall = 0.13346228239845262\nClass Society/Organizations F1 Measure = 0.22622950819672133\nClass News precision = 0.17513513513513512\nClass News recall = 0.18815331010452963\nClass News F1 Measure = 0.18141097424412092\nWeighted recall = 0.4451504028369677\nWeighted precision = 0.4761176089121932\nWeighted F(1) Score = 0.427643774591954\nWeighted F(0.5) Score = 0.4416588502260708\nWeighted false positive rate = 0.04001023906407413\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=209","$$hashKey":"object:1241"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=210","$$hashKey":"object:1242"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=211","$$hashKey":"object:1243"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=212","$$hashKey":"object:1244"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_2139334646","id":"paragraph_1608562469466_2067663985","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-22T13:45:36+0000","dateFinished":"2020-12-22T13:46:21+0000","status":"FINISHED","$$hashKey":"object:101"},{"text":"%pyspark\nconfusionMatrix = metrics.confusionMatrix()\nprint(confusionMatrix)","user":"lisa","dateUpdated":"2020-12-22T13:46:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DenseMatrix([[8.540e+03, 4.570e+02, 2.120e+02, 4.460e+02, 2.610e+02, 2.430e+02,\n              3.650e+02, 7.700e+01, 9.600e+01, 1.010e+02, 6.600e+01, 8.700e+01,\n              2.330e+02, 4.000e+00, 3.700e+01, 1.600e+01, 1.200e+01, 3.000e+00,\n              1.800e+01, 7.000e+00, 4.000e+00, 1.500e+01, 5.000e+00, 0.000e+00,\n              1.900e+01, 1.800e+01, 2.000e+00, 1.500e+01, 2.000e+00, 2.900e+01],\n             [9.230e+02, 5.456e+03, 3.860e+02, 6.890e+02, 4.060e+02, 4.220e+02,\n              5.000e+02, 8.800e+01, 2.070e+02, 5.800e+01, 8.500e+01, 6.700e+01,\n              3.750e+02, 1.900e+01, 3.200e+01, 4.500e+01, 1.200e+01, 5.000e+00,\n              1.700e+01, 9.000e+00, 9.000e+00, 2.300e+01, 5.000e+00, 2.000e+00,\n              9.000e+00, 2.200e+01, 9.000e+00, 2.200e+01, 5.000e+00, 1.900e+01],\n             [5.710e+02, 4.830e+02, 5.798e+03, 1.155e+03, 4.860e+02, 2.050e+02,\n              3.600e+02, 6.500e+01, 1.030e+02, 1.060e+02, 4.700e+01, 2.900e+01,\n              1.530e+02, 1.300e+01, 3.300e+01, 1.500e+01, 1.200e+01, 4.000e+00,\n              1.800e+01, 1.100e+01, 5.000e+00, 1.300e+01, 8.000e+00, 3.000e+00,\n              9.000e+00, 1.400e+01, 1.700e+01, 1.000e+00, 1.000e+00, 1.900e+01],\n             [8.890e+02, 6.990e+02, 7.280e+02, 4.785e+03, 5.770e+02, 2.970e+02,\n              8.160e+02, 4.100e+01, 6.800e+01, 1.210e+02, 1.580e+02, 3.900e+01,\n              8.300e+01, 1.500e+01, 3.400e+01, 5.300e+01, 5.800e+01, 9.000e+00,\n              5.000e+01, 9.400e+01, 7.000e+00, 3.800e+01, 2.300e+01, 2.000e+00,\n              1.300e+01, 8.000e+00, 3.700e+01, 4.000e+00, 4.000e+00, 3.800e+01],\n             [6.500e+02, 6.440e+02, 6.910e+02, 8.910e+02, 5.435e+03, 1.480e+02,\n              2.600e+02, 2.300e+01, 6.500e+01, 2.670e+02, 9.900e+01, 1.060e+02,\n              1.060e+02, 1.400e+01, 2.700e+01, 2.000e+01, 2.000e+01, 2.000e+00,\n              1.300e+01, 2.800e+01, 5.000e+00, 1.400e+01, 4.000e+00, 4.000e+00,\n              2.400e+01, 1.900e+01, 1.700e+01, 2.800e+01, 1.000e+00, 2.800e+01],\n             [8.870e+02, 9.320e+02, 2.270e+02, 6.450e+02, 1.670e+02, 5.311e+03,\n              3.100e+02, 6.600e+01, 8.800e+01, 6.300e+01, 4.500e+01, 4.100e+01,\n              3.220e+02, 1.500e+01, 1.500e+01, 1.300e+01, 8.000e+00, 3.000e+00,\n              1.100e+01, 1.100e+01, 4.000e+00, 1.800e+01, 6.000e+00, 4.000e+00,\n              7.000e+00, 1.900e+01, 7.000e+00, 2.000e+00, 5.000e+00, 2.200e+02],\n             [8.640e+02, 8.230e+02, 3.410e+02, 7.790e+02, 2.500e+02, 2.520e+02,\n              4.204e+03, 1.330e+02, 1.480e+02, 4.400e+01, 1.120e+02, 4.500e+01,\n              1.630e+02, 1.400e+01, 3.100e+01, 6.300e+01, 6.000e+00, 1.300e+01,\n              1.500e+01, 2.100e+01, 1.100e+01, 1.500e+01, 2.300e+01, 1.400e+01,\n              6.000e+00, 3.000e+00, 2.000e+01, 7.000e+00, 2.000e+00, 4.000e+01],\n             [7.910e+02, 7.020e+02, 2.880e+02, 3.450e+02, 1.780e+02, 2.120e+02,\n              3.280e+02, 2.863e+03, 9.600e+01, 3.900e+01, 2.300e+01, 2.700e+01,\n              5.960e+02, 4.900e+01, 1.900e+01, 1.000e+01, 5.000e+00, 1.700e+01,\n              1.100e+01, 2.000e+00, 6.000e+00, 7.000e+00, 4.000e+00, 1.000e+00,\n              3.000e+00, 1.200e+01, 4.000e+00, 3.000e+00, 1.000e+00, 1.800e+01],\n             [6.580e+02, 7.400e+02, 3.460e+02, 3.660e+02, 2.950e+02, 2.290e+02,\n              3.510e+02, 1.690e+02, 1.677e+03, 1.160e+02, 3.400e+01, 6.600e+01,\n              6.770e+02, 4.610e+02, 6.800e+01, 3.700e+01, 8.000e+00, 2.000e+01,\n              1.600e+01, 3.000e+00, 2.100e+01, 4.000e+00, 0.000e+00, 1.100e+01,\n              9.000e+00, 2.400e+01, 9.000e+00, 2.100e+01, 2.000e+00, 6.500e+01],\n             [6.530e+02, 4.700e+02, 3.360e+02, 6.080e+02, 5.930e+02, 2.590e+02,\n              2.690e+02, 3.100e+01, 6.100e+01, 1.704e+03, 8.500e+01, 5.600e+01,\n              4.900e+01, 1.100e+01, 2.300e+01, 1.100e+01, 2.200e+01, 4.000e+00,\n              1.100e+01, 1.000e+01, 2.000e+00, 1.900e+01, 2.000e+00, 2.000e+00,\n              6.000e+00, 9.000e+00, 1.000e+01, 1.400e+01, 1.600e+01, 6.900e+01],\n             [5.530e+02, 4.710e+02, 1.650e+02, 6.370e+02, 2.810e+02, 1.800e+02,\n              2.190e+02, 2.800e+01, 5.300e+01, 1.180e+02, 2.051e+03, 4.700e+01,\n              8.600e+01, 6.000e+00, 1.300e+01, 1.800e+01, 2.300e+01, 2.000e+00,\n              5.000e+00, 3.000e+00, 5.000e+00, 1.100e+01, 4.000e+00, 1.000e+00,\n              1.400e+01, 8.000e+00, 3.000e+00, 4.000e+00, 2.000e+00, 1.800e+01],\n             [6.620e+02, 5.060e+02, 2.280e+02, 3.840e+02, 3.380e+02, 1.650e+02,\n              1.800e+02, 6.600e+01, 1.200e+02, 9.400e+01, 1.020e+02, 1.255e+03,\n              1.650e+02, 1.200e+01, 6.500e+01, 2.200e+01, 2.100e+01, 3.000e+00,\n              8.000e+00, 0.000e+00, 1.100e+01, 9.000e+00, 1.000e+00, 0.000e+00,\n              5.700e+01, 1.000e+01, 4.000e+00, 5.900e+01, 2.000e+00, 1.400e+01],\n             [2.570e+02, 3.780e+02, 4.040e+02, 1.380e+02, 1.160e+02, 1.380e+02,\n              1.400e+02, 3.100e+01, 7.500e+01, 1.500e+01, 1.300e+01, 1.300e+01,\n              1.683e+03, 3.200e+01, 1.800e+01, 6.000e+00, 2.000e+00, 0.000e+00,\n              4.000e+00, 3.000e+00, 0.000e+00, 0.000e+00, 2.000e+00, 0.000e+00,\n              3.000e+00, 1.000e+01, 3.000e+00, 5.000e+00, 0.000e+00, 6.000e+00],\n             [1.450e+02, 1.360e+02, 5.300e+01, 8.500e+01, 5.400e+01, 4.300e+01,\n              7.200e+01, 4.800e+01, 1.060e+02, 1.800e+01, 4.000e+00, 2.000e+01,\n              1.020e+02, 1.926e+03, 1.800e+01, 2.000e+00, 3.000e+00, 8.000e+00,\n              2.000e+00, 0.000e+00, 0.000e+00, 3.000e+00, 1.000e+00, 1.000e+00,\n              2.000e+00, 7.000e+00, 0.000e+00, 5.000e+00, 0.000e+00, 8.700e+01],\n             [2.980e+02, 1.880e+02, 8.900e+01, 8.100e+01, 1.210e+02, 4.500e+01,\n              7.400e+01, 3.000e+01, 1.560e+02, 2.300e+01, 8.000e+00, 5.000e+01,\n              9.200e+01, 5.200e+01, 8.540e+02, 2.000e+00, 1.000e+00, 1.000e+00,\n              1.000e+00, 0.000e+00, 0.000e+00, 5.000e+00, 1.000e+00, 0.000e+00,\n              2.000e+00, 1.000e+01, 1.000e+00, 1.900e+01, 0.000e+00, 1.200e+01],\n             [2.240e+02, 3.210e+02, 1.290e+02, 2.030e+02, 1.570e+02, 8.900e+01,\n              1.280e+02, 1.300e+01, 6.500e+01, 2.300e+01, 4.100e+01, 1.800e+01,\n              9.500e+01, 1.000e+01, 7.000e+00, 6.920e+02, 1.300e+01, 0.000e+00,\n              1.000e+01, 0.000e+00, 1.000e+00, 3.000e+00, 0.000e+00, 0.000e+00,\n              8.000e+00, 9.000e+00, 1.000e+00, 0.000e+00, 1.000e+00, 8.000e+00],\n             [2.290e+02, 1.190e+02, 9.300e+01, 4.020e+02, 1.000e+02, 5.300e+01,\n              7.900e+01, 8.000e+00, 1.500e+01, 5.600e+01, 2.200e+01, 2.300e+01,\n              1.500e+01, 3.000e+00, 7.000e+00, 5.000e+00, 9.190e+02, 2.000e+00,\n              2.000e+00, 5.000e+00, 2.000e+00, 7.000e+00, 3.000e+00, 0.000e+00,\n              5.000e+00, 7.000e+00, 1.000e+00, 6.000e+00, 0.000e+00, 9.000e+00],\n             [2.950e+02, 2.390e+02, 7.200e+01, 1.650e+02, 6.600e+01, 9.100e+01,\n              8.400e+01, 9.100e+01, 1.630e+02, 3.600e+01, 1.300e+01, 1.600e+01,\n              1.090e+02, 2.360e+02, 3.900e+01, 2.000e+00, 6.000e+00, 2.010e+02,\n              2.000e+00, 1.000e+00, 7.000e+00, 5.000e+00, 4.000e+00, 3.000e+00,\n              3.000e+00, 1.000e+00, 2.000e+00, 2.000e+00, 0.000e+00, 1.400e+01],\n             [2.280e+02, 1.300e+02, 1.190e+02, 6.240e+02, 1.050e+02, 5.900e+01,\n              2.330e+02, 8.000e+00, 2.500e+01, 2.200e+01, 1.700e+01, 7.000e+00,\n              1.700e+01, 3.000e+00, 2.000e+00, 4.000e+00, 1.200e+01, 3.000e+00,\n              2.180e+02, 3.600e+01, 6.000e+00, 8.000e+00, 1.000e+01, 2.000e+00,\n              0.000e+00, 1.000e+00, 7.000e+00, 0.000e+00, 2.000e+00, 4.000e+00],\n             [1.450e+02, 9.000e+01, 8.300e+01, 7.550e+02, 1.120e+02, 3.900e+01,\n              1.480e+02, 3.000e+00, 6.000e+00, 1.600e+01, 9.000e+00, 7.000e+00,\n              9.000e+00, 1.000e+00, 1.000e+00, 4.000e+00, 4.000e+00, 3.000e+00,\n              1.400e+01, 3.030e+02, 1.000e+00, 8.000e+00, 2.000e+00, 1.000e+00,\n              0.000e+00, 0.000e+00, 1.200e+01, 0.000e+00, 0.000e+00, 2.000e+00],\n             [2.380e+02, 1.600e+02, 1.280e+02, 2.700e+02, 7.700e+01, 4.400e+01,\n              1.850e+02, 1.370e+02, 5.900e+01, 1.600e+01, 1.100e+01, 1.200e+01,\n              4.500e+01, 8.000e+00, 6.000e+00, 1.000e+00, 5.000e+00, 2.000e+00,\n              8.000e+00, 5.000e+00, 1.600e+02, 8.000e+00, 6.000e+00, 1.000e+00,\n              1.000e+00, 1.000e+00, 1.000e+00, 0.000e+00, 0.000e+00, 8.000e+00],\n             [1.650e+02, 1.130e+02, 1.750e+02, 5.560e+02, 7.400e+01, 5.000e+01,\n              1.340e+02, 1.700e+01, 5.100e+01, 2.700e+01, 1.800e+01, 1.700e+01,\n              2.800e+01, 4.000e+00, 3.000e+00, 3.000e+00, 2.000e+01, 6.000e+00,\n              4.000e+00, 4.000e+00, 4.000e+00, 7.400e+01, 3.000e+00, 0.000e+00,\n              1.000e+00, 0.000e+00, 4.000e+00, 0.000e+00, 0.000e+00, 5.000e+00],\n             [1.700e+02, 1.700e+02, 8.900e+01, 3.620e+02, 8.000e+01, 6.400e+01,\n              4.610e+02, 1.000e+01, 1.500e+01, 1.500e+01, 5.000e+00, 6.000e+00,\n              1.800e+01, 3.000e+00, 2.000e+00, 3.000e+00, 0.000e+00, 2.000e+00,\n              6.000e+00, 6.000e+00, 3.000e+00, 7.000e+00, 1.600e+01, 2.000e+00,\n              0.000e+00, 0.000e+00, 1.900e+01, 2.000e+00, 1.000e+00, 9.000e+00],\n             [2.800e+02, 1.890e+02, 1.030e+02, 1.300e+02, 9.900e+01, 4.800e+01,\n              2.070e+02, 2.500e+01, 1.640e+02, 2.700e+01, 8.000e+00, 1.900e+01,\n              5.500e+01, 1.000e+00, 4.000e+00, 6.000e+00, 2.000e+00, 2.000e+00,\n              2.000e+00, 1.000e+00, 5.000e+00, 2.000e+00, 7.000e+00, 7.100e+01,\n              0.000e+00, 5.000e+00, 3.000e+00, 1.000e+00, 0.000e+00, 2.000e+00],\n             [1.850e+02, 1.420e+02, 9.200e+01, 1.270e+02, 1.890e+02, 5.000e+01,\n              4.300e+01, 1.100e+01, 2.800e+01, 3.500e+01, 5.900e+01, 7.200e+01,\n              4.300e+01, 8.000e+00, 7.000e+00, 5.000e+00, 1.800e+01, 0.000e+00,\n              1.000e+00, 1.000e+00, 1.000e+00, 4.000e+00, 0.000e+00, 0.000e+00,\n              2.490e+02, 4.000e+00, 2.000e+00, 1.300e+01, 0.000e+00, 9.000e+00],\n             [1.920e+02, 2.160e+02, 1.350e+02, 8.800e+01, 1.250e+02, 5.600e+01,\n              3.100e+01, 3.800e+01, 1.000e+02, 3.900e+01, 4.100e+01, 3.800e+01,\n              1.880e+02, 4.000e+00, 3.000e+00, 1.400e+01, 9.000e+00, 1.000e+00,\n              2.000e+00, 0.000e+00, 2.000e+00, 1.000e+00, 1.000e+00, 1.000e+00,\n              1.200e+01, 3.500e+01, 4.000e+00, 4.000e+00, 1.000e+00, 7.000e+00],\n             [1.260e+02, 9.600e+01, 6.700e+01, 4.030e+02, 8.800e+01, 4.000e+01,\n              1.610e+02, 4.000e+00, 7.000e+00, 1.700e+01, 1.400e+01, 8.000e+00,\n              7.000e+00, 2.000e+00, 3.000e+00, 0.000e+00, 1.000e+00, 0.000e+00,\n              8.000e+00, 1.700e+01, 6.000e+00, 2.000e+00, 3.000e+00, 0.000e+00,\n              2.000e+00, 0.000e+00, 1.600e+02, 3.000e+00, 0.000e+00, 2.000e+00],\n             [1.570e+02, 1.350e+02, 4.000e+01, 4.100e+01, 1.150e+02, 1.900e+01,\n              2.800e+01, 7.000e+00, 2.600e+01, 2.700e+01, 9.000e+00, 5.700e+01,\n              3.500e+01, 1.100e+01, 4.800e+01, 1.000e+00, 3.000e+00, 0.000e+00,\n              1.000e+00, 0.000e+00, 0.000e+00, 1.000e+00, 0.000e+00, 0.000e+00,\n              1.200e+01, 3.000e+00, 0.000e+00, 3.010e+02, 0.000e+00, 2.000e+00],\n             [1.820e+02, 2.290e+02, 4.600e+01, 1.180e+02, 4.700e+01, 5.700e+01,\n              5.200e+01, 6.000e+00, 9.000e+00, 3.000e+01, 1.200e+01, 1.900e+01,\n              6.600e+01, 2.000e+00, 2.000e+00, 1.000e+00, 2.000e+00, 0.000e+00,\n              1.000e+00, 1.000e+00, 0.000e+00, 4.000e+00, 0.000e+00, 0.000e+00,\n              3.000e+00, 1.000e+00, 0.000e+00, 6.000e+00, 1.380e+02, 0.000e+00],\n             [1.690e+02, 8.300e+01, 5.000e+01, 8.300e+01, 4.000e+01, 7.400e+01,\n              4.600e+01, 6.000e+00, 2.800e+01, 2.900e+01, 9.000e+00, 2.000e+01,\n              1.000e+01, 2.000e+00, 4.000e+00, 0.000e+00, 4.000e+00, 3.000e+00,\n              1.000e+00, 0.000e+00, 1.200e+01, 3.000e+00, 2.000e+00, 2.000e+00,\n              1.400e+01, 3.000e+00, 1.000e+00, 1.000e+00, 0.000e+00, 1.620e+02]])\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=213","$$hashKey":"object:1265"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_-887906757","id":"paragraph_1608566045195_1326606234","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-22T13:46:46+0000","dateFinished":"2020-12-22T13:47:00+0000","status":"FINISHED","$$hashKey":"object:102"},{"text":"%pyspark\nprint(sorted(classes))","user":"lisa","dateUpdated":"2020-12-22T13:47:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608638341623_1168996551","id":"paragraph_1608566727656_-934546122","dateCreated":"2020-12-22T11:59:01+0000","dateStarted":"2020-12-22T13:47:04+0000","dateFinished":"2020-12-22T13:47:04+0000","status":"FINISHED","$$hashKey":"object:103"}],"name":"Lisa_Thesis4_classifier(III)","id":"2FTB8HEE7","defaultInterpreterGroup":"spark","version":"0.9.0-SNAPSHOT","permissions":{"owners":["lisa"]},"noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/Lisa_Thesis4_classifier(III)"}