{"paragraphs":[{"text":"%pyspark\nimport pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark import SparkConf\n\n# TODO: Very careful, we claim 32 GB memory on the driver; this is not advisable if multiple people use the cluster.\n#       Current driver node is a r5.4xlarge with 128 GB main memory\n# TODO: I did include this in the options (next line) but maybe this has to be Zeppelin notebook parameter... trying that now.\n#     (\"spark.driver.memory\", \"32g\"),\n\nconf = SparkConf().setAll(\n  [\n    (\"spark.pyspark.virtualenv.enabled\", \"true\"),\n    (\"spark.pyspark.virtualenv.bin.path\", \"/bin/virtualenv\"),\n    (\"spark.pyspark.python\", \"python3\"),\n    (\"spark.driver.maxResultSize\",\"8g\"),\n    (\"spark.executor.memory\", \"8g\"),\n    (\"spark.memory.offHeap.enabled\",\"true\"),\n    (\"spark.memory.offHeap.size\",\"8g\"),\n    (\"spark.rpc.message.maxSize\",\"1024\")\n  ]\n)\n\nspark = SparkSession.builder.appName('Arjen: Train classifier').config(conf=conf).getOrCreate()\n#sparkContext=spark.sparkContext\nsc = spark.sparkContext","user":"arjen","dateUpdated":"2020-12-18T17:57:36+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608237722320_-374102254","id":"paragraph_1608237722320_-374102254","dateCreated":"2020-12-17T20:42:02+0000","dateStarted":"2020-12-18T17:57:36+0000","dateFinished":"2020-12-18T17:58:00+0000","status":"FINISHED","focus":true,"$$hashKey":"object:188"},{"text":"%pyspark\nspark.sql(\"DROP TABLE IF EXISTS cccc\")\nspark.sql(\n    \"CREATE TABLE cccc(categories STRING, title STRING, url STRING, cleaned_content STRING, maincategory STRING) \" +\n    \"USING parquet PARTITIONED BY(maincategory) CLUSTERED BY(categories) INTO 12 BUCKETS \" +\n    \"LOCATION 'hdfs:/user/arjen/cccc'\"\n)\nspark.sql(\"MSCK REPAIR TABLE cccc\")","user":"arjen","dateUpdated":"2020-12-18T17:57:40+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[]\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=0","$$hashKey":"object:1823"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327321_-1298270395","id":"paragraph_1608035171689_1330727932","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-18T17:57:40+0000","dateFinished":"2020-12-18T17:58:04+0000","status":"FINISHED","$$hashKey":"object:189"},{"text":"%md\n## Prepare dataset\n\nSelect the labels that we want to train a classifier on.","user":"arjen","dateUpdated":"2020-12-18T18:21:59+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Prepare dataset</h2>\n<p>Select the labels that we want to train a classifier on.</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608315621926_-2001603869","id":"paragraph_1608315621926_-2001603869","dateCreated":"2020-12-18T18:20:21+0000","dateStarted":"2020-12-18T18:21:57+0000","dateFinished":"2020-12-18T18:21:57+0000","status":"FINISHED","$$hashKey":"object:190"},{"text":"%pyspark\ndf = spark.table(\"CCCC\")\ndf.show()","user":"lisa","dateUpdated":"2021-01-15T11:58:28+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+------------+\n|          categories|               title|                 url|     cleaned_content|maincategory|\n+--------------------+--------------------+--------------------+--------------------+------------+\n|Top/Computers/Sof...|    A Real Validator|http://arealvalid...|real validator tr...|   Computers|\n|Top/Computers/Sys...|AROS: Amiga Resea...|http://aros.sourc...|aros research ope...|   Computers|\n|Top/Computers/Sof...|            Homebrew|     http://brew.sh/|homebrew missing ...|   Computers|\n|Top/Computers/Pro...|            SQLiteDB|http://code.jense...|sqlitedb sqlite p...|   Computers|\n|Top/Computers/Pro...|SQL Injection - C...|http://shiflett.o...|sql injection chr...|   Computers|\n|Top/Computers/Sof...|      Alien Software|http://www.aliens...|health network he...|   Computers|\n|Top/Computers/Sof...|United Systems Te...|http://www.asyst3...|home ddrjquery wi...|   Computers|\n|Top/Computers/Rob...|Chicago Area Robo...|http://www.chibot...|chibots < >< cdat...|   Computers|\n|Top/Computers/Sof...|CreativeMac: Core...|http://www.creati...|corel painter ix ...|   Computers|\n|Top/Computers/Mul...|      SoundConverter|http://www.dekort...|                    |   Computers|\n|Top/Computers/Sof...|    Desktop Icon Toy|http://www.idesks...|desktop icon toy ...|   Computers|\n|Top/Computers/Sof...|     Internet-Drafts|http://www.ietf.o...|internet draft d ...|   Computers|\n|Top/Computers/Sof...|Raise the Red Fla...|http://www.linuxj...|window nreum nreu...|   Computers|\n|Top/Computers/Pro...|     LK Bin Database|http://www.lksoft...|function w c { w ...|   Computers|\n|Top/Computers/Int...|    Response-O-Matic|http://www.respon...|create online con...|   Computers|\n|Top/Computers/Sof...|    SoftwareArchives|http://www.softwa...|softwarearchives ...|   Computers|\n|Top/Computers/Int...|          TweetsWind|http://www.tweets...|tweetswind displa...|   Computers|\n|Top/Computers/Pro...|Jini Security : A...|http://citeseerx....|citeseerx securit...|   Computers|\n|Top/Computers/Pro...|             WebMail|http://jwebmail.s...|             webmail|   Computers|\n|Top/Computers/Sof...|               VVCap|   http://vvcap.com/|vvcap screenshots...|   Computers|\n+--------------------+--------------------+--------------------+--------------------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=31","$$hashKey":"object:5050"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327321_-1292663937","id":"paragraph_1608035211269_984239908","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2021-01-15T11:58:28+0000","dateFinished":"2021-01-15T11:58:34+0000","status":"FINISHED","$$hashKey":"object:191"},{"text":"%pyspark\ndf.count()","user":"lisa","dateUpdated":"2021-01-15T11:58:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"514506\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=32","$$hashKey":"object:5085"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_-1281501231","id":"paragraph_1608132307379_-1183109900","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2021-01-15T11:58:33+0000","dateFinished":"2021-01-15T11:58:35+0000","status":"FINISHED","$$hashKey":"object:192"},{"text":"%pyspark\ndf2 = spark.sql(\"SELECT maincategory,regexp_replace(categories, 'Top/([^/]+)(/[^/]+)?/?.*?$', '$1$2') as categories,title,url,cleaned_content FROM CCCC\")","user":"lisa","dateUpdated":"2021-01-15T11:58:36+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133342455_722245131","id":"paragraph_1608133342455_722245131","dateCreated":"2020-12-16T15:42:22+0000","dateStarted":"2021-01-15T11:58:36+0000","dateFinished":"2021-01-15T11:58:36+0000","status":"FINISHED","$$hashKey":"object:193"},{"text":"%pyspark\ndf2.show(10)","user":"lisa","dateUpdated":"2020-12-27T16:33:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+--------------------+--------------------+\n|maincategory|          categories|               title|                 url|     cleaned_content|\n+------------+--------------------+--------------------+--------------------+--------------------+\n|   Computers|  Computers/Software|    A Real Validator|http://arealvalid...|real validator tr...|\n|   Computers|   Computers/Systems|AROS: Amiga Resea...|http://aros.sourc...|aros research ope...|\n|   Computers|  Computers/Software|            Homebrew|     http://brew.sh/|homebrew missing ...|\n|   Computers|Computers/Program...|            SQLiteDB|http://code.jense...|sqlitedb sqlite p...|\n|   Computers|Computers/Program...|SQL Injection - C...|http://shiflett.o...|sql injection chr...|\n|   Computers|  Computers/Software|      Alien Software|http://www.aliens...|health network he...|\n|   Computers|  Computers/Software|United Systems Te...|http://www.asyst3...|home ddrjquery wi...|\n|   Computers|  Computers/Robotics|Chicago Area Robo...|http://www.chibot...|chibots < >< cdat...|\n|   Computers|  Computers/Software|CreativeMac: Core...|http://www.creati...|corel painter ix ...|\n|   Computers|Computers/Multimedia|      SoundConverter|http://www.dekort...|                    |\n+------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=408","$$hashKey":"object:2066"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_1536954809","id":"paragraph_1608132909171_1334827624","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-27T16:33:27+0000","dateFinished":"2020-12-27T16:33:27+0000","status":"FINISHED","$$hashKey":"object:194"},{"text":"%pyspark\ndfCat2 = spark.sql(\"SELECT regexp_replace(categories, 'Top/([^/]+)(/[^/]+)?/?.*?$', '$1$2') AS subgroups, count(*) AS c FROM CCCC GROUP BY subgroups HAVING COUNT(categories) > 100 ORDER BY c DESC\")\ndfCat2 = dfCat2.select(\"subgroups\")","user":"lisa","dateUpdated":"2021-01-15T11:58:40+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608232115880_-111413622","id":"paragraph_1608232115880_-111413622","dateCreated":"2020-12-17T19:08:35+0000","dateStarted":"2021-01-15T11:58:40+0000","dateFinished":"2021-01-15T11:58:40+0000","status":"FINISHED","$$hashKey":"object:195"},{"text":"%pyspark\ndf2.createOrReplaceTempView(\"DF2\")\ndfCat2.createOrReplaceTempView(\"DFCAT2\")","user":"lisa","dateUpdated":"2021-01-15T11:58:42+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608232114658_-1901715166","id":"paragraph_1608232114658_-1901715166","dateCreated":"2020-12-17T19:08:34+0000","dateStarted":"2021-01-15T11:58:42+0000","dateFinished":"2021-01-15T11:58:42+0000","status":"FINISHED","$$hashKey":"object:196"},{"text":"%pyspark\ndf3 = spark.sql(\"SELECT * FROM DFCAT2 c, DF2 e WHERE c.subgroups == e.categories\")\ndf3.show()","user":"lisa","dateUpdated":"2021-01-15T11:58:44+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+------------+-------------------+--------------------+--------------------+--------------------+\n|          subgroups|maincategory|         categories|               title|                 url|     cleaned_content|\n+-------------------+------------+-------------------+--------------------+--------------------+--------------------+\n|Shopping/Recreation|    Shopping|Shopping/Recreation|       High On Ropes|http://www.highon...|climbing rope res...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Saint-Petersburg ...|http://www.paleoa...|paleoart com sain...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|  Masters Miniatures|http://www.master...|supply handmade m...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Beaverkill Fly Ro...|https://www.bkrod...|home page beaverk...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|    Paleosearch Inc.|http://www.paleos...|paleosearch high ...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|    The Fossil Store|https://www.thefo...|fossil store prem...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|De Roos Autominia...|http://www.deroos...|de roos autominia...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Margie's Petite P...|http://hand-paint...|margie petite pal...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|  The Dinosaur Store|http://www.dinosa...|dinosaur store fo...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Cotswold Heritage...|http://www.models...|steam engine cots...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Tom Morgan Rodsmiths|http://www.troutr...|tom morgan rodsmi...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|     PowerLinx, Inc.|http://www.seavie...|seaview underwate...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|              Trango|http://www.trango...|rock climbing gea...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|          Rock + Run|http://www.rockru...|rock run speciali...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Stuart Models Sta...|http://www.stuart...|body { font size ...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Black Hills Insti...|http://www.bhigr....|black hill instit...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|  Dolphins Unlimited|http://www.dolphi...|function f b c g ...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|S &amp; S Furnitu...|http://handcrafte...|furniture company...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|   Grand Prix Models|http://www.grandp...|die cast model ca...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Uncle Ciggie's Mi...|http://www.unclec...|miniature wicker ...|\n+-------------------+------------+-------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=33","$$hashKey":"object:5170"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=34","$$hashKey":"object:5171"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608232183709_-399847021","id":"paragraph_1608232183709_-399847021","dateCreated":"2020-12-17T19:09:43+0000","dateStarted":"2021-01-15T11:58:44+0000","dateFinished":"2021-01-15T11:58:58+0000","status":"FINISHED","$$hashKey":"object:197"},{"text":"%pyspark\ndf3.count()","user":"lisa","dateUpdated":"2021-01-15T11:58:46+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"509082\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=35","$$hashKey":"object:5220"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=36","$$hashKey":"object:5221"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608232191117_536359946","id":"paragraph_1608232191117_536359946","dateCreated":"2020-12-17T19:09:51+0000","dateStarted":"2021-01-15T11:58:46+0000","dateFinished":"2021-01-15T11:59:04+0000","status":"FINISHED","$$hashKey":"object:198"},{"text":"%pyspark\nspark.sql(\"SELECT regexp_replace(categories, 'Top/([^/]+)(/[^/]+)?/?.*?$', '$1$2') AS subgroups, count(*) AS c FROM CCCC GROUP BY subgroups HAVING COUNT(categories) > 100 ORDER BY c DESC\").show()","user":"lisa","dateUpdated":"2020-12-22T11:18:41+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":504,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|           subgroups|    c|\n+--------------------+-----+\n|Society/Religion_...|45752|\n|          Arts/Music|26729|\n| Reference/Education|15625|\n|         Arts/Movies|11888|\n|  Computers/Software|11835|\n|     Science/Biology|11174|\n|   Games/Video_Games| 9249|\n|     Arts/Literature| 9206|\n|         Society/Law| 8651|\n|Arts/Performing_Arts| 7917|\n|  Computers/Internet| 7832|\n|Business/Construc...| 7539|\n|Science/Social_Sc...| 7519|\n|Computers/Program...| 7263|\n|     Recreation/Pets| 7201|\n|Business/Industri...| 7138|\n| Recreation/Outdoors| 6718|\n|Business/Arts_and...| 6615|\n|Business/Business...| 6181|\n|Business/Consumer...| 6109|\n+--------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=111","$$hashKey":"object:2319"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608635427781_170702221","id":"paragraph_1608635427781_170702221","dateCreated":"2020-12-22T11:10:27+0000","dateStarted":"2020-12-22T11:18:19+0000","dateFinished":"2020-12-22T11:18:30+0000","status":"FINISHED","$$hashKey":"object:199"},{"text":"%pyspark\nspark.sql(\"SELECT regexp_replace(categories, 'Top/([^/]+)(/[^/]+)?/?.*?$', '$1$2') AS subgroups, count(*) AS c FROM CCCC GROUP BY subgroups HAVING COUNT(categories) > 100 ORDER BY c ASC\").show()","user":"lisa","dateUpdated":"2020-12-22T11:18:45+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":534,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---+\n|           subgroups|  c|\n+--------------------+---+\n|    Sports/Badminton|101|\n|Business/News_and...|102|\n|   Shopping/Weddings|103|\n|        Arts/Digital|103|\n|Computers/Artific...|106|\n|   Games/Conventions|110|\n|        Sports/Darts|111|\n|      Society/Future|115|\n|       Health/Senses|116|\n|       Sports/Squash|118|\n|Computers/Human-C...|122|\n|    Recreation/Kites|128|\n|   Computers/History|130|\n|    Shopping/Tobacco|130|\n|Computers/Virtual...|130|\n|   Shopping/Auctions|130|\n|    Computers/Usenet|131|\n|       Sports/Gaelic|133|\n|  Reference/Archives|134|\n|Health/Women's_He...|134|\n+--------------------+---+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=112","$$hashKey":"object:2370"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608635698411_-1739707470","id":"paragraph_1608635698411_-1739707470","dateCreated":"2020-12-22T11:14:58+0000","dateStarted":"2020-12-22T11:18:25+0000","dateFinished":"2020-12-22T11:18:31+0000","status":"FINISHED","$$hashKey":"object:200"},{"text":"%pyspark\nspark.sql(\"SELECT regexp_replace(categories, 'Top/([^/]+)(/[^/]+)?/?.*?$', '$1$2') AS subgroups, count(*) AS c FROM CCCC GROUP BY subgroups HAVING COUNT(categories) > 100 ORDER BY c ASC\").count()","user":"lisa","dateUpdated":"2020-12-22T11:15:46+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"277\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=109","$$hashKey":"object:2421"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=110","$$hashKey":"object:2422"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608635739872_-64371111","id":"paragraph_1608635739872_-64371111","dateCreated":"2020-12-22T11:15:39+0000","dateStarted":"2020-12-22T11:15:46+0000","dateFinished":"2020-12-22T11:15:47+0000","status":"FINISHED","$$hashKey":"object:201"},{"text":"%pyspark\ndf3.groupby('categories').count().sort('count', ascending=False).show(277)","user":"lisa","dateUpdated":"2021-01-15T12:03:54+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=45","$$hashKey":"object:5739"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=46","$$hashKey":"object:5740"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1610712196001_-1085386579","id":"paragraph_1610712196001_-1085386579","dateCreated":"2021-01-15T12:03:16+0000","status":"FINISHED","focus":true,"$$hashKey":"object:5555","dateFinished":"2021-01-15T12:03:59+0000","dateStarted":"2021-01-15T12:03:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|          categories|count|\n+--------------------+-----+\n|Society/Religion_...|45752|\n|          Arts/Music|26729|\n| Reference/Education|15625|\n|         Arts/Movies|11888|\n|  Computers/Software|11835|\n|     Science/Biology|11174|\n|   Games/Video_Games| 9249|\n|     Arts/Literature| 9206|\n|         Society/Law| 8651|\n|Arts/Performing_Arts| 7917|\n|  Computers/Internet| 7832|\n|Business/Construc...| 7539|\n|Science/Social_Sc...| 7519|\n|Computers/Program...| 7263|\n|     Recreation/Pets| 7201|\n|Business/Industri...| 7138|\n| Recreation/Outdoors| 6718|\n|Business/Arts_and...| 6615|\n|Business/Business...| 6181|\n|Business/Consumer...| 6109|\n|    Arts/Visual_Arts| 6026|\n|       Sports/Soccer| 5705|\n|      Society/Issues| 5670|\n|      Society/People| 5377|\n|Business/Textiles...| 4908|\n|     Recreation/Food| 4723|\n|Health/Conditions...| 4649|\n|     Society/History| 4299|\n|        Home/Cooking| 4270|\n|Society/Organizat...| 4206|\n|        Science/Math| 4006|\n|     Health/Medicine| 3861|\n|Business/Financia...| 3831|\n|  Science/Technology| 3634|\n|     Arts/Television| 3571|\n|Shopping/Home_and...| 3505|\n|      Arts/Animation| 3476|\n|         Sports/Golf| 3427|\n|         Arts/People| 3273|\n|Business/Transpor...| 3112|\n|   Recreation/Travel| 3032|\n|Business/Electron...| 2985|\n|   Sports/Equestrian| 2879|\n|     Shopping/Crafts| 2813|\n|    Recreation/Autos| 2791|\n|       Shopping/Food| 2778|\n|Business/Agricult...| 2748|\n|   Reference/Museums| 2716|\n|Business/Food_and...| 2676|\n|     Sports/Football| 2567|\n|         Arts/Crafts| 2524|\n|     Shopping/Sports| 2247|\n|Science/Earth_Sci...| 2246|\n|   Sports/Basketball| 2241|\n| Science/Environment| 2235|\n|   Society/Ethnicity| 2227|\n|     Shopping/Health| 2165|\n|   Society/Genealogy| 2149|\n|Business/Marketin...| 2123|\n|       Health/Animal| 2080|\n|  Computers/Hardware| 2069|\n|   Shopping/Clothing| 2065|\n| Shopping/Recreation| 1991|\n|Recreation/Collec...| 1987|\n|  Society/Philosophy| 1970|\n|Business/Publishi...| 1962|\n|  Sports/Motorsports| 1891|\n| Sports/Martial_Arts| 1884|\n| Sports/Water_Sports| 1879|\n|  Health/Alternative| 1861|\n|      Home/Gardening| 1846|\n|   Shopping/Vehicles| 1823|\n| Business/Healthcare| 1807|\n| Recreation/Scouting| 1801|\n|    Arts/Art_History| 1776|\n|     News/Newspapers| 1752|\n|Health/Mental_Health| 1749|\n|Business/Telecomm...| 1697|\n|     Sports/Baseball| 1688|\n|  Business/Chemicals| 1654|\n| Recreation/Aviation| 1654|\n|Shopping/Visual_Arts| 1651|\n|   Science/Astronomy| 1647|\n|  Business/Investing| 1644|\n|     Business/Energy| 1598|\n|     Science/Physics| 1592|\n|Shopping/Antiques...| 1561|\n|   Science/Chemistry| 1541|\n|    Arts/Photography| 1538|\n|         Home/Family| 1525|\n| Arts/Online_Writing| 1392|\n|    Recreation/Humor| 1362|\n|      Sports/Cycling| 1341|\n|         Arts/Comics| 1324|\n|Shopping/Publicat...| 1311|\n|       Sports/Hockey| 1273|\n|Arts/Writers_Reso...| 1273|\n|   Arts/Architecture| 1246|\n|    Recreation/Radio| 1226|\n|Society/Philanthropy| 1221|\n|   Computers/Systems| 1219|\n| Business/Automotive| 1169|\n|      Sports/Running| 1155|\n| Science/Agriculture| 1151|\n|Shopping/Consumer...| 1133|\n|  Recreation/Boating| 1104|\n|Society/Relations...| 1104|\n|Society/Gay,_Lesb...| 1073|\n|Shopping/Entertai...| 1072|\n|Business/Hospitality| 1068|\n|Health/Public_Hea...| 1050|\n|Computers/Data_Fo...| 1036|\n|    Society/Politics| 1021|\n|Computers/Multimedia| 1020|\n|       Society/Death|  973|\n| Business/Accounting|  969|\n|Sports/Winter_Sports|  951|\n| Reference/Libraries|  950|\n|          Arts/Radio|  922|\n|    Shopping/Jewelry|  915|\n| Business/Management|  904|\n|   Arts/Illustration|  885|\n|   Games/Board_Games|  880|\n|   Health/Addictions|  875|\n|   Games/Roleplaying|  874|\n|      Shopping/Music|  874|\n|       Shopping/Pets|  870|\n|    Society/Holidays|  863|\n|Recreation/Motorc...|  860|\n|  Computers/Security|  839|\n|     Health/Pharmacy|  834|\n|Science/Instrumen...|  814|\n|  Society/Paranormal|  791|\n|Computers/Compute...|  766|\n|      Games/Gambling|  765|\n|Home/Consumer_Inf...|  752|\n|Recreation/Living...|  751|\n|    Society/Military|  751|\n|Business/Aerospac...|  744|\n|  Society/Government|  723|\n|Business/Environment|  675|\n|  Business/Materials|  673|\n|Shopping/Toys_and...|  661|\n|Business/Real_Estate|  645|\n|Business/Opportun...|  639|\n|      Arts/Education|  633|\n|  Computers/Graphics|  624|\n|       Sports/Tennis|  620|\n|        Games/Online|  615|\n|  Recreation/Birding|  608|\n|      Sports/Cricket|  591|\n|Business/Biotechn...|  588|\n|     News/Journalism|  580|\n|Sports/Track_and_...|  574|\n|Health/Reproducti...|  565|\n|       Society/Crime|  543|\n|   Recreation/Models|  527|\n|Reference/Diction...|  515|\n|   Sports/Volleyball|  512|\n|      Shopping/Gifts|  510|\n|     Sports/Softball|  503|\n|Computers/Artific...|  497|\n|Recreation/Roads_...|  481|\n|    Recreation/Camps|  473|\n|      Sports/Skating|  470|\n|Business/Retail_T...|  463|\n|Computers/Consult...|  455|\n|Recreation/Trains...|  454|\n|    Shopping/Flowers|  453|\n|     Recreation/Guns|  447|\n|Shopping/Ethnic_a...|  442|\n| Society/Subcultures|  433|\n| Recreation/Antiques|  431|\n|    Sports/Wrestling|  429|\n|  Health/Professions|  422|\n|    Games/Card_Games|  419|\n|       Sports/Events|  418|\n| Recreation/Climbing|  404|\n|Business/Informat...|  393|\n|         Arts/Design|  391|\n|Reference/Knowled...|  390|\n|Business/Educatio...|  376|\n| Business/Employment|  374|\n|    Society/Folklore|  372|\n|   Shopping/Children|  371|\n|    Society/Disabled|  358|\n|Computers/Data_Co...|  355|\n|       Games/Puzzles|  348|\n|      Health/Nursing|  348|\n|Computers/Open_So...|  342|\n|         Arts/Genres|  341|\n|  Computers/Robotics|  337|\n|Business/Small_Bu...|  323|\n|Shopping/General_...|  322|\n|Computers/CAD_and...|  311|\n|    Games/Miniatures|  302|\n|      Shopping/Tools|  300|\n|     Sports/Lacrosse|  300|\n|Science/Science_i...|  294|\n|   Recreation/Nudism|  290|\n|Business/Human_Re...|  289|\n|Shopping/Office_P...|  287|\n|      Shopping/Niche|  284|\n|   Sports/Gymnastics|  280|\n| Sports/Flying_Discs|  271|\n|    Society/Activism|  266|\n|Home/Personal_Fin...|  264|\n|Business/Internat...|  263|\n|News/Colleges_and...|  261|\n|Society/Lifestyle...|  256|\n| Computers/Emulators|  255|\n|        Arts/Bodyart|  251|\n|     Reference/Flags|  246|\n|      Sports/Fencing|  244|\n|Society/Transgend...|  240|\n|   Shopping/Holidays|  240|\n|Shopping/Photography|  236|\n|Sports/Strength_S...|  235|\n|       Games/Coin-Op|  226|\n|Health/Senior_Health|  225|\n|Recreation/Theme_...|  223|\n|Science/Anomalies...|  223|\n|      Sports/Bowling|  222|\n|  Arts/Organizations|  219|\n|Sports/Skateboarding|  219|\n| Sports/Cheerleading|  215|\n|    Sports/Paintball|  212|\n| Business/E-Commerce|  211|\n| News/Media_Industry|  207|\n|Business/Mining_a...|  200|\n|    Health/Dentistry|  197|\n|    Health/Nutrition|  197|\n| Computers/Education|  196|\n| Arts/Graphic_Design|  196|\n|   Society/Sexuality|  192|\n| Computers/Companies|  191|\n|      Sports/Fantasy|  190|\n|  Arts/Entertainment|  188|\n|Shopping/Classifieds|  185|\n|Computers/Mobile_...|  180|\n|        Society/Work|  179|\n|       Health/Beauty|  175|\n|Home/Home_Improve...|  168|\n|Computers/Paralle...|  163|\n|Computers/Algorithms|  153|\n|    Sports/Resources|  148|\n|Computers/Speech_...|  148|\n|Health/Occupation...|  146|\n| Sports/Multi-Sports|  145|\n|News/Analysis_and...|  145|\n|Games/Trading_Car...|  144|\n|   Science/Reference|  142|\n|Reference/Quotations|  142|\n| Health/Child_Health|  141|\n|Arts/Classical_St...|  140|\n|       Sports/Boxing|  136|\n|Science/Education...|  134|\n|  Reference/Archives|  134|\n|Health/Women's_He...|  134|\n|       Sports/Gaelic|  133|\n|    Computers/Usenet|  131|\n|   Shopping/Auctions|  130|\n|Computers/Virtual...|  130|\n|   Computers/History|  130|\n|    Shopping/Tobacco|  130|\n|    Recreation/Kites|  128|\n|Computers/Human-C...|  122|\n|       Sports/Squash|  118|\n|       Health/Senses|  116|\n|      Society/Future|  115|\n|        Sports/Darts|  111|\n|   Games/Conventions|  110|\n|Computers/Artific...|  106|\n|        Arts/Digital|  103|\n|   Shopping/Weddings|  103|\n|Business/News_and...|  102|\n|    Sports/Badminton|  101|\n+--------------------+-----+\n\n"}]}},{"text":"%md\n## Prepare Training Data\n\nTransform the dataset in a dataframe of <features, label> pairs.","user":"arjen","dateUpdated":"2020-12-18T18:23:01+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Prepare Training Data</h2>\n<p>Transform the dataset in a dataframe of <features, label> pairs.</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608315652411_-1366206688","id":"paragraph_1608315652411_-1366206688","dateCreated":"2020-12-18T18:20:52+0000","dateStarted":"2020-12-18T18:22:58+0000","dateFinished":"2020-12-18T18:22:58+0000","status":"FINISHED","$$hashKey":"object:202"},{"text":"%pyspark\nfrom pyspark.ml import Pipeline, PipelineModel\nfrom pyspark.ml.classification import LogisticRegression\nfrom pyspark.ml.feature import HashingTF, Tokenizer, StringIndexer, IndexToString\n\n# Configure an ML pipeline\nindexer = StringIndexer(inputCol=\"categories\", outputCol=\"label\", handleInvalid=\"keep\")\ntokenizer = Tokenizer(inputCol=\"cleaned_content\", outputCol=\"words\")\nhashingTF = HashingTF(inputCol=tokenizer.getOutputCol(), outputCol=\"features\")\nfeatpl = Pipeline(stages=[indexer, tokenizer, hashingTF])\n\n#lr = LogisticRegression(maxIter=10, regParam=0.001)\n#, tokenizer, hashingTF, lr])\n\n# TODO: naming pipelines after settling on final solution\n# TODO: train-test split after producing the features and dropping the other columns","user":"lisa","dateUpdated":"2020-12-27T16:34:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_813353602","id":"paragraph_1606248095976_-1153341034","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-27T16:34:31+0000","dateFinished":"2020-12-27T16:34:31+0000","status":"FINISHED","$$hashKey":"object:203"},{"text":"%pyspark\n# Prepare for feature transformation of the dataset\nfmodel = featpl.fit(df3)\n\n# Apply feature model to the dataset\nd = fmodel.transform(df3)\nd.show()","user":"lisa","dateUpdated":"2020-12-27T16:34:37+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+------------+-------------------+--------------------+--------------------+--------------------+-----+--------------------+--------------------+\n|          subgroups|maincategory|         categories|               title|                 url|     cleaned_content|label|               words|            features|\n+-------------------+------------+-------------------+--------------------+--------------------+--------------------+-----+--------------------+--------------------+\n|Shopping/Recreation|    Shopping|Shopping/Recreation|      Shivadas Glass|http://shivadas.com/|shivadas glass or...| 62.0|[shivadas, glass,...|(262144,[1879,267...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation| Fireball Modelworks|http://www.fireba...|fireball modelwor...| 62.0|[fireball, modelw...|(262144,[16269,21...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|  ISG Fishing Tackle|http://www.isgfis...|isg mean fishing ...| 62.0|[isg, mean, fishi...|(262144,[836,5950...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|       Moon Property|http://www.lunarr...|lunar registry bu...| 62.0|[lunar, registry,...|(262144,[535,2325...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Vacuum Formers fo...|http://www.warmpl...|vacuum forming ta...| 62.0|[vacuum, forming,...|(262144,[22588,32...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|              Relics|http://www.relics...|relic replica wea...| 62.0|[relic, replica, ...|(262144,[1836,243...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|               Mepps|http://www.mepps....|fishing lure buy ...| 62.0|[fishing, lure, b...|(262144,[43996,64...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation| Puddle Jumper Lures|http://puddlejump...|puddle jumper lur...| 62.0|[puddle, jumper, ...|(262144,[171,991,...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|      REC Components| http://www.rec.com/|rec component sin...| 62.0|[rec, component, ...|(262144,[1998,538...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|   Marijana Seedshop|https://www.marij...|buy marijuana can...| 62.0|[buy, marijuana, ...|(262144,[2769,303...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|   JT's Sharks Teeth|http://www.jtssha...|jtssharksteeth bu...| 62.0|[jtssharksteeth, ...|(262144,[2325,302...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|           RC Tackle|http://www.rctack...|rc tackle < cdata...| 62.0|[rc, tackle, <, c...|(262144,[2835,335...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Big Head Crappie ...|http://www.bighea...|crappie jig bette...| 62.0|[crappie, jig, be...|(262144,[14,991,1...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|        Utopia Tools|http://www.utopia...|ns4 write < scr i...| 62.0|[ns4, write, <, s...|(262144,[98,2437,...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|  ScaleModelSoldiers|http://www.scalem...|scalemodelsoldier...| 62.0|[scalemodelsoldie...|(262144,[6051,614...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|       Curly's Lures|http://curlyslure...|bass fishing lure...| 62.0|[bass, fishing, l...|(262144,[5136,822...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|     Canyon Plastics|http://www.canyon...|canyon plastic ba...| 62.0|[canyon, plastic,...|(262144,[98,1586,...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|       Living Rubber|http://www.living...|living rubber co ...| 62.0|[living, rubber, ...|(262144,[1493,283...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Booysen Handmade ...|http://www.cbkniv...|mweb business ach...| 62.0|[mweb, business, ...|(262144,[56737,90...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|   The Amber Company|http://www.amberc...|< function redire...| 62.0|[<, function, red...|(262144,[170,3434...|\n+-------------------+------------+-------------------+--------------------+--------------------+--------------------+-----+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=413","$$hashKey":"object:2567"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=414","$$hashKey":"object:2568"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=415","$$hashKey":"object:2569"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=416","$$hashKey":"object:2570"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608226098291_-1549446212","id":"paragraph_1608226098291_-1549446212","dateCreated":"2020-12-17T17:28:18+0000","dateStarted":"2020-12-27T16:34:37+0000","dateFinished":"2020-12-27T16:34:50+0000","status":"FINISHED","$$hashKey":"object:204"},{"text":"%pyspark\nd = d.drop(\"subgroups\", \"title\", \"cleaned_content\")  #?? .repartition(400)","user":"arjen","dateUpdated":"2020-12-18T17:58:31+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608226408153_-467021797","id":"paragraph_1608226408153_-467021797","dateCreated":"2020-12-17T17:33:28+0000","dateStarted":"2020-12-18T17:58:31+0000","dateFinished":"2020-12-18T17:58:36+0000","status":"FINISHED","$$hashKey":"object:205"},{"text":"%pyspark\nsplits = d.randomSplit([0.75, 0.25], 24)\ntrainDF = splits[0]\ntestDF = splits[1]\ntrainDF.write.format(\"parquet\").option(\"compression\",\"none\").partitionBy(\"maincategory\").option(\"path\",\"hdfs:/user/arjen/trainDF\").saveAsTable('TrainCatLevel2')\ntestDF.write.format(\"parquet\").option(\"compression\",\"none\").partitionBy(\"maincategory\").option(\"path\",\"hdfs:/user/arjen/testDF\").saveAsTable('TestCatLevel2')","user":"arjen","dateUpdated":"2020-12-18T17:58:36+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=12","$$hashKey":"object:2678"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=13","$$hashKey":"object:2679"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=14","$$hashKey":"object:2680"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=15","$$hashKey":"object:2681"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=16","$$hashKey":"object:2682"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=17","$$hashKey":"object:2683"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_1111854622","id":"paragraph_1606305261163_-476012457","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-18T17:58:36+0000","dateFinished":"2020-12-18T18:00:49+0000","status":"FINISHED","$$hashKey":"object:206"},{"text":"%pyspark\ntrainDF.show()","user":"arjen","dateUpdated":"2020-12-18T17:58:47+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-------------------+--------------------+-----+--------------------+--------------------+\n|maincategory|         categories|                 url|label|               words|            features|\n+------------+-------------------+--------------------+-----+--------------------+--------------------+\n|    Shopping|Shopping/Recreation|http://2catchfish...| 62.0|[quality, fishing...|(262144,[929,1410...|\n|    Shopping|Shopping/Recreation|http://3riversgam...| 62.0|[hand, made, game...|(262144,[1306,372...|\n|    Shopping|Shopping/Recreation|      http://a-n.cz/| 62.0|[art, natur, func...|(262144,[269,925,...|\n|    Shopping|Shopping/Recreation|http://aaamunitio...| 62.0|[civil, war, arti...|(262144,[535,2437...|\n|    Shopping|Shopping/Recreation|http://acd-miniat...| 62.0|[acd, miniature, ...|(262144,[4881,543...|\n|    Shopping|Shopping/Recreation|http://adventuref...| 62.0|[adventure, fishi...|(262144,[7629,844...|\n|    Shopping|Shopping/Recreation|http://aecweb.tri...| 62.0|[e, c, internatio...|(262144,[7278,822...|\n|    Shopping|Shopping/Recreation| http://airmania.de/| 62.0|[airmania, kite, ...|(262144,[4584,462...|\n|    Shopping|Shopping/Recreation|http://ajh-knives...| 62.0|[ajh, custom, kni...|(262144,[1613,109...|\n|    Shopping|Shopping/Recreation|http://alabamafla...| 62.0|[<, document, ist...|(262144,[7278,822...|\n|    Shopping|Shopping/Recreation|http://albion-swo...| 62.0|[var, gajshost, h...|(262144,[43996,64...|\n|    Shopping|Shopping/Recreation|http://amandaeski...| 62.0|[amanda, e, skinn...|(262144,[4200,580...|\n|    Shopping|Shopping/Recreation|http://amberlady....| 62.0|[amber, lady, fos...|(262144,[2673,573...|\n|    Shopping|Shopping/Recreation|http://americanfl...| 62.0|[american, flyer,...|(262144,[3778,822...|\n|    Shopping|Shopping/Recreation|http://anniesspec...| 62.0|[annie, specialty...|(262144,[353,590,...|\n|    Shopping|Shopping/Recreation|http://arrowheada...| 62.0|[arrowheadaluminu...|(262144,[353,7570...|\n|    Shopping|Shopping/Recreation|http://autumnwing...| 62.0|[autumnwings, fun...|(262144,[697,3067...|\n|    Shopping|Shopping/Recreation|http://backpacker...| 62.0|[backpacker, shop...|(262144,[157,3092...|\n|    Shopping|Shopping/Recreation|http://basementsh...| 62.0|[<, new, image, src]|(262144,[29945,76...|\n|    Shopping|Shopping/Recreation|http://bbobx.home...| 62.0|[belara, beach, o...|(262144,[353,7570...|\n+------------+-------------------+--------------------+-----+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=18","$$hashKey":"object:2754"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=19","$$hashKey":"object:2755"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_-850959535","id":"paragraph_1606312841446_-2144843225","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-18T17:58:47+0000","dateFinished":"2020-12-18T18:00:55+0000","status":"FINISHED","$$hashKey":"object:207"},{"text":"%pyspark\n# Debugging with a smaller DF:\ntdfsmall = trainDF.limit(1000)\ntdfsmall.count()","user":"arjen","dateUpdated":"2020-12-18T12:49:46+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.InterruptedException: sleep interrupted"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608229613640_-342782010","id":"paragraph_1608229613640_-342782010","dateCreated":"2020-12-17T18:26:53+0000","dateStarted":"2020-12-18T11:15:26+0000","dateFinished":"2020-12-18T11:16:33+0000","status":"ERROR","$$hashKey":"object:208"},{"text":"%md\n## Train model","user":"arjen","dateUpdated":"2020-12-18T18:23:40+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Train model</h2>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608315799219_851297473","id":"paragraph_1608315799219_851297473","dateCreated":"2020-12-18T18:23:19+0000","dateStarted":"2020-12-18T18:23:38+0000","dateFinished":"2020-12-18T18:23:38+0000","status":"FINISHED","$$hashKey":"object:209"},{"text":"%pyspark\nlr = LogisticRegression(maxIter=10, regParam=0.001)\ntrainpl = Pipeline(stages=[lr])\n\n#model = trainpl.fit(tdfsmall)\nmodel = trainpl.fit(trainDF)","user":"arjen","dateUpdated":"2020-12-18T17:59:04+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":224.6,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=20","$$hashKey":"object:2900"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=21","$$hashKey":"object:2901"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=22","$$hashKey":"object:2902"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=23","$$hashKey":"object:2903"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=24","$$hashKey":"object:2904"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=25","$$hashKey":"object:2905"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=26","$$hashKey":"object:2906"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=27","$$hashKey":"object:2907"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=28","$$hashKey":"object:2908"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=29","$$hashKey":"object:2909"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=30","$$hashKey":"object:2910"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=31","$$hashKey":"object:2911"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=32","$$hashKey":"object:2912"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=33","$$hashKey":"object:2913"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4040/jobs/job?id=34","$$hashKey":"object:2914"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608226477650_1446683394","id":"paragraph_1608226477650_1446683394","dateCreated":"2020-12-17T17:34:37+0000","dateStarted":"2020-12-18T18:00:49+0000","dateFinished":"2020-12-18T18:16:22+0000","status":"FINISHED","$$hashKey":"object:210"},{"text":"%pyspark\nmodel.write().overwrite().save(\"/tmp/pyspark-logistic-regression-model-arjen-dec-18\")\n","user":"arjen","dateUpdated":"2020-12-18T18:19:23+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608247418648_-983747158","id":"paragraph_1608247418648_-983747158","dateCreated":"2020-12-17T23:23:38+0000","dateStarted":"2020-12-18T18:18:16+0000","dateFinished":"2020-12-18T18:18:34+0000","status":"FINISHED","$$hashKey":"object:211"},{"text":"%pyspark\n# Intermediate fix of RPC message size setting:\nsc.stop()\nconf=conf.set('spark.rpc.message.maxSize','1024')\nsc=SparkContext.getOrCreate(conf=conf)\nspark = SparkSession.builder.getOrCreate()\n\n## Problem: Previously defined results cannot be recomputed due to the new context - we run into this with testDF below.\n##          I resolve by making this cell unrunnable, and running everything above from scratch with the new parameter in the config.","user":"arjen","dateUpdated":"2020-12-18T18:19:28+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608293169491_-107318057","id":"paragraph_1608293169491_-107318057","dateCreated":"2020-12-18T12:06:09+0000","dateStarted":"2020-12-18T18:18:03+0000","dateFinished":"2020-12-18T18:18:12+0000","status":"FINISHED","$$hashKey":"object:212"},{"text":"%md\n## Test model","user":"arjen","dateUpdated":"2020-12-18T18:20:00+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Test model</h2>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608315575887_-901103063","id":"paragraph_1608315575887_-901103063","dateCreated":"2020-12-18T18:19:35+0000","dateStarted":"2020-12-18T18:19:56+0000","dateFinished":"2020-12-18T18:19:57+0000","status":"FINISHED","$$hashKey":"object:213"},{"text":"%md\nEverything above has been run - below, still need to add cells to load data and continue evaluation process.","user":"arjen","dateUpdated":"2020-12-18T18:24:22+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Everything above has been run - below, still need to add cells to load data and continue evaluation process.</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608315828767_656239190","id":"paragraph_1608315828767_656239190","dateCreated":"2020-12-18T18:23:48+0000","dateStarted":"2020-12-18T18:24:18+0000","dateFinished":"2020-12-18T18:24:18+0000","status":"FINISHED","$$hashKey":"object:214"},{"text":"%pyspark\nmodel = PipelineModel.load(\"/tmp/pyspark-logistic-regression-model-arjen-dec-18\")","user":"lisa","dateUpdated":"2020-12-27T16:35:07+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=417","$$hashKey":"object:3246"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=418","$$hashKey":"object:3247"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=419","$$hashKey":"object:3248"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=420","$$hashKey":"object:3249"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=421","$$hashKey":"object:3250"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=422","$$hashKey":"object:3251"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=423","$$hashKey":"object:3252"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=424","$$hashKey":"object:3253"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608632724942_1846811340","id":"paragraph_1608632724942_1846811340","dateCreated":"2020-12-22T10:25:24+0000","dateStarted":"2020-12-27T16:35:07+0000","dateFinished":"2020-12-27T16:35:42+0000","status":"FINISHED","$$hashKey":"object:216"},{"text":"%pyspark\ntrainDF = spark.read.format(\"parquet\").load(\"hdfs:/user/arjen/trainDF\")","user":"lisa","dateUpdated":"2020-12-27T16:35:17+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=425","$$hashKey":"object:3332"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608632825759_753119512","id":"paragraph_1608632825759_753119512","dateCreated":"2020-12-22T10:27:05+0000","dateStarted":"2020-12-27T16:35:17+0000","dateFinished":"2020-12-27T16:35:42+0000","status":"FINISHED","$$hashKey":"object:217"},{"text":"%pyspark\ntestDF = spark.read.format(\"parquet\").load(\"hdfs:/user/arjen/testDF\")","user":"lisa","dateUpdated":"2020-12-27T16:35:19+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=426","$$hashKey":"object:3383"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608328311546_2104250009","id":"paragraph_1608328311546_2104250009","dateCreated":"2020-12-18T21:51:51+0000","dateStarted":"2020-12-27T16:35:42+0000","dateFinished":"2020-12-27T16:35:42+0000","status":"FINISHED","$$hashKey":"object:218"},{"text":"%pyspark\ntestDF.describe","user":"lisa","dateUpdated":"2020-12-27T16:37:07+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<bound method DataFrame.describe of DataFrame[categories: string, url: string, label: double, words: array<string>, features: vector, maincategory: string]>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608328551296_1465084792","id":"paragraph_1608328551296_1465084792","dateCreated":"2020-12-18T21:55:51+0000","dateStarted":"2020-12-27T16:37:07+0000","dateFinished":"2020-12-27T16:37:07+0000","status":"FINISHED","$$hashKey":"object:219"},{"text":"%pyspark\n## SEEMS TO WORK\nspark.sql(\n    \"CREATE TABLE test(categories STRING, url STRING, label DOUBLE, words ARRAY<STRING>, features ARRAY<DOUBLE>, maincategory STRING) \" +\n    \"USING parquet PARTITIONED BY(maincategory) \" +\n    \"LOCATION 'hdfs:/user/arjen/testDF'\"\n)\nspark.sql(\"MSCK REPAIR TABLE test\")","user":"arjen","dateUpdated":"2020-12-18T22:01:27+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608328528492_806759546","id":"paragraph_1608328528492_806759546","dateCreated":"2020-12-18T21:55:28+0000","dateStarted":"2020-12-18T21:59:49+0000","dateFinished":"2020-12-18T21:59:55+0000","status":"FINISHED","$$hashKey":"object:220"},{"text":"%pyspark\n## DOES NOT WORK YET FOR SELECT *\n## The ARRAY<DOUBLE> seems problematic still.\nspark.sql(\"SELECT categories, label FROM test LIMIT 10\").show()","user":"arjen","dateUpdated":"2020-12-18T22:02:19+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+-----+\n|      categories|label|\n+----------------+-----+\n|Society/Holidays|127.0|\n|Society/Holidays|127.0|\n|Society/Holidays|127.0|\n|Society/Holidays|127.0|\n|Society/Holidays|127.0|\n|Society/Holidays|127.0|\n|Society/Holidays|127.0|\n|Society/Holidays|127.0|\n|Society/Holidays|127.0|\n|Society/Holidays|127.0|\n+----------------+-----+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608328802795_-1968477237","id":"paragraph_1608328802795_-1968477237","dateCreated":"2020-12-18T22:00:02+0000","dateStarted":"2020-12-18T22:01:36+0000","dateFinished":"2020-12-18T22:01:45+0000","status":"FINISHED","$$hashKey":"object:221"},{"text":"%pyspark\n# Model properties:\nlrmodel = model.stages[0]\nlrmodel.coefficientMatrix","user":"arjen","dateUpdated":"2020-12-18T21:49:17+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DenseMatrix(278, 262144, [-0.0422, -0.0953, 0.1919, -0.1309, -0.0666, 0.0012, 0.2593, -0.0215, ..., -0.0069, -0.0042, -0.008, -0.0003, -0.0043, -0.0019, -0.002, -0.0057], 1)\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608293370193_-539498886","id":"paragraph_1608293370193_-539498886","dateCreated":"2020-12-18T12:09:30+0000","dateStarted":"2020-12-18T21:49:17+0000","dateFinished":"2020-12-18T21:50:31+0000","status":"FINISHED","$$hashKey":"object:222"},{"text":"%pyspark\neval = lrmodel.evaluate(testDF)","user":"arjen","dateUpdated":"2020-12-18T22:02:26+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608295070065_534093380","id":"paragraph_1608295070065_534093380","dateCreated":"2020-12-18T12:37:50+0000","dateStarted":"2020-12-18T22:02:26+0000","dateFinished":"2020-12-18T22:02:27+0000","status":"FINISHED","$$hashKey":"object:223"},{"text":"%pyspark\neval.precisionByLabel","user":"arjen","dateUpdated":"2020-12-18T22:03:36+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[0.2635284650975659, 0.25715743522875445, 0.3023533424283765, 0.6060348491287718, 0.317495126705653, 0.6940605155024281, 0.5262230057293962, 0.5966542750929368, 0.48223764801959984, 0.37155963302752293, 0.29820158929318274, 0.3175867956744451, 0.40242261103633914, 0.5237492083597214, 0.4309133489461358, 0.3599791013584117, 0.4867075664621677, 0.36178107606679033, 0.2623985572587917, 0.17337164750957854, 0.3414905450500556, 0.7055503292568204, 0.4203069657615112, 0.18127962085308058, 0.23107971745711403, 0.5372005044136192, 0.4057971014492754, 0.4644644644644645, 0.6536585365853659, 0.5704918032786885, 0.5067218200620476, 0.4329411764705882, 0.4649910233393178, 0.2025565388397247, 0.15633571036752605, 0.23597122302158274, 0.5671641791044776, 0.6523668639053254, 0.4656084656084656, 0.4515366430260047, 0.3937007874015748, 0.3740648379052369, 0.665, 0.39285714285714285, 0.5433333333333333, 0.4556213017751479, 0.4931506849315068, 0.3179190751445087, 0.17905405405405406, 0.28422876949740034, 0.3868312757201646, 0.24183006535947713, 0.5532646048109966, 0.4965034965034965, 0.35714285714285715, 0.4054794520547945, 0.3115942028985507, 0.7527839643652561, 0.1761904761904762, 0.6449704142011834, 0.5023474178403756, 0.3446153846153846, 0.36496350364963503, 0.5238095238095238, 0.5443037974683544, 0.3484848484848485, 0.5029940119760479, 0.7666666666666667, 0.5892857142857143, 0.5503597122302158, 0.42613636363636365, 0.4025157232704403, 0.12790697674418605, 0.7676767676767676, 0.6767676767676768, 0.5547703180212014, 0.3605150214592275, 0.5, 0.6111111111111112, 0.2608695652173913, 0.6477272727272727, 0.08571428571428572, 0.631578947368421, 0.5364238410596026, 0.3711340206185567, 0.5535714285714286, 0.5126050420168067, 0.6683168316831684, 0.3617021276595745, 0.5416666666666666, 0.06521739130434782, 0.5434782608695652, 0.5488721804511278, 0.5121951219512195, 0.5116279069767442, 0.2978723404255319, 0.33482142857142855, 0.43478260869565216, 0.73125, 0.3275862068965517, 0.5921052631578947, 0.5128205128205128, 0.7701149425287356, 0.3728813559322034, 0.3870967741935484, 0.6666666666666666, 0.4897959183673469, 0.46511627906976744, 0.0, 0.36363636363636365, 0.3125, 0.627906976744186, 0.46226415094339623, 0.48484848484848486, 0.7553191489361702, 0.6440677966101694, 0.7303370786516854, 0.28205128205128205, 0.25, 0.5568181818181818, 0.11764705882352941, 0.375, 0.5285714285714286, 0.7241379310344828, 0.32231404958677684, 0.125, 0.4444444444444444, 0.5490196078431373, 0.6341463414634146, 0.34328358208955223, 0.7158469945355191, 0.4117647058823529, 0.47058823529411764, 0.5384615384615384, 0.6888888888888889, 0.5588235294117647, 0.6875, 0.3783783783783784, 0.08333333333333333, 0.3888888888888889, 0.6538461538461539, 0.125, 0.08333333333333333, 0.6428571428571429, 0.4375, 0.6363636363636364, 0.6666666666666666, 0.42857142857142855, 0.3333333333333333, 0.6785714285714286, 0.8153846153846154, 0.23076923076923078, 0.1111111111111111, 0.10153846153846154, 0.5263157894736842, 0.43333333333333335, 0.4166666666666667, 0.16666666666666666, 0.375, 0.5, 0.20588235294117646, 0.23529411764705882, 0.7058823529411765, 0.2857142857142857, 0.7666666666666667, 0.18181818181818182, 0.45454545454545453, 0.5862068965517241, 0.6739130434782609, 0.5333333333333333, 0.0, 0.25, 0.3076923076923077, 0.6666666666666666, 0.5294117647058824, 0.6666666666666666, 0.7222222222222222, 0.7692307692307693, 0.2, 0.3333333333333333, 0.5, 0.5384615384615384, 0.5384615384615384, 0.5555555555555556, 0.7272727272727273, 0.0, 0.0, 0.3076923076923077, 0.7692307692307693, 0.3333333333333333, 0.25, 0.4444444444444444, 0.0, 0.0, 0.4444444444444444, 0.6666666666666666, 0.5, 0.4375, 0.5, 0.6, 0.0, 0.23529411764705882, 0.0, 0.625, 0.5555555555555556, 0.0, 0.1111111111111111, 0.0, 0.5714285714285714, 0.6842105263157895, 0.3, 0.6363636363636364, 0.5, 0.7647058823529411, 0.6666666666666666, 0.75, 0.0, 0.7142857142857143, 0.5, 0.0, 0.8333333333333334, 0.7, 0.9090909090909091, 0.0, 1.0, 0.5, 0.6, 0.0, 0.0, 0.25, 0.25, 1.0, 0.2857142857142857, 0.3333333333333333, 0.14285714285714285, 0.0, 0.5, 0.0, 0.0, 1.0, 0.2, 0.0, 1.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.5, 0.0, 1.0, 0.0, 0.3333333333333333, 1.0, 0.0, 0.75, 0.0, 0.3333333333333333, 0.6666666666666666, 0.5, 0.125, 1.0, 0.0, 0.5, 0.0, 0.875, 0.0, 0.0, 0.5, 0.0, 0.3333333333333333, 0.0, 0.0, 0.0, 0.5]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608328183769_-461809075","id":"paragraph_1608328183769_-461809075","dateCreated":"2020-12-18T21:49:43+0000","dateStarted":"2020-12-18T22:03:36+0000","dateFinished":"2020-12-18T22:04:32+0000","status":"FINISHED","$$hashKey":"object:224"},{"text":"%pyspark\nfrom pyspark.sql.functions import udf,col\npredicted = eval.predictions\npredicted.select(\"categories\",\"label\",\"prediction\").withColumn(\"correct\",col(\"label\")==col(\"prediction\")).show(100,False)","user":"arjen","dateUpdated":"2020-12-18T22:13:31+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------------------+-----+----------+-------+\n|categories                       |label|prediction|correct|\n+---------------------------------+-----+----------+-------+\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |1.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |1.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |40.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |18.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |7.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |28.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |23.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |23.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |6.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |38.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |155.0     |false  |\n|Society/Religion_and_Spirituality|0.0  |21.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |6.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |1.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |1.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |1.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |1.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |31.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |24.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |25.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |1.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |3.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |3.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |3.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |3.0       |false  |\n|Society/Religion_and_Spirituality|0.0  |17.0      |false  |\n|Society/Religion_and_Spirituality|0.0  |0.0       |true   |\n|Society/Religion_and_Spirituality|0.0  |1.0       |false  |\n+---------------------------------+-----+----------+-------+\nonly showing top 100 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608329055936_930704767","id":"paragraph_1608329055936_930704767","dateCreated":"2020-12-18T22:04:15+0000","dateStarted":"2020-12-18T22:13:31+0000","dateFinished":"2020-12-18T22:13:42+0000","status":"FINISHED","$$hashKey":"object:225"},{"text":"%pyspark\npredicted.show(20)","user":"arjen","dateUpdated":"2020-12-18T22:08:29+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+-----+--------------------+--------------------+------------+--------------------+--------------------+----------+\n|          categories|                 url|label|               words|            features|maincategory|       rawPrediction|         probability|prediction|\n+--------------------+--------------------+-----+--------------------+--------------------+------------+--------------------+--------------------+----------+\n|Society/Religion_...|http://105245.agc...|  0.0|[function, g, r, ...|(262144,[353,925,...|     Society|[10.3403367638920...|[0.98168080417635...|       0.0|\n|Society/Religion_...|http://10enfield....|  0.0|[10th, enfield, b...|(262144,[16269,21...|     Society|[3.68542266317857...|[0.06313842803841...|       0.0|\n|Society/Religion_...|http://1abirmingh...|  0.0|[1sta, birmingham...|(262144,[170,766,...|     Society|[2.16326394779068...|[0.01477884017087...|       1.0|\n|Society/Religion_...|http://1ballyclar...|  0.0|[1st, ballyclare,...|(262144,[2325,236...|     Society|[-2.1920537342145...|[5.86665785277171...|       1.0|\n|Society/Religion_...|http://1stgchurch...|  0.0|[window, gcfg, {,...|(262144,[7278,358...|     Society|[3.48046627339747...|[0.05277287777757...|       0.0|\n|Society/Religion_...|http://242communi...|  0.0|[lansing, 242, co...|(262144,[619,1915...|     Society|[5.39102396750976...|[0.20134150973823...|       0.0|\n|Society/Religion_...| http://249cofc.org/|  0.0|[249, church, chr...|(262144,[3748,116...|     Society|[11.0136189409825...|[0.99057480221640...|       0.0|\n|Society/Religion_...| http://24jewish.tv/|  0.0|[jewish, world, 2...|(262144,[36543,59...|     Society|[3.85998271526104...|[0.07383499350182...|       0.0|\n|Society/Religion_...|http://3abn.org/n...|  0.0|[3abn, radio, thr...|(262144,[1667,285...|     Society|[5.36031035802720...|[0.16532891888831...|      40.0|\n|Society/Religion_...|http://411titheso...|  0.0|[tithing, homepag...|(262144,[14,19,14...|     Society|[29.4160133606776...|[0.99999999982353...|       0.0|\n|Society/Religion_...|http://67.199.41....|  0.0|[huguenot, histor...|(262144,[1818,219...|     Society|[29.1577827220041...|[0.99999999608609...|       0.0|\n|Society/Religion_...|    http://6dfs.com/|  0.0|[six, day, sunday...|(262144,[3778,538...|     Society|[5.39134100095244...|[0.28472593245883...|       0.0|\n|Society/Religion_...|http://aabaptist....|  0.0|[document, docume...|(262144,[925,2325...|     Society|[14.8556687968407...|[0.99777934671117...|       0.0|\n|Society/Religion_...|http://aaronwilbu...|  0.0|[home, aaron, wil...|(262144,[7278,822...|     Society|[2.85649834388683...|[0.03098221898216...|      18.0|\n|Society/Religion_...|http://aberdeenem...|  0.0|[aberdeen, emc, v...|(262144,[7278,130...|     Society|[3.34715576785029...|[0.04805331000868...|       0.0|\n|Society/Religion_...|http://abidinginc...|  0.0|[abiding, christ,...|(262144,[535,2325...|     Society|[66.5280455661251...|[1.0,1.6422945600...|       0.0|\n|Society/Religion_...|http://abtei-st-s...|  0.0|[st, severin, abb...|(262144,[13714,44...|     Society|[4.17665759858332...|[0.09869158563820...|       0.0|\n|Society/Religion_...|http://abundantli...|  0.0|[abundant, life, ...|(262144,[619,925,...|     Society|[17.7137038153923...|[0.99997736907329...|       0.0|\n|Society/Religion_...|http://acacia.pai...|  0.0|[acacia, vignette...|(262144,[5136,201...|     Society|[2.71715601206294...|[0.02193621104579...|       7.0|\n|Society/Religion_...|http://academic.b...|  0.0|[puritanism, puri...|(262144,[619,916,...|     Society|[60.4822981906799...|[1.0,8.9046256126...|       0.0|\n+--------------------+--------------------+-----+--------------------+--------------------+------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608329296790_492014896","id":"paragraph_1608329296790_492014896","dateCreated":"2020-12-18T22:08:16+0000","dateStarted":"2020-12-18T22:08:29+0000","dateFinished":"2020-12-18T22:08:35+0000","status":"FINISHED","$$hashKey":"object:226"},{"text":"%md\n## Evaluation method Lisa","user":"lisa","dateUpdated":"2021-01-15T12:12:20+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Evaluation method Lisa</h2>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608329104363_1063559090","id":"paragraph_1608329104363_1063559090","dateCreated":"2020-12-18T22:05:04+0000","dateStarted":"2021-01-15T12:12:17+0000","dateFinished":"2021-01-15T12:12:17+0000","status":"FINISHED","$$hashKey":"object:227"},{"text":"%pyspark \nfrom pyspark.ml import Pipeline, PipelineModel\nfrom pyspark.ml.classification import LogisticRegression\nfrom pyspark.ml.feature import HashingTF, Tokenizer, StringIndexer, IndexToString\n\n# Configure an ML pipeline\nindexer = StringIndexer(inputCol=\"categories\", outputCol=\"label\", handleInvalid=\"keep\")\nindexerpl = Pipeline(stages=[indexer])","user":"lisa","dateUpdated":"2020-12-27T16:37:20+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608632953286_1527877701","id":"paragraph_1608632953286_1527877701","dateCreated":"2020-12-22T10:29:13+0000","dateStarted":"2020-12-27T16:37:20+0000","dateFinished":"2020-12-27T16:37:20+0000","status":"FINISHED","$$hashKey":"object:228"},{"text":"%pyspark\n# Prepare for feature transformation of the dataset\nindexmodel = indexerpl.fit(df3)\n\n# Apply feature model to the dataset\ninm = indexmodel.transform(df3)\ninm.show()","user":"lisa","dateUpdated":"2020-12-27T16:37:24+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+------------+-------------------+--------------------+--------------------+--------------------+-----+\n|          subgroups|maincategory|         categories|               title|                 url|     cleaned_content|label|\n+-------------------+------------+-------------------+--------------------+--------------------+--------------------+-----+\n|Shopping/Recreation|    Shopping|Shopping/Recreation|      Shivadas Glass|http://shivadas.com/|shivadas glass or...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation| Fireball Modelworks|http://www.fireba...|fireball modelwor...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|  ISG Fishing Tackle|http://www.isgfis...|isg mean fishing ...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|       Moon Property|http://www.lunarr...|lunar registry bu...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Vacuum Formers fo...|http://www.warmpl...|vacuum forming ta...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|              Relics|http://www.relics...|relic replica wea...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|               Mepps|http://www.mepps....|fishing lure buy ...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation| Puddle Jumper Lures|http://puddlejump...|puddle jumper lur...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|      REC Components| http://www.rec.com/|rec component sin...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|   Marijana Seedshop|https://www.marij...|buy marijuana can...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|   JT's Sharks Teeth|http://www.jtssha...|jtssharksteeth bu...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|           RC Tackle|http://www.rctack...|rc tackle < cdata...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Big Head Crappie ...|http://www.bighea...|crappie jig bette...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|        Utopia Tools|http://www.utopia...|ns4 write < scr i...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|  ScaleModelSoldiers|http://www.scalem...|scalemodelsoldier...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|       Curly's Lures|http://curlyslure...|bass fishing lure...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|     Canyon Plastics|http://www.canyon...|canyon plastic ba...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|       Living Rubber|http://www.living...|living rubber co ...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Booysen Handmade ...|http://www.cbkniv...|mweb business ach...| 62.0|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|   The Amber Company|http://www.amberc...|< function redire...| 62.0|\n+-------------------+------------+-------------------+--------------------+--------------------+--------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=427","$$hashKey":"object:3884"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=428","$$hashKey":"object:3885"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=429","$$hashKey":"object:3886"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=430","$$hashKey":"object:3887"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608633033221_1919027615","id":"paragraph_1608633033221_1919027615","dateCreated":"2020-12-22T10:30:33+0000","dateStarted":"2020-12-27T16:37:24+0000","dateFinished":"2020-12-27T16:37:46+0000","status":"FINISHED","$$hashKey":"object:229"},{"text":"%pyspark\nfrom pyspark.ml.feature import StringIndexerModel\n\n# Annoying put important value to convert the labels back to its corresponding category\nlabels= (indexmodel.stages[0]).labels\nprint(labels)","user":"lisa","dateUpdated":"2020-12-27T16:37:40+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Society/Religion_and_Spirituality', 'Arts/Music', 'Reference/Education', 'Arts/Movies', 'Computers/Software', 'Science/Biology', 'Games/Video_Games', 'Arts/Literature', 'Society/Law', 'Arts/Performing_Arts', 'Computers/Internet', 'Business/Construction_and_Maintenance', 'Science/Social_Sciences', 'Computers/Programming', 'Recreation/Pets', 'Business/Industrial_Goods_and_Services', 'Recreation/Outdoors', 'Business/Arts_and_Entertainment', 'Business/Business_Services', 'Business/Consumer_Goods_and_Services', 'Arts/Visual_Arts', 'Sports/Soccer', 'Society/Issues', 'Society/People', 'Business/Textiles_and_Nonwovens', 'Recreation/Food', 'Health/Conditions_and_Diseases', 'Society/History', 'Home/Cooking', 'Society/Organizations', 'Science/Math', 'Health/Medicine', 'Business/Financial_Services', 'Science/Technology', 'Arts/Television', 'Shopping/Home_and_Garden', 'Arts/Animation', 'Sports/Golf', 'Arts/People', 'Business/Transportation_and_Logistics', 'Recreation/Travel', 'Business/Electronics_and_Electrical', 'Sports/Equestrian', 'Shopping/Crafts', 'Recreation/Autos', 'Shopping/Food', 'Business/Agriculture_and_Forestry', 'Reference/Museums', 'Business/Food_and_Related_Products', 'Sports/Football', 'Arts/Crafts', 'Shopping/Sports', 'Science/Earth_Sciences', 'Sports/Basketball', 'Science/Environment', 'Society/Ethnicity', 'Shopping/Health', 'Society/Genealogy', 'Business/Marketing_and_Advertising', 'Health/Animal', 'Computers/Hardware', 'Shopping/Clothing', 'Shopping/Recreation', 'Recreation/Collecting', 'Society/Philosophy', 'Business/Publishing_and_Printing', 'Sports/Motorsports', 'Sports/Martial_Arts', 'Sports/Water_Sports', 'Health/Alternative', 'Home/Gardening', 'Shopping/Vehicles', 'Business/Healthcare', 'Recreation/Scouting', 'Arts/Art_History', 'News/Newspapers', 'Health/Mental_Health', 'Business/Telecommunications', 'Sports/Baseball', 'Business/Chemicals', 'Recreation/Aviation', 'Shopping/Visual_Arts', 'Science/Astronomy', 'Business/Investing', 'Business/Energy', 'Science/Physics', 'Shopping/Antiques_and_Collectibles', 'Science/Chemistry', 'Arts/Photography', 'Home/Family', 'Arts/Online_Writing', 'Recreation/Humor', 'Sports/Cycling', 'Arts/Comics', 'Shopping/Publications', 'Arts/Writers_Resources', 'Sports/Hockey', 'Arts/Architecture', 'Recreation/Radio', 'Society/Philanthropy', 'Computers/Systems', 'Business/Automotive', 'Sports/Running', 'Science/Agriculture', 'Shopping/Consumer_Electronics', 'Recreation/Boating', 'Society/Relationships', 'Society/Gay,_Lesbian,_and_Bisexual', 'Shopping/Entertainment', 'Business/Hospitality', 'Health/Public_Health_and_Safety', 'Computers/Data_Formats', 'Society/Politics', 'Computers/Multimedia', 'Society/Death', 'Business/Accounting', 'Sports/Winter_Sports', 'Reference/Libraries', 'Arts/Radio', 'Shopping/Jewelry', 'Business/Management', 'Arts/Illustration', 'Games/Board_Games', 'Health/Addictions', 'Games/Roleplaying', 'Shopping/Music', 'Shopping/Pets', 'Society/Holidays', 'Recreation/Motorcycles', 'Computers/Security', 'Health/Pharmacy', 'Science/Instruments_and_Supplies', 'Society/Paranormal', 'Computers/Computer_Science', 'Games/Gambling', 'Home/Consumer_Information', 'Recreation/Living_History', 'Society/Military', 'Business/Aerospace_and_Defense', 'Society/Government', 'Business/Environment', 'Business/Materials', 'Shopping/Toys_and_Games', 'Business/Real_Estate', 'Business/Opportunities', 'Arts/Education', 'Computers/Graphics', 'Sports/Tennis', 'Games/Online', 'Recreation/Birding', 'Sports/Cricket', 'Business/Biotechnology_and_Pharmaceuticals', 'News/Journalism', 'Sports/Track_and_Field', 'Health/Reproductive_Health', 'Society/Crime', 'Recreation/Models', 'Reference/Dictionaries', 'Sports/Volleyball', 'Shopping/Gifts', 'Sports/Softball', 'Computers/Artificial_Intelligence', 'Recreation/Roads_and_Highways', 'Recreation/Camps', 'Sports/Skating', 'Business/Retail_Trade', 'Computers/Consultants', 'Recreation/Trains_and_Railroads', 'Shopping/Flowers', 'Recreation/Guns', 'Shopping/Ethnic_and_Regional', 'Society/Subcultures', 'Recreation/Antiques', 'Sports/Wrestling', 'Health/Professions', 'Games/Card_Games', 'Sports/Events', 'Recreation/Climbing', 'Business/Information_Technology', 'Arts/Design', 'Reference/Knowledge_Management', 'Business/Education_and_Training', 'Business/Employment', 'Society/Folklore', 'Shopping/Children', 'Society/Disabled', 'Computers/Data_Communications', 'Health/Nursing', 'Games/Puzzles', 'Computers/Open_Source', 'Arts/Genres', 'Computers/Robotics', 'Business/Small_Business', 'Shopping/General_Merchandise', 'Computers/CAD_and_CAM', 'Games/Miniatures', 'Shopping/Tools', 'Sports/Lacrosse', 'Science/Science_in_Society', 'Recreation/Nudism', 'Business/Human_Resources', 'Shopping/Office_Products', 'Shopping/Niche', 'Sports/Gymnastics', 'Sports/Flying_Discs', 'Society/Activism', 'Home/Personal_Finance', 'Business/International_Business_and_Trade', 'News/Colleges_and_Universities', 'Society/Lifestyle_Choices', 'Computers/Emulators', 'Arts/Bodyart', 'Reference/Flags', 'Sports/Fencing', 'Society/Transgendered', 'Shopping/Holidays', 'Shopping/Photography', 'Sports/Strength_Sports', 'Games/Coin-Op', 'Health/Senior_Health', 'Recreation/Theme_Parks', 'Science/Anomalies_and_Alternative_Science', 'Sports/Bowling', 'Arts/Organizations', 'Sports/Skateboarding', 'Sports/Cheerleading', 'Sports/Paintball', 'Business/E-Commerce', 'News/Media_Industry', 'Business/Mining_and_Drilling', 'Health/Dentistry', 'Health/Nutrition', 'Computers/Education', 'Arts/Graphic_Design', 'Society/Sexuality', 'Computers/Companies', 'Sports/Fantasy', 'Arts/Entertainment', 'Shopping/Classifieds', 'Computers/Mobile_Computing', 'Society/Work', 'Health/Beauty', 'Home/Home_Improvement', 'Computers/Parallel_Computing', 'Computers/Algorithms', 'Computers/Speech_Technology', 'Sports/Resources', 'Health/Occupational_Health_and_Safety', 'News/Analysis_and_Opinion', 'Sports/Multi-Sports', 'Games/Trading_Card_Games', 'Reference/Quotations', 'Science/Reference', 'Health/Child_Health', 'Arts/Classical_Studies', 'Sports/Boxing', 'Reference/Archives', \"Health/Women's_Health\", 'Science/Educational_Resources', 'Sports/Gaelic', 'Computers/Usenet', 'Shopping/Auctions', 'Computers/History', 'Shopping/Tobacco', 'Computers/Virtual_Reality', 'Recreation/Kites', 'Computers/Human-Computer_Interaction', 'Sports/Squash', 'Health/Senses', 'Society/Future', 'Sports/Darts', 'Games/Conventions', 'Computers/Artificial_Life', 'Arts/Digital', 'Shopping/Weddings', 'Business/News_and_Media', 'Sports/Badminton']\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_-1770996418","id":"paragraph_1606301372436_-1545138065","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-27T16:37:40+0000","dateFinished":"2020-12-27T16:37:46+0000","status":"FINISHED","$$hashKey":"object:230"},{"text":"%pyspark\n# Make predictions on test documents.\ntestSet = model.transform(testDF)\ntestSet.show()\n","user":"lisa","dateUpdated":"2020-12-27T16:37:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{"0":{"graph":{"mode":"table","height":534,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+-----+--------------------+--------------------+------------+--------------------+--------------------+----------+\n|          categories|                 url|label|               words|            features|maincategory|       rawPrediction|         probability|prediction|\n+--------------------+--------------------+-----+--------------------+--------------------+------------+--------------------+--------------------+----------+\n|Society/Religion_...|http://105245.agc...|  0.0|[function, g, r, ...|(262144,[353,925,...|     Society|[10.3403367638920...|[0.98168080417635...|       0.0|\n|Society/Religion_...|http://10enfield....|  0.0|[10th, enfield, b...|(262144,[16269,21...|     Society|[3.68542266317857...|[0.06313842803841...|       0.0|\n|Society/Religion_...|http://1abirmingh...|  0.0|[1sta, birmingham...|(262144,[170,766,...|     Society|[2.16326394779068...|[0.01477884017087...|       1.0|\n|Society/Religion_...|http://1ballyclar...|  0.0|[1st, ballyclare,...|(262144,[2325,236...|     Society|[-2.1920537342145...|[5.86665785277171...|       1.0|\n|Society/Religion_...|http://1stgchurch...|  0.0|[window, gcfg, {,...|(262144,[7278,358...|     Society|[3.48046627339747...|[0.05277287777757...|       0.0|\n|Society/Religion_...|http://242communi...|  0.0|[lansing, 242, co...|(262144,[619,1915...|     Society|[5.39102396750976...|[0.20134150973823...|       0.0|\n|Society/Religion_...| http://249cofc.org/|  0.0|[249, church, chr...|(262144,[3748,116...|     Society|[11.0136189409825...|[0.99057480221640...|       0.0|\n|Society/Religion_...| http://24jewish.tv/|  0.0|[jewish, world, 2...|(262144,[36543,59...|     Society|[3.85998271526104...|[0.07383499350182...|       0.0|\n|Society/Religion_...|http://3abn.org/n...|  0.0|[3abn, radio, thr...|(262144,[1667,285...|     Society|[5.36031035802720...|[0.16532891888831...|      40.0|\n|Society/Religion_...|http://411titheso...|  0.0|[tithing, homepag...|(262144,[14,19,14...|     Society|[29.4160133606776...|[0.99999999982353...|       0.0|\n|Society/Religion_...|http://67.199.41....|  0.0|[huguenot, histor...|(262144,[1818,219...|     Society|[29.1577827220041...|[0.99999999608609...|       0.0|\n|Society/Religion_...|    http://6dfs.com/|  0.0|[six, day, sunday...|(262144,[3778,538...|     Society|[5.39134100095244...|[0.28472593245883...|       0.0|\n|Society/Religion_...|http://aabaptist....|  0.0|[document, docume...|(262144,[925,2325...|     Society|[14.8556687968407...|[0.99777934671117...|       0.0|\n|Society/Religion_...|http://aaronwilbu...|  0.0|[home, aaron, wil...|(262144,[7278,822...|     Society|[2.85649834388683...|[0.03098221898216...|      18.0|\n|Society/Religion_...|http://aberdeenem...|  0.0|[aberdeen, emc, v...|(262144,[7278,130...|     Society|[3.34715576785029...|[0.04805331000868...|       0.0|\n|Society/Religion_...|http://abidinginc...|  0.0|[abiding, christ,...|(262144,[535,2325...|     Society|[66.5280455661251...|[1.0,1.6422945600...|       0.0|\n|Society/Religion_...|http://abtei-st-s...|  0.0|[st, severin, abb...|(262144,[13714,44...|     Society|[4.17665759858332...|[0.09869158563820...|       0.0|\n|Society/Religion_...|http://abundantli...|  0.0|[abundant, life, ...|(262144,[619,925,...|     Society|[17.7137038153923...|[0.99997736907329...|       0.0|\n|Society/Religion_...|http://acacia.pai...|  0.0|[acacia, vignette...|(262144,[5136,201...|     Society|[2.71715601206294...|[0.02193621104579...|       7.0|\n|Society/Religion_...|http://academic.b...|  0.0|[puritanism, puri...|(262144,[619,916,...|     Society|[60.4822981906799...|[1.0,8.9046256126...|       0.0|\n+--------------------+--------------------+-----+--------------------+--------------------+------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=431","$$hashKey":"object:3995"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_4226688","id":"paragraph_1608035708276_-1631112905","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-27T16:37:46+0000","dateFinished":"2020-12-27T16:37:53+0000","status":"FINISHED","$$hashKey":"object:231"},{"text":"%pyspark\nconverter = IndexToString(inputCol=\"prediction\", outputCol=\"predicted_category\", labels=labels)\nconverted = converter.transform(testSet)\nconverted.select(\"categories\",\"url\",\"words\",\"predicted_category\").withColumn(\"correct\",col(\"categories\")==col(\"predicted_category\")).show()","user":"lisa","dateUpdated":"2020-12-27T16:38:01+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+-------+\n|          categories|                 url|               words|  predicted_category|correct|\n+--------------------+--------------------+--------------------+--------------------+-------+\n|Society/Religion_...|http://105245.agc...|[function, g, r, ...|Society/Religion_...|   true|\n|Society/Religion_...|http://10enfield....|[10th, enfield, b...|Society/Religion_...|   true|\n|Society/Religion_...|http://1abirmingh...|[1sta, birmingham...|          Arts/Music|  false|\n|Society/Religion_...|http://1ballyclar...|[1st, ballyclare,...|          Arts/Music|  false|\n|Society/Religion_...|http://1stgchurch...|[window, gcfg, {,...|Society/Religion_...|   true|\n|Society/Religion_...|http://242communi...|[lansing, 242, co...|Society/Religion_...|   true|\n|Society/Religion_...| http://249cofc.org/|[249, church, chr...|Society/Religion_...|   true|\n|Society/Religion_...| http://24jewish.tv/|[jewish, world, 2...|Society/Religion_...|   true|\n|Society/Religion_...|http://3abn.org/n...|[3abn, radio, thr...|   Recreation/Travel|  false|\n|Society/Religion_...|http://411titheso...|[tithing, homepag...|Society/Religion_...|   true|\n|Society/Religion_...|http://67.199.41....|[huguenot, histor...|Society/Religion_...|   true|\n|Society/Religion_...|    http://6dfs.com/|[six, day, sunday...|Society/Religion_...|   true|\n|Society/Religion_...|http://aabaptist....|[document, docume...|Society/Religion_...|   true|\n|Society/Religion_...|http://aaronwilbu...|[home, aaron, wil...|Business/Business...|  false|\n|Society/Religion_...|http://aberdeenem...|[aberdeen, emc, v...|Society/Religion_...|   true|\n|Society/Religion_...|http://abidinginc...|[abiding, christ,...|Society/Religion_...|   true|\n|Society/Religion_...|http://abtei-st-s...|[st, severin, abb...|Society/Religion_...|   true|\n|Society/Religion_...|http://abundantli...|[abundant, life, ...|Society/Religion_...|   true|\n|Society/Religion_...|http://acacia.pai...|[acacia, vignette...|     Arts/Literature|  false|\n|Society/Religion_...|http://academic.b...|[puritanism, puri...|Society/Religion_...|   true|\n+--------------------+--------------------+--------------------+--------------------+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=432","$$hashKey":"object:4046"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608633399118_-1091248711","id":"paragraph_1608633399118_-1091248711","dateCreated":"2020-12-22T10:36:39+0000","dateStarted":"2020-12-27T16:38:01+0000","dateFinished":"2020-12-27T16:38:06+0000","status":"FINISHED","$$hashKey":"object:232"},{"text":"%pyspark\nconverted.sample(False, 0.0003).select(\"categories\",\"url\",\"words\",\"predicted_category\").withColumn(\"correct\",col(\"categories\")==col(\"predicted_category\")).show()","user":"lisa","dateUpdated":"2020-12-27T16:43:13+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{"0":{"graph":{"mode":"table","height":474,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+-------+\n|          categories|                 url|               words|  predicted_category|correct|\n+--------------------+--------------------+--------------------+--------------------+-------+\n|Society/Religion_...|http://stluke-san...|[redirect, phone,...|Society/Religion_...|   true|\n|Society/Religion_...|http://www.angelf...|[<, hide, old, br...|     Arts/Television|  false|\n|Society/Religion_...|http://www.christ...|[christ, episcopa...|Society/Religion_...|   true|\n|Society/Religion_...|http://www.thepro...|[promise, church,...|Society/Religion_...|   true|\n|          Arts/Music|http://www.angelf...|[spanstyle, {, co...|          Arts/Music|   true|\n|          Arts/Music|http://www.online...|[www, music, data...|          Arts/Music|   true|\n|     Science/Biology|http://delta-intk...|[angiosperm, fami...|     Science/Biology|   true|\n|      Society/People|http://oldjokes.t...|[oldjokes, funny,...|     Arts/Literature|  false|\n|Science/Social_Sc...|http://www.savemy...|[save, language, ...|Science/Social_Sc...|   true|\n|  Computers/Graphics|http://www.foamtr...|[foam, train, fon...| Reference/Education|  false|\n|  Computers/Software|http://www.recove...|[recover4all, dat...|  Computers/Software|   true|\n|  Computers/Internet|http://www.design...|[web, designer, d...|Business/Construc...|  false|\n|         Society/Law|http://www.wysebr...|[wysebridge, pate...|Society/Religion_...|  false|\n|     Recreation/Pets|http://www.sporti...|[american, pit, b...|Society/Religion_...|  false|\n|  Computers/Hardware|http://www.syylex...|[home, syylex, <,...|Business/Textiles...|  false|\n| Science/Environment|http://www.iisd.c...|[vpd, eco, effici...| Science/Environment|   true|\n|  Science/Technology|http://www.nuclea...|[virtual, nuclear...|Society/Religion_...|  false|\n|Business/Food_and...|http://www.tysonf...|[window, jquery, ...| Reference/Education|  false|\n|   Sports/Basketball|http://www.pmc.ed...|[basketball, pine...|Society/Religion_...|  false|\n|   Reference/Museums|http://robert-owe...|[welcome, robert,...|     Society/History|  false|\n+--------------------+--------------------+--------------------+--------------------+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=452","$$hashKey":"object:4097"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=453","$$hashKey":"object:4098"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=454","$$hashKey":"object:4099"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_-2001433711","id":"paragraph_1608116808031_-1398199692","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-27T16:43:13+0000","dateFinished":"2020-12-27T16:43:31+0000","status":"FINISHED","$$hashKey":"object:233"},{"text":"%pyspark\nfrom pyspark.mllib.evaluation import MulticlassMetrics\nfrom pyspark.sql.functions import col\n\npredictionAndLabels = testSet.select(col(\"prediction\"),col(\"label\")).rdd\nmetrics = MulticlassMetrics(predictionAndLabels)","user":"lisa","dateUpdated":"2020-12-27T16:38:16+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_828870911","id":"paragraph_1606316071641_1150212398","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-27T16:38:16+0000","dateFinished":"2020-12-27T16:38:17+0000","status":"FINISHED","$$hashKey":"object:234"},{"text":"%pyspark\n# Overall statistics\nprecision = metrics.precision()\nrecall = metrics.recall()\nf1Score = metrics.fMeasure()\nprint(\"Summary Stats\")\nprint(\"Precision = %s\" % precision)\nprint(\"Recall = %s\" % recall)\nprint(\"F1 Score = %s\" % f1Score)\n\n# Statistics by class\n#classes = d.select(\"label\").rdd.flatMap(lambda x:x).distinct().collect()\n#for label in sorted(classes):\n#    print(\"Class %s precision = %s\" % (dict.get(label), metrics.precision(label)))\n#    print(\"Class %s recall = %s\" % (dict.get(label), metrics.recall(label)))\n#    print(\"Class %s F1 Measure = %s\" % (dict.get(label), metrics.fMeasure(label, beta=1.0)))\n    \n# Weighted statsclas\nprint(\"Weighted recall = %s\" % metrics.weightedRecall)\nprint(\"Weighted precision = %s\" % metrics.weightedPrecision)\nprint(\"Weighted F(1) Score = %s\" % metrics.weightedFMeasure())\nprint(\"Weighted F(0.5) Score = %s\" % metrics.weightedFMeasure(beta=0.5))\nprint(\"Weighted false positive rate = %s\" % metrics.weightedFalsePositiveRate)","user":"lisa","dateUpdated":"2020-12-27T16:32:01+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Summary Stats\nPrecision = 0.3568410764113316\nRecall = 0.3568410764113316\nF1 Score = 0.3568410764113316\nWeighted recall = 0.3568410764113311\nWeighted precision = 0.4121776210438439\nWeighted F(1) Score = 0.3321592748253675\nWeighted F(0.5) Score = 0.3571927514531399\nWeighted false positive rate = 0.029953772759416304\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=236","$$hashKey":"object:4203"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=237","$$hashKey":"object:4204"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=238","$$hashKey":"object:4205"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608133327322_2004274139","id":"paragraph_1608035767193_2039404463","dateCreated":"2020-12-16T15:42:07+0000","dateStarted":"2020-12-22T19:35:33+0000","dateFinished":"2020-12-22T19:36:35+0000","status":"FINISHED","$$hashKey":"object:235"},{"text":"%pyspark\n# Statistics by class\nclasses = d.select(\"label\").rdd.flatMap(lambda x:x).distinct().collect()\nclasses = sorted(classes)\nfor i in range(0,10):\n    label = classes[i]\n    print(label)\n    print(\"Class %s precision = %s\" % (dict.get(label), metrics.precision(label)))\n    print(\"Class %s recall = %s\" % (dict.get(label), metrics.recall(label)))\n    print(\"Class %s F1 Measure = %s\" % (dict.get(label), metrics.fMeasure(label, beta=1.0)))","user":"lisa","dateUpdated":"2020-12-27T16:52:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.0\nClass Society/Religion_and_Spirituality precision = 0.2635284650975659\nClass Society/Religion_and_Spirituality recall = 0.8113608210936117\nClass Society/Religion_and_Spirituality F1 Measure = 0.39783943252565135\n1.0\nClass Arts/Music precision = 0.25715743522875445\nClass Arts/Music recall = 0.6868564506359782\nClass Arts/Music F1 Measure = 0.37421111248607847\n2.0\nClass Reference/Education precision = 0.3023533424283765\nClass Reference/Education recall = 0.4595645412130638\nClass Reference/Education F1 Measure = 0.3647397654803538\n3.0\nClass Arts/Movies precision = 0.6060348491287718\nClass Arts/Movies recall = 0.47375415282392025\nClass Arts/Movies F1 Measure = 0.5317919075144508\n4.0\nClass Computers/Software precision = 0.317495126705653\nClass Computers/Software recall = 0.4508650519031142\nClass Computers/Software F1 Measure = 0.372605090077209\n5.0\nClass Science/Biology precision = 0.6940605155024281\nClass Science/Biology recall = 0.6673850574712644\nClass Science/Biology F1 Measure = 0.6804614539461638\n6.0\nClass Games/Video_Games precision = 0.5262230057293962\nClass Games/Video_Games recall = 0.5096030729833547\nClass Games/Video_Games F1 Measure = 0.5177797051170859\n7.0\nClass Arts/Literature precision = 0.5966542750929368\nClass Arts/Literature recall = 0.4085702163767501\nClass Arts/Literature F1 Measure = 0.4850163686728784\n8.0\nClass Society/Law precision = 0.48223764801959984\nClass Society/Law recall = 0.5518691588785046\nClass Society/Law F1 Measure = 0.5147090869470473\n9.0\nClass Arts/Performing_Arts precision = 0.37155963302752293\nClass Arts/Performing_Arts recall = 0.23557925351429956\nClass Arts/Performing_Arts F1 Measure = 0.2883417383565708\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=469","$$hashKey":"object:4264"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=470","$$hashKey":"object:4265"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609086718184_1145685491","id":"paragraph_1609086718184_1145685491","dateCreated":"2020-12-27T16:31:58+0000","dateStarted":"2020-12-27T16:52:53+0000","dateFinished":"2020-12-27T16:53:01+0000","status":"FINISHED","$$hashKey":"object:236"},{"text":"%pyspark\n# Statistics by class\nclasses = d.select(\"label\").rdd.flatMap(lambda x:x).distinct().collect()\nclasses = sorted(classes)\nfor i in range(267,277):\n    label = classes[i]\n    print(label)\n    print(\"Class %s precision = %s\" % (dict.get(label), metrics.precision(label)))\n    print(\"Class %s recall = %s\" % (dict.get(label), metrics.recall(label)))\n    print(\"Class %s F1 Measure = %s\" % (dict.get(label), metrics.fMeasure(label, beta=1.0)))","user":"lisa","dateUpdated":"2020-12-27T16:56:54+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"267.0\nClass Sports/Squash precision = 0.875\nClass Sports/Squash recall = 0.2413793103448276\nClass Sports/Squash F1 Measure = 0.3783783783783784\n268.0\nClass Health/Senses precision = 0.0\nClass Health/Senses recall = 0.0\nClass Health/Senses F1 Measure = 0.0\n269.0\nClass Society/Future precision = 0.0\nClass Society/Future recall = 0.0\nClass Society/Future F1 Measure = 0.0\n270.0\nClass Sports/Darts precision = 0.5\nClass Sports/Darts recall = 0.06666666666666667\nClass Sports/Darts F1 Measure = 0.11764705882352941\n271.0\nClass Games/Conventions precision = 0.0\nClass Games/Conventions recall = 0.0\nClass Games/Conventions F1 Measure = 0.0\n272.0\nClass Computers/Artificial_Life precision = 0.3333333333333333\nClass Computers/Artificial_Life recall = 0.047619047619047616\nClass Computers/Artificial_Life F1 Measure = 0.08333333333333333\n273.0\nClass Arts/Digital precision = 0.0\nClass Arts/Digital recall = 0.0\nClass Arts/Digital F1 Measure = 0.0\n274.0\nClass Shopping/Weddings precision = 0.0\nClass Shopping/Weddings recall = 0.0\nClass Shopping/Weddings F1 Measure = 0.0\n275.0\nClass Business/News_and_Media precision = 0.0\nClass Business/News_and_Media recall = 0.0\nClass Business/News_and_Media F1 Measure = 0.0\n276.0\nClass Sports/Badminton precision = 0.5\nClass Sports/Badminton recall = 0.09523809523809523\nClass Sports/Badminton F1 Measure = 0.16\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=475","$$hashKey":"object:4320"},{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=476","$$hashKey":"object:4321"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609088095726_-264535361","id":"paragraph_1609088095726_-264535361","dateCreated":"2020-12-27T16:54:55+0000","dateStarted":"2020-12-27T16:56:54+0000","dateFinished":"2020-12-27T16:56:57+0000","status":"FINISHED","$$hashKey":"object:237"},{"text":"%pyspark\nfor i in range(134,144):\n    label = classes[i]\n    print(label)\n    print(\"Class %s precision = %s\" % (dict.get(label), metrics.precision(label)))\n    print(\"Class %s recall = %s\" % (dict.get(label), metrics.recall(label)))\n    print(\"Class %s F1 Measure = %s\" % (dict.get(label), metrics.fMeasure(label, beta=1.0)))","user":"lisa","dateUpdated":"2020-12-27T16:57:49+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"134.0\nClass Games/Gambling precision = 0.6888888888888889\nClass Games/Gambling recall = 0.32978723404255317\nClass Games/Gambling F1 Measure = 0.4460431654676259\n135.0\nClass Home/Consumer_Information precision = 0.5588235294117647\nClass Home/Consumer_Information recall = 0.09547738693467336\nClass Home/Consumer_Information F1 Measure = 0.1630901287553648\n136.0\nClass Recreation/Living_History precision = 0.6875\nClass Recreation/Living_History recall = 0.26666666666666666\nClass Recreation/Living_History F1 Measure = 0.38427947598253276\n137.0\nClass Society/Military precision = 0.3783783783783784\nClass Society/Military recall = 0.07407407407407407\nClass Society/Military F1 Measure = 0.12389380530973451\n138.0\nClass Business/Aerospace_and_Defense precision = 0.08333333333333333\nClass Business/Aerospace_and_Defense recall = 0.005681818181818182\nClass Business/Aerospace_and_Defense F1 Measure = 0.010638297872340427\n139.0\nClass Society/Government precision = 0.3888888888888889\nClass Society/Government recall = 0.07692307692307693\nClass Society/Government F1 Measure = 0.12844036697247707\n140.0\nClass Business/Environment precision = 0.6538461538461539\nClass Business/Environment recall = 0.09770114942528736\nClass Business/Environment F1 Measure = 0.17\n141.0\nClass Business/Materials precision = 0.125\nClass Business/Materials recall = 0.011695906432748537\nClass Business/Materials F1 Measure = 0.0213903743315508\n142.0\nClass Shopping/Toys_and_Games precision = 0.08333333333333333\nClass Shopping/Toys_and_Games recall = 0.006756756756756757\nClass Shopping/Toys_and_Games F1 Measure = 0.0125\n143.0\nClass Business/Real_Estate precision = 0.6428571428571429\nClass Business/Real_Estate recall = 0.1267605633802817\nClass Business/Real_Estate F1 Measure = 0.21176470588235297\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609088243104_230806569","id":"paragraph_1609088243104_230806569","dateCreated":"2020-12-27T16:57:23+0000","dateStarted":"2020-12-27T16:57:49+0000","dateFinished":"2020-12-27T16:57:49+0000","status":"FINISHED","$$hashKey":"object:238"},{"text":"%pyspark\nprint(metrics.accuracy)","user":"lisa","dateUpdated":"2020-12-27T16:42:36+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.3568410764113316\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608635271918_1971802915","id":"paragraph_1608635271918_1971802915","dateCreated":"2020-12-22T11:07:51+0000","dateStarted":"2020-12-27T16:42:36+0000","dateFinished":"2020-12-27T16:42:43+0000","status":"FINISHED","$$hashKey":"object:239"},{"text":"%pyspark\nconfusionMatrix = metrics.confusionMatrix()\nprint(confusionMatrix)","user":"lisa","dateUpdated":"2020-12-27T16:39:59+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DenseMatrix([[9.170e+03, 6.260e+02, 1.770e+02, ..., 0.000e+00, 0.000e+00,\n              1.000e+00],\n             [1.178e+03, 4.536e+03, 7.100e+01, ..., 0.000e+00, 0.000e+00,\n              0.000e+00],\n             [9.890e+02, 2.250e+02, 1.773e+03, ..., 0.000e+00, 0.000e+00,\n              0.000e+00],\n             ...,\n             [7.000e+00, 3.000e+00, 0.000e+00, ..., 0.000e+00, 0.000e+00,\n              0.000e+00],\n             [1.000e+01, 1.000e+00, 0.000e+00, ..., 0.000e+00, 0.000e+00,\n              0.000e+00],\n             [5.000e+00, 4.000e+00, 0.000e+00, ..., 0.000e+00, 0.000e+00,\n              2.000e+00]])\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://ip-10-192-10-185.ec2.internal:4041/jobs/job?id=436","$$hashKey":"object:4466"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1608632526676_-1589004777","id":"paragraph_1608632526676_-1589004777","dateCreated":"2020-12-22T10:22:06+0000","dateStarted":"2020-12-27T16:39:59+0000","dateFinished":"2020-12-27T16:40:20+0000","status":"FINISHED","$$hashKey":"object:240"}],"name":"Lisa_Thesis3_classifier(II)","id":"2FU59QDF6","defaultInterpreterGroup":"spark","version":"0.9.0-SNAPSHOT","permissions":{"owners":["lisa"]},"noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/Lisa_Thesis3_classifier(II)"}