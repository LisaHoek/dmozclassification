import seaborn
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
  
def plot_confusion_matrix(data, labels, title, output_filename):
    """Plot confusion matrix using heatmap.
 
    Args:
        data (list of list): List of lists with confusion matrix data.
        labels (list): Labels which will be plotted across x and y axis.
        output_filename (str): Path to output file.
 
    """
    seaborn.set(color_codes=True)
    plt.figure(1, figsize=(30, 10))
 
    plt.title(title)
 
    seaborn.set(font_scale=1.4)
    ax = seaborn.heatmap(data, annot=True, cmap="YlGnBu", cbar_kws={'label': 'Scale'}, fmt='g')
 
    ax.set_xticklabels(labels, rotation = 270)
    ax.set_yticklabels(labels, rotation = 0)
 
    ax.set(ylabel="True Label", xlabel="Predicted Label")
 
    plt.savefig(output_filename, bbox_inches='tight', dpi=300)
    plt.close()
 
# define data
matrix = [[8.540e+03, 4.570e+02, 2.120e+02, 4.460e+02, 2.610e+02, 2.430e+02,
              3.650e+02, 7.700e+01, 9.600e+01, 1.010e+02, 6.600e+01, 8.700e+01,
              2.330e+02, 4.000e+00, 3.700e+01, 1.600e+01, 1.200e+01, 3.000e+00,
              1.800e+01, 7.000e+00, 4.000e+00, 1.500e+01, 5.000e+00, 0.000e+00,
              1.900e+01, 1.800e+01, 2.000e+00, 1.500e+01, 2.000e+00, 2.900e+01],
             [9.230e+02, 5.456e+03, 3.860e+02, 6.890e+02, 4.060e+02, 4.220e+02,
              5.000e+02, 8.800e+01, 2.070e+02, 5.800e+01, 8.500e+01, 6.700e+01,
              3.750e+02, 1.900e+01, 3.200e+01, 4.500e+01, 1.200e+01, 5.000e+00,
              1.700e+01, 9.000e+00, 9.000e+00, 2.300e+01, 5.000e+00, 2.000e+00,
              9.000e+00, 2.200e+01, 9.000e+00, 2.200e+01, 5.000e+00, 1.900e+01],
             [5.710e+02, 4.830e+02, 5.798e+03, 1.155e+03, 4.860e+02, 2.050e+02,
              3.600e+02, 6.500e+01, 1.030e+02, 1.060e+02, 4.700e+01, 2.900e+01,
              1.530e+02, 1.300e+01, 3.300e+01, 1.500e+01, 1.200e+01, 4.000e+00,
              1.800e+01, 1.100e+01, 5.000e+00, 1.300e+01, 8.000e+00, 3.000e+00,
              9.000e+00, 1.400e+01, 1.700e+01, 1.000e+00, 1.000e+00, 1.900e+01],
             [8.890e+02, 6.990e+02, 7.280e+02, 4.785e+03, 5.770e+02, 2.970e+02,
              8.160e+02, 4.100e+01, 6.800e+01, 1.210e+02, 1.580e+02, 3.900e+01,
              8.300e+01, 1.500e+01, 3.400e+01, 5.300e+01, 5.800e+01, 9.000e+00,
              5.000e+01, 9.400e+01, 7.000e+00, 3.800e+01, 2.300e+01, 2.000e+00,
              1.300e+01, 8.000e+00, 3.700e+01, 4.000e+00, 4.000e+00, 3.800e+01],
             [6.500e+02, 6.440e+02, 6.910e+02, 8.910e+02, 5.435e+03, 1.480e+02,
              2.600e+02, 2.300e+01, 6.500e+01, 2.670e+02, 9.900e+01, 1.060e+02,
              1.060e+02, 1.400e+01, 2.700e+01, 2.000e+01, 2.000e+01, 2.000e+00,
              1.300e+01, 2.800e+01, 5.000e+00, 1.400e+01, 4.000e+00, 4.000e+00,
              2.400e+01, 1.900e+01, 1.700e+01, 2.800e+01, 1.000e+00, 2.800e+01],
             [8.870e+02, 9.320e+02, 2.270e+02, 6.450e+02, 1.670e+02, 5.311e+03,
              3.100e+02, 6.600e+01, 8.800e+01, 6.300e+01, 4.500e+01, 4.100e+01,
              3.220e+02, 1.500e+01, 1.500e+01, 1.300e+01, 8.000e+00, 3.000e+00,
              1.100e+01, 1.100e+01, 4.000e+00, 1.800e+01, 6.000e+00, 4.000e+00,
              7.000e+00, 1.900e+01, 7.000e+00, 2.000e+00, 5.000e+00, 2.200e+02],
             [8.640e+02, 8.230e+02, 3.410e+02, 7.790e+02, 2.500e+02, 2.520e+02,
              4.204e+03, 1.330e+02, 1.480e+02, 4.400e+01, 1.120e+02, 4.500e+01,
              1.630e+02, 1.400e+01, 3.100e+01, 6.300e+01, 6.000e+00, 1.300e+01,
              1.500e+01, 2.100e+01, 1.100e+01, 1.500e+01, 2.300e+01, 1.400e+01,
              6.000e+00, 3.000e+00, 2.000e+01, 7.000e+00, 2.000e+00, 4.000e+01],
             [7.910e+02, 7.020e+02, 2.880e+02, 3.450e+02, 1.780e+02, 2.120e+02,
              3.280e+02, 2.863e+03, 9.600e+01, 3.900e+01, 2.300e+01, 2.700e+01,
              5.960e+02, 4.900e+01, 1.900e+01, 1.000e+01, 5.000e+00, 1.700e+01,
              1.100e+01, 2.000e+00, 6.000e+00, 7.000e+00, 4.000e+00, 1.000e+00,
              3.000e+00, 1.200e+01, 4.000e+00, 3.000e+00, 1.000e+00, 1.800e+01],
             [6.580e+02, 7.400e+02, 3.460e+02, 3.660e+02, 2.950e+02, 2.290e+02,
              3.510e+02, 1.690e+02, 1.677e+03, 1.160e+02, 3.400e+01, 6.600e+01,
              6.770e+02, 4.610e+02, 6.800e+01, 3.700e+01, 8.000e+00, 2.000e+01,
              1.600e+01, 3.000e+00, 2.100e+01, 4.000e+00, 0.000e+00, 1.100e+01,
              9.000e+00, 2.400e+01, 9.000e+00, 2.100e+01, 2.000e+00, 6.500e+01],
             [6.530e+02, 4.700e+02, 3.360e+02, 6.080e+02, 5.930e+02, 2.590e+02,
              2.690e+02, 3.100e+01, 6.100e+01, 1.704e+03, 8.500e+01, 5.600e+01,
              4.900e+01, 1.100e+01, 2.300e+01, 1.100e+01, 2.200e+01, 4.000e+00,
              1.100e+01, 1.000e+01, 2.000e+00, 1.900e+01, 2.000e+00, 2.000e+00,
              6.000e+00, 9.000e+00, 1.000e+01, 1.400e+01, 1.600e+01, 6.900e+01],
             [5.530e+02, 4.710e+02, 1.650e+02, 6.370e+02, 2.810e+02, 1.800e+02,
              2.190e+02, 2.800e+01, 5.300e+01, 1.180e+02, 2.051e+03, 4.700e+01,
              8.600e+01, 6.000e+00, 1.300e+01, 1.800e+01, 2.300e+01, 2.000e+00,
              5.000e+00, 3.000e+00, 5.000e+00, 1.100e+01, 4.000e+00, 1.000e+00,
              1.400e+01, 8.000e+00, 3.000e+00, 4.000e+00, 2.000e+00, 1.800e+01],
             [6.620e+02, 5.060e+02, 2.280e+02, 3.840e+02, 3.380e+02, 1.650e+02,
              1.800e+02, 6.600e+01, 1.200e+02, 9.400e+01, 1.020e+02, 1.255e+03,
              1.650e+02, 1.200e+01, 6.500e+01, 2.200e+01, 2.100e+01, 3.000e+00,
              8.000e+00, 0.000e+00, 1.100e+01, 9.000e+00, 1.000e+00, 0.000e+00,
              5.700e+01, 1.000e+01, 4.000e+00, 5.900e+01, 2.000e+00, 1.400e+01],
             [2.570e+02, 3.780e+02, 4.040e+02, 1.380e+02, 1.160e+02, 1.380e+02,
              1.400e+02, 3.100e+01, 7.500e+01, 1.500e+01, 1.300e+01, 1.300e+01,
              1.683e+03, 3.200e+01, 1.800e+01, 6.000e+00, 2.000e+00, 0.000e+00,
              4.000e+00, 3.000e+00, 0.000e+00, 0.000e+00, 2.000e+00, 0.000e+00,
              3.000e+00, 1.000e+01, 3.000e+00, 5.000e+00, 0.000e+00, 6.000e+00],
             [1.450e+02, 1.360e+02, 5.300e+01, 8.500e+01, 5.400e+01, 4.300e+01,
              7.200e+01, 4.800e+01, 1.060e+02, 1.800e+01, 4.000e+00, 2.000e+01,
              1.020e+02, 1.926e+03, 1.800e+01, 2.000e+00, 3.000e+00, 8.000e+00,
              2.000e+00, 0.000e+00, 0.000e+00, 3.000e+00, 1.000e+00, 1.000e+00,
              2.000e+00, 7.000e+00, 0.000e+00, 5.000e+00, 0.000e+00, 8.700e+01],
             [2.980e+02, 1.880e+02, 8.900e+01, 8.100e+01, 1.210e+02, 4.500e+01,
              7.400e+01, 3.000e+01, 1.560e+02, 2.300e+01, 8.000e+00, 5.000e+01,
              9.200e+01, 5.200e+01, 8.540e+02, 2.000e+00, 1.000e+00, 1.000e+00,
              1.000e+00, 0.000e+00, 0.000e+00, 5.000e+00, 1.000e+00, 0.000e+00,
              2.000e+00, 1.000e+01, 1.000e+00, 1.900e+01, 0.000e+00, 1.200e+01],
             [2.240e+02, 3.210e+02, 1.290e+02, 2.030e+02, 1.570e+02, 8.900e+01,
              1.280e+02, 1.300e+01, 6.500e+01, 2.300e+01, 4.100e+01, 1.800e+01,
              9.500e+01, 1.000e+01, 7.000e+00, 6.920e+02, 1.300e+01, 0.000e+00,
              1.000e+01, 0.000e+00, 1.000e+00, 3.000e+00, 0.000e+00, 0.000e+00,
              8.000e+00, 9.000e+00, 1.000e+00, 0.000e+00, 1.000e+00, 8.000e+00],
             [2.290e+02, 1.190e+02, 9.300e+01, 4.020e+02, 1.000e+02, 5.300e+01,
              7.900e+01, 8.000e+00, 1.500e+01, 5.600e+01, 2.200e+01, 2.300e+01,
              1.500e+01, 3.000e+00, 7.000e+00, 5.000e+00, 9.190e+02, 2.000e+00,
              2.000e+00, 5.000e+00, 2.000e+00, 7.000e+00, 3.000e+00, 0.000e+00,
              5.000e+00, 7.000e+00, 1.000e+00, 6.000e+00, 0.000e+00, 9.000e+00],
             [2.950e+02, 2.390e+02, 7.200e+01, 1.650e+02, 6.600e+01, 9.100e+01,
              8.400e+01, 9.100e+01, 1.630e+02, 3.600e+01, 1.300e+01, 1.600e+01,
              1.090e+02, 2.360e+02, 3.900e+01, 2.000e+00, 6.000e+00, 2.010e+02,
              2.000e+00, 1.000e+00, 7.000e+00, 5.000e+00, 4.000e+00, 3.000e+00,
              3.000e+00, 1.000e+00, 2.000e+00, 2.000e+00, 0.000e+00, 1.400e+01],
             [2.280e+02, 1.300e+02, 1.190e+02, 6.240e+02, 1.050e+02, 5.900e+01,
              2.330e+02, 8.000e+00, 2.500e+01, 2.200e+01, 1.700e+01, 7.000e+00,
              1.700e+01, 3.000e+00, 2.000e+00, 4.000e+00, 1.200e+01, 3.000e+00,
              2.180e+02, 3.600e+01, 6.000e+00, 8.000e+00, 1.000e+01, 2.000e+00,
              0.000e+00, 1.000e+00, 7.000e+00, 0.000e+00, 2.000e+00, 4.000e+00],
             [1.450e+02, 9.000e+01, 8.300e+01, 7.550e+02, 1.120e+02, 3.900e+01,
              1.480e+02, 3.000e+00, 6.000e+00, 1.600e+01, 9.000e+00, 7.000e+00,
              9.000e+00, 1.000e+00, 1.000e+00, 4.000e+00, 4.000e+00, 3.000e+00,
              1.400e+01, 3.030e+02, 1.000e+00, 8.000e+00, 2.000e+00, 1.000e+00,
              0.000e+00, 0.000e+00, 1.200e+01, 0.000e+00, 0.000e+00, 2.000e+00],
             [2.380e+02, 1.600e+02, 1.280e+02, 2.700e+02, 7.700e+01, 4.400e+01,
              1.850e+02, 1.370e+02, 5.900e+01, 1.600e+01, 1.100e+01, 1.200e+01,
              4.500e+01, 8.000e+00, 6.000e+00, 1.000e+00, 5.000e+00, 2.000e+00,
              8.000e+00, 5.000e+00, 1.600e+02, 8.000e+00, 6.000e+00, 1.000e+00,
              1.000e+00, 1.000e+00, 1.000e+00, 0.000e+00, 0.000e+00, 8.000e+00],
             [1.650e+02, 1.130e+02, 1.750e+02, 5.560e+02, 7.400e+01, 5.000e+01,
              1.340e+02, 1.700e+01, 5.100e+01, 2.700e+01, 1.800e+01, 1.700e+01,
              2.800e+01, 4.000e+00, 3.000e+00, 3.000e+00, 2.000e+01, 6.000e+00,
              4.000e+00, 4.000e+00, 4.000e+00, 7.400e+01, 3.000e+00, 0.000e+00,
              1.000e+00, 0.000e+00, 4.000e+00, 0.000e+00, 0.000e+00, 5.000e+00],
             [1.700e+02, 1.700e+02, 8.900e+01, 3.620e+02, 8.000e+01, 6.400e+01,
              4.610e+02, 1.000e+01, 1.500e+01, 1.500e+01, 5.000e+00, 6.000e+00,
              1.800e+01, 3.000e+00, 2.000e+00, 3.000e+00, 0.000e+00, 2.000e+00,
              6.000e+00, 6.000e+00, 3.000e+00, 7.000e+00, 1.600e+01, 2.000e+00,
              0.000e+00, 0.000e+00, 1.900e+01, 2.000e+00, 1.000e+00, 9.000e+00],
             [2.800e+02, 1.890e+02, 1.030e+02, 1.300e+02, 9.900e+01, 4.800e+01,
              2.070e+02, 2.500e+01, 1.640e+02, 2.700e+01, 8.000e+00, 1.900e+01,
              5.500e+01, 1.000e+00, 4.000e+00, 6.000e+00, 2.000e+00, 2.000e+00,
              2.000e+00, 1.000e+00, 5.000e+00, 2.000e+00, 7.000e+00, 7.100e+01,
              0.000e+00, 5.000e+00, 3.000e+00, 1.000e+00, 0.000e+00, 2.000e+00],
             [1.850e+02, 1.420e+02, 9.200e+01, 1.270e+02, 1.890e+02, 5.000e+01,
              4.300e+01, 1.100e+01, 2.800e+01, 3.500e+01, 5.900e+01, 7.200e+01,
              4.300e+01, 8.000e+00, 7.000e+00, 5.000e+00, 1.800e+01, 0.000e+00,
              1.000e+00, 1.000e+00, 1.000e+00, 4.000e+00, 0.000e+00, 0.000e+00,
              2.490e+02, 4.000e+00, 2.000e+00, 1.300e+01, 0.000e+00, 9.000e+00],
             [1.920e+02, 2.160e+02, 1.350e+02, 8.800e+01, 1.250e+02, 5.600e+01,
              3.100e+01, 3.800e+01, 1.000e+02, 3.900e+01, 4.100e+01, 3.800e+01,
              1.880e+02, 4.000e+00, 3.000e+00, 1.400e+01, 9.000e+00, 1.000e+00,
              2.000e+00, 0.000e+00, 2.000e+00, 1.000e+00, 1.000e+00, 1.000e+00,
              1.200e+01, 3.500e+01, 4.000e+00, 4.000e+00, 1.000e+00, 7.000e+00],
             [1.260e+02, 9.600e+01, 6.700e+01, 4.030e+02, 8.800e+01, 4.000e+01,
              1.610e+02, 4.000e+00, 7.000e+00, 1.700e+01, 1.400e+01, 8.000e+00,
              7.000e+00, 2.000e+00, 3.000e+00, 0.000e+00, 1.000e+00, 0.000e+00,
              8.000e+00, 1.700e+01, 6.000e+00, 2.000e+00, 3.000e+00, 0.000e+00,
              2.000e+00, 0.000e+00, 1.600e+02, 3.000e+00, 0.000e+00, 2.000e+00],
             [1.570e+02, 1.350e+02, 4.000e+01, 4.100e+01, 1.150e+02, 1.900e+01,
              2.800e+01, 7.000e+00, 2.600e+01, 2.700e+01, 9.000e+00, 5.700e+01,
              3.500e+01, 1.100e+01, 4.800e+01, 1.000e+00, 3.000e+00, 0.000e+00,
              1.000e+00, 0.000e+00, 0.000e+00, 1.000e+00, 0.000e+00, 0.000e+00,
              1.200e+01, 3.000e+00, 0.000e+00, 3.010e+02, 0.000e+00, 2.000e+00],
             [1.820e+02, 2.290e+02, 4.600e+01, 1.180e+02, 4.700e+01, 5.700e+01,
              5.200e+01, 6.000e+00, 9.000e+00, 3.000e+01, 1.200e+01, 1.900e+01,
              6.600e+01, 2.000e+00, 2.000e+00, 1.000e+00, 2.000e+00, 0.000e+00,
              1.000e+00, 1.000e+00, 0.000e+00, 4.000e+00, 0.000e+00, 0.000e+00,
              3.000e+00, 1.000e+00, 0.000e+00, 6.000e+00, 1.380e+02, 0.000e+00],
             [1.690e+02, 8.300e+01, 5.000e+01, 8.300e+01, 4.000e+01, 7.400e+01,
              4.600e+01, 6.000e+00, 2.800e+01, 2.900e+01, 9.000e+00, 2.000e+01,
              1.000e+01, 2.000e+00, 4.000e+00, 0.000e+00, 4.000e+00, 3.000e+00,
              1.000e+00, 0.000e+00, 1.200e+01, 3.000e+00, 2.000e+00, 2.000e+00,
              1.400e+01, 3.000e+00, 1.000e+00, 1.000e+00, 0.000e+00, 1.620e+02]]

matrixdf = pd.DataFrame(matrix)
normalize = matrixdf.astype('float') / matrixdf.sum(axis=1)[:, np.newaxis]

# define labels
classes =[0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0]

dictLabels = {24.0: 'Society/Issues', 13.0: 'Arts/Movies', 6.0: 'Shopping', 27.0: 'Society/History', 14.0: 'Arts/Literature', 7.0: 'Arts/Music', 25.0: 'Society/People', 17.0: 'Arts/Performing_Arts', 19.0: 'Business/Industrial_Goods_and_Services', 26.0: 'Business/Textiles_and_Nonwovens', 29.0: 'News', 8.0: 'Arts', 18.0: 'Business/Construction_and_Maintenance', 11.0: 'Society', 3.0: 'Business', 20.0: 'Business/Arts_and_Entertainment', 12.0: 'Games', 23.0: 'Arts/Visual_Arts', 5.0: 'Sports', 1.0: 'Recreation', 2.0: 'Computers', 4.0: 'Science', 16.0: 'Society/Law', 10.0: 'Health', 0.0: 'Society/Religion_and_Spirituality', 15.0: 'Home', 21.0: 'Business/Business_Services', 28.0: 'Society/Organizations', 9.0: 'Reference', 22.0: 'Business/Consumer_Goods_and_Services'}

classesName = []
for c in sorted(classes):
	classesName.append(dictLabels.get(c))

print(classesName)
 
# create confusion matrix
plot_confusion_matrix(matrix, classesName, "Confusion Matrix", "confusion_matrix.png")
plot_confusion_matrix(normalize.round(2), classesName, "Normalised Confusion Matrix", "normalized_confusion_matrix.png")
