{"paragraphs":[{"text":"%md\n# Lisa's Notebook\n\nTesting Lisa's notebook for getting the content pre-classifier training.\n\n## Preamble\n\nDefine context, some globals, functions, _etc._","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Lisa's Notebook</h1>\n<p>Testing Lisa's notebook for getting the content pre-classifier training.</p>\n<h2>Preamble</h2>\n<p>Define context, some globals, functions, <em>etc.</em></p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015148_-596087991","id":"paragraph_1607704923555_200527419","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","focus":true,"$$hashKey":"object:62"},{"text":"%pyspark\nimport pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark import SparkConf\n\nconf = SparkConf().setAll(\n  [\n    (\"spark.pyspark.virtualenv.enabled\", \"true\"),\n    (\"spark.pyspark.virtualenv.bin.path\", \"/bin/virtualenv\"),\n    (\"spark.pyspark.python\", \"python3\"),\n    (\"spark.driver.memory\", \"24g\")\n  ]\n)\n\nspark = SparkSession.builder.appName('Arjen: Get and Clean Content').config(conf=conf).getOrCreate()\n#sparkContext=spark.sparkContext\nsc = spark.sparkContext","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015148_1779241088","id":"paragraph_1606310211953_1653499498","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:63"},{"text":"%pyspark\nfrom pyspark.sql.functions import udf, struct, col\nfrom pyspark.sql.types import * \nimport pyspark.sql.functions as func","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015148_-468446434","id":"paragraph_1607704322961_244915882","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:64"},{"text":"%pyspark\nprint(\"Define contractions...\")\n# A list of contractions from http://stackoverflow.com/questions/19790188/expanding-english-language-contractions-in-python\ncontractions = { \n\"ain't\": \"am not\",\n\"aren't\": \"are not\",\n\"can't\": \"cannot\",\n\"can't've\": \"cannot have\",\n\"'cause\": \"because\",\n\"could've\": \"could have\",\n\"couldn't\": \"could not\",\n\"couldn't've\": \"could not have\",\n\"didn't\": \"did not\",\n\"doesn't\": \"does not\",\n\"don't\": \"do not\",\n\"hadn't\": \"had not\",\n\"hadn't've\": \"had not have\",\n\"hasn't\": \"has not\",\n\"haven't\": \"have not\",\n\"he'd\": \"he would\",\n\"he'd've\": \"he would have\",\n\"he'll\": \"he will\",\n\"he's\": \"he is\",\n\"how'd\": \"how did\",\n\"how'll\": \"how will\",\n\"how's\": \"how is\",\n\"i'd\": \"i would\",\n\"i'll\": \"i will\",\n\"i'm\": \"i am\",\n\"i've\": \"i have\",\n\"isn't\": \"is not\",\n\"it'd\": \"it would\",\n\"it'll\": \"it will\",\n\"it's\": \"it is\",\n\"let's\": \"let us\",\n\"ma'am\": \"madam\",\n\"mayn't\": \"may not\",\n\"might've\": \"might have\",\n\"mightn't\": \"might not\",\n\"must've\": \"must have\",\n\"mustn't\": \"must not\",\n\"needn't\": \"need not\",\n\"oughtn't\": \"ought not\",\n\"shan't\": \"shall not\",\n\"sha'n't\": \"shall not\",\n\"she'd\": \"she would\",\n\"she'll\": \"she will\",\n\"she's\": \"she is\",\n\"should've\": \"should have\",\n\"shouldn't\": \"should not\",\n\"that'd\": \"that would\",\n\"that's\": \"that is\",\n\"there'd\": \"there had\",\n\"there's\": \"there is\",\n\"they'd\": \"they would\",\n\"they'll\": \"they will\",\n\"they're\": \"they are\",\n\"they've\": \"they have\",\n\"wasn't\": \"was not\",\n\"we'd\": \"we would\",\n\"we'll\": \"we will\",\n\"we're\": \"we are\",\n\"we've\": \"we have\",\n\"weren't\": \"were not\",\n\"what'll\": \"what will\",\n\"what're\": \"what are\",\n\"what's\": \"what is\",\n\"what've\": \"what have\",\n\"where'd\": \"where did\",\n\"where's\": \"where is\",\n\"who'll\": \"who will\",\n\"who's\": \"who is\",\n\"won't\": \"will not\",\n\"wouldn't\": \"would not\",\n\"you'd\": \"you would\",\n\"you'll\": \"you will\",\n\"you're\": \"you are\"\n}","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Define contractions...\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015148_162287212","id":"paragraph_1606309733021_1935236299","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:65"},{"text":"%pyspark\ndef get_content(filename, offset, length):\n    import zlib, requests\n    from bs4 import BeautifulSoup\n\n    url = \"https://commoncrawl.s3.amazonaws.com/\"+filename\n    r = requests.get(url, headers={'Range': 'bytes={}-{}'.format(offset, offset+length-1)})\n    # Here we need to do a try-except block\n    try:\n        data = zlib.decompress(r.content, wbits = zlib.MAX_WBITS | 16)\n        html = data.decode('utf-8',errors='ignore')\n        soup = BeautifulSoup(html, 'lxml')\n        content = soup.get_text()\n    except zlib.error:\n        content = 'Decompression error; invalid/incomplete request response?'\n    try:\n        warc, header, response = content.strip().split('\\r\\n\\r\\n', 2)\n        return response\n    except:\n    \treturn \"\"\n    \nget_content_udf = udf(get_content, StringType())","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015148_-500838784","id":"paragraph_1606309716568_-1543539853","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:66"},{"text":"%md\n## Single file testcase","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Single file testcase</h2>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015148_-425197556","id":"paragraph_1607704875582_1011664355","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:67"},{"text":"%pyspark\nprint((get_content(\"crawl-data/CC-MAIN-2017-04/segments/1484560282631.80/warc/CC-MAIN-20170116095122-00166-ip-10-171-10-70.ec2.internal.warc.gz\", 166535832, 1573)))","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"     Robert Louis Stevenson Holdings Robert Louis StevensonNotable Editions inThomas Cooper LibraryThis page provides information on editions of works by Robert LouisStevenson that may be of particular interest to scholars. It is by no meansan exhaustive list of all Thomas Cooper Library's Stevenson holdings, noris it a complete list of Stevenson editions held in the Rare Books Room.Such lists are available through USCAN. The texts have been separated into seven groups of works, withinwhich they are listed chronologically by first publication in book form.The seven groups are: NovelsShort StoriesPoetryEssaysTravelsLettersMiscellaneous Return to ScottishLiterary HoldingsReturnto Rare Booksand Special Collections This page last updated 27 May 2003 by the Department of Rare Books and Special Collections.\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015148_1697407932","id":"paragraph_1606309809147_1371081032","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:68"},{"text":"%md \n## Start with whole dataset\n","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Start with whole dataset</h2>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015148_1181598776","id":"paragraph_1607697861900_1030883912","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:69"},{"text":"%pyspark\nval file = \"hdfs:/user/lisa/join.csv\"\nval df = spark.read.option(\"header\",True).option(\"inferSchema\",True).csv(file)\ndf.printSchema()\ndf.show()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- maincategory: string (nullable = true)\n |-- categories: string (nullable = true)\n |-- title: string (nullable = true)\n |-- url: string (nullable = true)\n |-- warc_filename: string (nullable = true)\n |-- warc_record_offset: integer (nullable = true)\n |-- warc_record_length: integer (nullable = true)\n\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|maincategory|          categories|               title|                 url|       warc_filename|warc_record_offset|warc_record_length|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|     Society|Top/Society/Disab...|First Network Online|http://1stnetwork...|crawl-data/CC-MAI...|           1327699|             10746|\n|        Arts|Top/Arts/Radio/Re...|           KKRW 93.7|http://937thebeat...|crawl-data/CC-MAI...|           3911174|             31613|\n|  Recreation|Top/Recreation/An...|The Art and Antiq...|   http://aadla.com/|crawl-data/CC-MAI...|           4636760|             12673|\n|    Business|Top/Business/Ener...|            ABCSolar|http://abcsolar.com/|crawl-data/CC-MAI...|           7069798|              4439|\n|    Business|Top/Business/Busi...|Abglobal Translat...|http://abglobal.net/|crawl-data/CC-MAI...|           7586735|              2231|\n|   Computers|Top/Computers/Sof...|       Check&amp;Get|http://activeurls...|crawl-data/CC-MAI...|           5204892|               663|\n|       Games|Top/Games/Video_G...|                Gull|http://adamcadre....|crawl-data/CC-MAI...|           8391954|              3056|\n|   Reference|Top/Reference/Edu...|     UMass Extension|http://ag.umass.edu/|crawl-data/CC-MAI...|          10213637|             19251|\n|     Science|Top/Science/Math/...|Australasian Jour...|http://ajc.maths....|crawl-data/CC-MAI...|           8307017|              3985|\n|      Sports|Top/Sports/Badmin...|Auckland Badminto...|http://aklbadmint...|crawl-data/CC-MAI...|           9720824|              5813|\n|    Shopping|Top/Shopping/Vehi...|Alario Brothers M...|http://alariobros...|crawl-data/CC-MAI...|          11399955|              9605|\n|     Society|Top/Society/Relig...|Alaska's Northern...|http://alaska.bup...|crawl-data/CC-MAI...|           9525931|              2517|\n|        Arts|Top/Arts/Televisi...|        ALF Fanspace|http://alf.fanspa...|crawl-data/CC-MAI...|           9208655|              7073|\n|        Arts|Top/Arts/Visual_A...|All About Austral...|http://allaboutab...|crawl-data/CC-MAI...|          14692682|             17043|\n|        Arts|Top/Arts/Movies/T...|AllReaders.com Re...|http://allreaders...|crawl-data/CC-MAI...|          11360110|             25999|\n|        Arts|Top/Arts/Movies/T...|Allreaders.com: S...|http://allreaders...|crawl-data/CC-MAI...|          15956835|             24382|\n|        Arts|Top/Arts/Movies/T...|AllReaders.com Re...|http://allreaders...|crawl-data/CC-MAI...|          14924550|             24555|\n|        Home|Top/Home/Cooking/...|    French Beef Stew|http://allrecipes...|crawl-data/CC-MAI...|          12563596|             42244|\n|     Society|Top/Society/Paran...|It's The End Of T...|http://alma-geddo...|crawl-data/CC-MAI...|          16353923|              8253|\n|     Science|Top/Science/Math/...|Applications of M...|http://am.math.ca...|crawl-data/CC-MAI...|          15396467|              3395|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015148_-2079896738","id":"paragraph_1607697829445_-1000451224","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:70"},{"text":"%md\n## Fetch content and write result to filesystem\nWe now write out the data to Parquet files, partitioned by maincategory (this helps later queries by enabling pruning by maincategory) and bucketed by category (because of the higher number of distinct categories).","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Fetch content and write result to filesystem</h2>\n<p>We now write out the data to Parquet files, partitioned by maincategory (this helps later queries by enabling pruning by maincategory) and bucketed by category (because of the higher number of distinct categories).</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-1651201873","id":"paragraph_1607777544876_823799313","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:71"},{"text":"%pyspark\ndfContent = df.withColumn('content', get_content_udf('warc_filename', 'warc_record_offset', 'warc_record_length')).drop('warc_filename','warc_record_offset','warc_record_length')\ndfContent.write.format(\"parquet\").option(\"compression\",\"none\").partitionBy(\"maincategory\").bucketBy(12,\"categories\").option(\"path\",\"hdfs:/user/arjen/content\").saveAsTable('CatContent')","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-1020776446","id":"paragraph_1607697863841_103432864","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:72"},{"text":"%md\nNot crucial, but `df` and `dfContent` can now be cleaned up to free memory. Let's proactively help Spark to free resources for other jobs.","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Not crucial, but <code>df</code> and <code>dfContent</code> can now be cleaned up to free memory. Let's proactively help Spark to free resources for other jobs.</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-864010365","id":"paragraph_1607796302831_-2068405274","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:73"},{"text":"%pyspark\ndf.unpersist()\ndfContent.unpersist()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[maincategory: string, categories: string, title: string, url: string, warc_filename: string, warc_record_offset: int, warc_record_length: int]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_1512717513","id":"paragraph_1607777778452_1341394332","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:74"},{"text":"%md\n## Clean data and write result to the filesystem\n\nThe `content` field in `CatContent` is the HTML code, not suited for the text classification task that we have in mind.\nUDF `clean_text` uses NLTK and a series of regular expressions to produce better input for the next phase of the project.","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Clean data and write result to the filesystem</h2>\n<p>The <code>content</code> field in <code>CatContent</code> is the HTML code, not suited for the text classification task that we have in mind.\n<br  />UDF <code>clean_text</code> uses NLTK and a series of regular expressions to produce better input for the next phase of the project.</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-304148066","id":"paragraph_1607777774931_-1480635851","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:75"},{"text":"%pyspark\ndef clean_text(text, remove_stopwords = True):   \n    import re\n    import nltk\n    from nltk.corpus import stopwords\n    from nltk.stem import WordNetLemmatizer\n    nltk.data.path.append('./nltk_data')\n    \n    # Convert words to lower case\n    text = text.lower()\n    # Remove whitespaces\n    text = text.strip()\n    \n    # Replace contractions with their longer forms \n    if True:\n        text = text.split()\n        new_text = []\n        for word in text:\n            if word in contractions:\n                new_text.append(contractions[word])\n            else:\n                new_text.append(word)\n        text = \" \".join(new_text)\n    # Format words and remove unwanted characters\n    text = re.sub(r'https?:\\/\\/.*[\\r\\n]*', '', text, flags=re.MULTILINE)\n    text = re.sub(r'\\<a href', ' ', text)\n    text = re.sub(r'&amp;', '', text) \n    text = re.sub(r'[_\"\\-;%()|+&=*%.,!?:#$@\\[\\]/]', ' ', text)\n    text = re.sub(r'<br />', ' ', text)\n    text = re.sub(r'\\'', ' ', text)\n    text = re.sub(r'[^\\x00-\\x7F]+',' ', text)\n    # Remove stop words and non-English words\n    if remove_stopwords:\n        text = text.split()\n        words = set(nltk.corpus.words.words())\n        stops = set(stopwords.words(\"english\"))\n        text = [w for w in text if not w in stops]\n        #text = [w for w in text if w in words]\n        #text = [w for w in text if w in words and not w in stops]\n        text = \" \".join(text)\n    # Tokenize each word\n    word_list =  nltk.WordPunctTokenizer().tokenize(text)\n\n    # Lemmatize each word and put back in one string\n    lemm = nltk.stem.WordNetLemmatizer()\n    lemmatized_output = ' '.join([lemm.lemmatize(w) for w in word_list])\n    \n    # Return cleaned text\n    return lemmatized_output\n    \nclean_text_udf = udf(clean_text, StringType())","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_685828202","id":"paragraph_1606309516897_-1834143438","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:76"},{"text":"%pyspark\ndfContent = spark.table('CatContent')\ndfContentCleaned = dfContent.withColumn('cleaned_content', clean_text_udf('content')).drop('content')\ndfContentCleaned.write.format(\"parquet\").option(\"compression\",\"none\").partitionBy(\"maincategory\").bucketBy(12,\"categories\").option(\"path\",\"hdfs:/user/arjen/clean-content\").saveAsTable('CatCleanContent')\ndfContentCleaned.unpersist()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-638581083","id":"paragraph_1607697864597_1599205368","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:77"},{"text":"%pyspark\ndfContentCleaned.show()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+------------+--------------------+\n|          categories|               title|                 url|maincategory|     cleaned_content|\n+--------------------+--------------------+--------------------+------------+--------------------+\n|Top/Computers/Sof...|    A Real Validator|http://arealvalid...|   Computers|real validator tr...|\n|Top/Computers/Sys...|AROS: Amiga Resea...|http://aros.sourc...|   Computers|aros research ope...|\n|Top/Computers/Sof...|            Homebrew|     http://brew.sh/|   Computers|homebrew missing ...|\n|Top/Computers/Pro...|            SQLiteDB|http://code.jense...|   Computers|sqlitedb sqlite p...|\n|Top/Computers/Pro...|SQL Injection - C...|http://shiflett.o...|   Computers|sql injection chr...|\n|Top/Computers/Sof...|      Alien Software|http://www.aliens...|   Computers|health network he...|\n|Top/Computers/Sof...|United Systems Te...|http://www.asyst3...|   Computers|home ddrjquery wi...|\n|Top/Computers/Rob...|Chicago Area Robo...|http://www.chibot...|   Computers|chibots < >< cdat...|\n|Top/Computers/Sof...|CreativeMac: Core...|http://www.creati...|   Computers|corel painter ix ...|\n|Top/Computers/Mul...|      SoundConverter|http://www.dekort...|   Computers|                    |\n|Top/Computers/Sof...|    Desktop Icon Toy|http://www.idesks...|   Computers|desktop icon toy ...|\n|Top/Computers/Sof...|     Internet-Drafts|http://www.ietf.o...|   Computers|internet draft d ...|\n|Top/Computers/Sof...|Raise the Red Fla...|http://www.linuxj...|   Computers|window nreum nreu...|\n|Top/Computers/Pro...|     LK Bin Database|http://www.lksoft...|   Computers|function w c { w ...|\n|Top/Computers/Int...|    Response-O-Matic|http://www.respon...|   Computers|create online con...|\n|Top/Computers/Sof...|    SoftwareArchives|http://www.softwa...|   Computers|softwarearchives ...|\n|Top/Computers/Int...|          TweetsWind|http://www.tweets...|   Computers|tweetswind displa...|\n|Top/Computers/Pro...|Jini Security : A...|http://citeseerx....|   Computers|citeseerx securit...|\n|Top/Computers/Pro...|             WebMail|http://jwebmail.s...|   Computers|             webmail|\n|Top/Computers/Sof...|               VVCap|   http://vvcap.com/|   Computers|vvcap screenshots...|\n+--------------------+--------------------+--------------------+------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-409802972","id":"paragraph_1607697984625_-509767769","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:78"},{"text":"%md\n## A concise analysis of the dataset","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>A concise analysis of the dataset</h2>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_693823481","id":"paragraph_1607714586758_-767185216","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:79"},{"text":"%pyspark\n# Help the optimizer\nspark.sql(\"ANALYZE TABLE CatCleanContent COMPUTE STATISTICS\")","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-1246343840","id":"paragraph_1607714567342_-2045865807","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:80"},{"text":"%pyspark\n# Load the table\nccc = spark.table(\"CatCleanContent\")","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-177198131","id":"paragraph_1607815750446_1816958994","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:81"},{"text":"%pyspark\nccc.show(10)","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+------------+\n|          categories|               title|                 url|     cleaned_content|maincategory|\n+--------------------+--------------------+--------------------+--------------------+------------+\n|Top/Computers/Sof...|    A Real Validator|http://arealvalid...|real validator tr...|   Computers|\n|Top/Computers/Sys...|AROS: Amiga Resea...|http://aros.sourc...|aros research ope...|   Computers|\n|Top/Computers/Sof...|            Homebrew|     http://brew.sh/|homebrew missing ...|   Computers|\n|Top/Computers/Pro...|            SQLiteDB|http://code.jense...|sqlitedb sqlite p...|   Computers|\n|Top/Computers/Pro...|SQL Injection - C...|http://shiflett.o...|sql injection chr...|   Computers|\n|Top/Computers/Sof...|      Alien Software|http://www.aliens...|health network he...|   Computers|\n|Top/Computers/Sof...|United Systems Te...|http://www.asyst3...|home ddrjquery wi...|   Computers|\n|Top/Computers/Rob...|Chicago Area Robo...|http://www.chibot...|chibots < >< cdat...|   Computers|\n|Top/Computers/Sof...|CreativeMac: Core...|http://www.creati...|corel painter ix ...|   Computers|\n|Top/Computers/Mul...|      SoundConverter|http://www.dekort...|                    |   Computers|\n+--------------------+--------------------+--------------------+--------------------+------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_1560233873","id":"paragraph_1607705583156_726434386","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:82"},{"text":"%pyspark\nccc.groupby('maincategory').count().sort('count', ascending=False).show()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+\n|maincategory|count|\n+------------+-----+\n|     Society|91861|\n|        Arts|87685|\n|    Business|77658|\n|  Recreation|39940|\n|   Computers|39180|\n|     Science|38795|\n|      Sports|37373|\n|    Shopping|33588|\n|   Reference|21179|\n|      Health|20423|\n|       Games|14221|\n|        Home| 9175|\n|        News| 3428|\n+------------+-----+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_484350634","id":"paragraph_1607705602912_-208986182","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:83"},{"text":"%md\nMyself, I much prefer the SQL variant:","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Myself, I much prefer the SQL variant:</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_167859433","id":"paragraph_1607812599510_-1694101170","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:84"},{"text":"%pyspark\nspark.sql(\"SELECT maincategory, count(maincategory) AS count FROM CatCleanContent GROUP BY maincategory ORDER BY count DESC\").show()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+\n|maincategory|count|\n+------------+-----+\n|     Society|91861|\n|        Arts|87685|\n|    Business|77658|\n|  Recreation|39940|\n|   Computers|39180|\n|     Science|38795|\n|      Sports|37373|\n|    Shopping|33588|\n|   Reference|21179|\n|      Health|20423|\n|       Games|14221|\n|        Home| 9175|\n|        News| 3428|\n+------------+-----+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-355908275","id":"paragraph_1607811411899_489716335","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:85"},{"text":"%md\n## To compress or not to compress?\n\nGetting curious how much the compression would have cost, I decided to read-in and write-out the results compressed; we can then compare a few queries on both representations to get an idea.\nPreliminary impression: you should definitely compress the data, the cost overhead is negligible - clearly, the real timeconsuming operations were the two UDFs.","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>To compress or not to compress?</h2>\n<p>Getting curious how much the compression would have cost, I decided to read-in and write-out the results compressed; we can then compare a few queries on both representations to get an idea.\n<br  />Preliminary impression: you should definitely compress the data, the cost overhead is negligible - clearly, the real timeconsuming operations were the two UDFs.</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_1743865773","id":"paragraph_1607809195521_1411002208","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:86"},{"text":"%pyspark\nccc.write.format(\"parquet\").option(\"compression\",\"snappy\").option(\"path\", \"hdfs:/user/arjen/cccc\").partitionBy(\"maincategory\").bucketBy(12,\"categories\").saveAsTable('CCCC', mode='overwrite')","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_1378499488","id":"paragraph_1607812957987_75520727","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:87"},{"text":"%pyspark\nspark.sql(\"ANALYZE TABLE CCCC COMPUTE STATISTICS\")","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-1715579575","id":"paragraph_1607813153434_1848456492","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:88"},{"text":"%pyspark\ncccc = spark.table(\"CCCC\")","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-1116278876","id":"paragraph_1607809817570_1216423778","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:89"},{"text":"%pyspark\ncccc.show(10)","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+------------+\n|          categories|               title|                 url|     cleaned_content|maincategory|\n+--------------------+--------------------+--------------------+--------------------+------------+\n|Top/Computers/Sof...|    A Real Validator|http://arealvalid...|real validator tr...|   Computers|\n|Top/Computers/Sys...|AROS: Amiga Resea...|http://aros.sourc...|aros research ope...|   Computers|\n|Top/Computers/Sof...|            Homebrew|     http://brew.sh/|homebrew missing ...|   Computers|\n|Top/Computers/Pro...|            SQLiteDB|http://code.jense...|sqlitedb sqlite p...|   Computers|\n|Top/Computers/Pro...|SQL Injection - C...|http://shiflett.o...|sql injection chr...|   Computers|\n|Top/Computers/Sof...|      Alien Software|http://www.aliens...|health network he...|   Computers|\n|Top/Computers/Sof...|United Systems Te...|http://www.asyst3...|home ddrjquery wi...|   Computers|\n|Top/Computers/Rob...|Chicago Area Robo...|http://www.chibot...|chibots < >< cdat...|   Computers|\n|Top/Computers/Sof...|CreativeMac: Core...|http://www.creati...|corel painter ix ...|   Computers|\n|Top/Computers/Mul...|      SoundConverter|http://www.dekort...|                    |   Computers|\n+--------------------+--------------------+--------------------+--------------------+------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-1363419175","id":"paragraph_1607809767244_-47382210","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:90"},{"text":"%pyspark\ncccc.groupby('maincategory').count().sort('count', ascending=False).show()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{"0":{"graph":{"mode":"table","height":354,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+\n|maincategory|count|\n+------------+-----+\n|     Society|91861|\n|        Arts|87685|\n|    Business|77658|\n|  Recreation|39940|\n|   Computers|39180|\n|     Science|38795|\n|      Sports|37373|\n|    Shopping|33588|\n|   Reference|21179|\n|      Health|20423|\n|       Games|14221|\n|        Home| 9175|\n|        News| 3428|\n+------------+-----+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-845763532","id":"paragraph_1607809774204_-2027448054","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:91"},{"text":"%pyspark\ncccc.groupby('categories').count().sort('count', ascending=False).show(10, False)","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------------------------------------------------------------------------------------------------+-----+\n|categories                                                                                                    |count|\n+--------------------------------------------------------------------------------------------------------------+-----+\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/A|759  |\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/C|758  |\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/P|670  |\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/M|641  |\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/S|629  |\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/B|604  |\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/T|406  |\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/H|400  |\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/L|381  |\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/D|378  |\n+--------------------------------------------------------------------------------------------------------------+-----+\nonly showing top 10 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-706113907","id":"paragraph_1607811146087_-109830145","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:92"},{"text":"%pyspark\nspark.sql(\"SELECT maincategory, count(maincategory) AS c FROM CCCC GROUP BY maincategory ORDER BY c DESC\").show(10, False)\nspark.sql(\"SELECT categories, count(categories) as c FROM CCCC GROUP BY categories ORDER BY c DESC LIMIT 50\").show(50, False)","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+\n|maincategory|c    |\n+------------+-----+\n|Society     |91861|\n|Arts        |87685|\n|Business    |77658|\n|Recreation  |39940|\n|Computers   |39180|\n|Science     |38795|\n|Sports      |37373|\n|Shopping    |33588|\n|Reference   |21179|\n|Health      |20423|\n+------------+-----+\nonly showing top 10 rows\n\n+------------------------------------------------------------------------------------------------------------------------------------------------------+---+\n|categories                                                                                                                                            |c  |\n+------------------------------------------------------------------------------------------------------------------------------------------------------+---+\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/A                                        |759|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/C                                        |758|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/P                                        |670|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/M                                        |641|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/S                                        |629|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/B                                        |604|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/T                                        |406|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/H                                        |400|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/L                                        |381|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/D                                        |378|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/G                                        |373|\n|Top/Recreation/Outdoors/Hunting/Guides_and_Outfitters/North_America/United_States/Texas                                                               |353|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/R                                        |345|\n|Top/Sports/Golf/Courses/Europe/United_Kingdom/England                                                                                                 |302|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/E                                        |285|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/F                                        |283|\n|Top/Sports/Golf/Courses/Europe/United_Kingdom/Scotland                                                                                                |268|\n|Top/Business/Energy/Electricity/Cooperatives                                                                                                          |256|\n|Top/Home/Cooking/Weblogs                                                                                                                              |254|\n|Top/Sports/Water_Sports/Swimming_and_Diving/Regional/Europe/United_Kingdom/England                                                                    |245|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/J                                        |233|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/W                                        |223|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/O                                        |211|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/N                                        |208|\n|Top/Arts/Music/Bands_and_Artists/B                                                                                                                    |206|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/V                                        |203|\n|Top/Arts/Music/Bands_and_Artists/M                                                                                                                    |202|\n|Top/Recreation/Food/Drink/Wine/Australia/Victoria                                                                                                     |198|\n|Top/Arts/Music/Bands_and_Artists/C                                                                                                                    |191|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Education/K_through_12/Oceania/Australia/Victoria                        |179|\n|Top/Recreation/Food/Drink/Wine/Australia/South_Australia                                                                                              |178|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/I                                        |172|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Methodist/United_Methodist/Local_Churches/United_States/Texas                        |165|\n|Top/News/Newspapers/Regional/United_States/Texas                                                                                                      |158|\n|Top/Society/Religion_and_Spirituality/Christianity/Denominations/Lutheran/Congregations/Evangelical_Lutheran_Church_in_America/United_States/Minnesota|153|\n|Top/Arts/Music/Bands_and_Artists/L                                                                                                                    |151|\n|Top/Arts/Music/Bands_and_Artists/D                                                                                                                    |148|\n|Top/Society/People/College_Life/Carnegie_Mellon_University/Faculty_and_Staff                                                                          |148|\n|Top/Business/Construction_and_Maintenance/Design/Architects/Multi-Discipline/Europe/United_Kingdom/England                                            |147|\n|Top/Arts/Music/Bands_and_Artists/H                                                                                                                    |144|\n|Top/Arts/Music/Bands_and_Artists/P                                                                                                                    |140|\n|Top/Business/Business_Services/Signage                                                                                                                |138|\n|Top/Arts/Music/Bands_and_Artists/A                                                                                                                    |136|\n|Top/Business/Telecommunications/Two-Way_Radio/Equipment/Dealers/North_America/United_States                                                           |136|\n|Top/Arts/Music/Bands_and_Artists/R                                                                                                                    |136|\n|Top/Recreation/Food/Drink/Wine/Australia/New_South_Wales                                                                                              |136|\n|Top/Sports/Golf/Courses/Europe/Ireland                                                                                                                |134|\n|Top/Business/Arts_and_Entertainment/Media_Production/Video                                                                                            |134|\n|Top/Business/Arts_and_Entertainment/Media_Production/Voice_Talent/Male                                                                                |132|\n|Top/Sports/Running/Clubs/Europe/United_Kingdom/England                                                                                                |132|\n+------------------------------------------------------------------------------------------------------------------------------------------------------+---+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-479174903","id":"paragraph_1607809853522_313763075","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:93"},{"text":"%pyspark\nspark.sql(\"SELECT maincategory, categories, count(categories) as c FROM CCCC WHERE maincategory='Society' GROUP BY maincategory, categories ORDER BY c DESC LIMIT 50\").show(50, False)","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+------------------------------------------------------------------------------------------------------------------------------------------------------+---+\n|maincategory|categories                                                                                                                                            |c  |\n+------------+------------------------------------------------------------------------------------------------------------------------------------------------------+---+\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/A                                        |759|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/C                                        |758|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/P                                        |670|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/M                                        |641|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/S                                        |629|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/B                                        |604|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/T                                        |406|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/H                                        |400|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/L                                        |381|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/D                                        |378|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/G                                        |373|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/R                                        |345|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/E                                        |285|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/F                                        |283|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/J                                        |233|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/W                                        |223|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/O                                        |211|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/N                                        |208|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/V                                        |203|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Education/K_through_12/Oceania/Australia/Victoria                        |179|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/I                                        |172|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Methodist/United_Methodist/Local_Churches/United_States/Texas                        |165|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Lutheran/Congregations/Evangelical_Lutheran_Church_in_America/United_States/Minnesota|153|\n|Society     |Top/Society/People/College_Life/Carnegie_Mellon_University/Faculty_and_Staff                                                                          |148|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Reference/Catholic_Encyclopedia/K                                        |131|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Methodist/United_Methodist/Local_Churches/United_States/Florida                      |129|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Methodist/United_Methodist/Local_Churches/United_States/Georgia                      |129|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Methodist/United_Methodist/Local_Churches/United_States/Michigan                     |124|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Anglican/Anglican_Church_of_Canada/Churches/Ontario                                  |117|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Methodist/United_Methodist/Local_Churches/United_States/California                   |115|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Education/K_through_12/Europe/United_Kingdom/England                     |113|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Dioceses/North_America/United_States                                     |111|\n|Society     |Top/Society/Religion_and_Spirituality/Esoteric_and_Occult/Satanism/Demonolatry/Demons                                                                 |108|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Parishes/North_America/United_States/California                          |107|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Churches_of_Christ/Churches/United_States/Texas                                      |104|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Methodist/United_Methodist/Local_Churches/United_States/Ohio                         |102|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Presbyterian/Presbyterian_Church_USA/Presbyteries                                    |100|\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Parishes/Europe/United_Kingdom/England                                   |99 |\n|Society     |Top/Society/People/Personal_Homepages/S                                                                                                               |98 |\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Methodist/United_Methodist/Local_Churches/United_States/Indiana                      |95 |\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Methodist/United_Methodist/Local_Churches/United_States/Illinois                     |94 |\n|Society     |Top/Society/People/Personal_Homepages/M                                                                                                               |92 |\n|Society     |Top/Society/Philosophy/Reference/Internet_Encyclopedia_of_Philosophy                                                                                  |92 |\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Parishes/North_America/United_States/New_Jersey                          |91 |\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Presbyterian/Presbyterian_Church_USA/Churches/United_States/Pennsylvania             |88 |\n|Society     |Top/Society/People/Personal_Homepages/Weblogs/S                                                                                                       |88 |\n|Society     |Top/Society/People/College_Life/Carnegie_Mellon_University/Graduate_Students                                                                          |86 |\n|Society     |Top/Society/Religion_and_Spirituality/Yoga/Teachers_and_Centers/United_States/California                                                              |85 |\n|Society     |Top/Society/Religion_and_Spirituality/Christianity/Denominations/Catholicism/Parishes/North_America/United_States/Massachusetts                       |85 |\n|Society     |Top/Society/Law/Services/Lawyers_and_Law_Firms/General_Practice/North_America/United_States/Massachusetts                                             |85 |\n+------------+------------------------------------------------------------------------------------------------------------------------------------------------------+---+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-45028969","id":"paragraph_1607812547122_2085336987","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:94"},{"text":"%md\nEn nog een verlaat Sinterklaascadeautje voor Lisa :-)\n\nEr staan nog wat sample queries in het notebook met [uitleg hoe verder te queryen op deze data in HDFS](http://10.192.10.185:8890/#/notebook/2FT255M83).","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>En nog een verlaat Sinterklaascadeautje voor Lisa :-)</p>\n<p>Er staan nog wat sample queries in het notebook met <a href=\"http://10.192.10.185:8890/#/notebook/2FT255M83\">uitleg hoe verder te queryen op deze data in HDFS</a>.</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_950455673","id":"paragraph_1607816545216_-249616480","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:95"},{"text":"%pyspark\nspark.sql(\"SELECT regexp_replace(categories, 'Top/([^/]+)(/[^/]+)?/?.*?$', '$1$2') AS subgroups, count(*) AS c FROM CCCC GROUP BY subgroups ORDER BY c DESC LIMIT 25\").show(25,False)","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{"0":{"graph":{"mode":"table","height":528,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------------------------+-----+\n|subgroups                             |c    |\n+--------------------------------------+-----+\n|Society/Religion_and_Spirituality     |45752|\n|Arts/Music                            |26729|\n|Reference/Education                   |15625|\n|Arts/Movies                           |11888|\n|Computers/Software                    |11835|\n|Science/Biology                       |11174|\n|Games/Video_Games                     |9249 |\n|Arts/Literature                       |9206 |\n|Society/Law                           |8651 |\n|Arts/Performing_Arts                  |7917 |\n|Computers/Internet                    |7832 |\n|Business/Construction_and_Maintenance |7539 |\n|Science/Social_Sciences               |7519 |\n|Computers/Programming                 |7263 |\n|Recreation/Pets                       |7201 |\n|Business/Industrial_Goods_and_Services|7138 |\n|Recreation/Outdoors                   |6718 |\n|Business/Arts_and_Entertainment       |6615 |\n|Business/Business_Services            |6181 |\n|Business/Consumer_Goods_and_Services  |6109 |\n|Arts/Visual_Arts                      |6026 |\n|Sports/Soccer                         |5705 |\n|Society/Issues                        |5670 |\n|Society/People                        |5377 |\n|Business/Textiles_and_Nonwovens       |4908 |\n+--------------------------------------+-----+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-946408241","id":"paragraph_1607815264847_-647838766","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:96"},{"text":"%md\nVerwijderen van categorieen met minder dan 100 pages (van 451 naar 277 labels)","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Verwijderen van categorieen met minder dan 100 pages (van 451 naar 277 labels)</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_1076750015","id":"paragraph_1608232438987_1280839167","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:97"},{"text":"%pyspark\ndfCat2 = spark.sql(\"SELECT regexp_replace(categories, 'Top/([^/]+)(/[^/]+)?/?.*?$', '$1$2') AS subgroups, count(*) AS c FROM CCCC GROUP BY subgroups HAVING COUNT(categories) > 100 ORDER BY c DESC\")\ndfCat2.show()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|           subgroups|    c|\n+--------------------+-----+\n|Society/Religion_...|45752|\n|          Arts/Music|26729|\n| Reference/Education|15625|\n|         Arts/Movies|11888|\n|  Computers/Software|11835|\n|     Science/Biology|11174|\n|   Games/Video_Games| 9249|\n|     Arts/Literature| 9206|\n|         Society/Law| 8651|\n|Arts/Performing_Arts| 7917|\n|  Computers/Internet| 7832|\n|Business/Construc...| 7539|\n|Science/Social_Sc...| 7519|\n|Computers/Program...| 7263|\n|     Recreation/Pets| 7201|\n|Business/Industri...| 7138|\n| Recreation/Outdoors| 6718|\n|Business/Arts_and...| 6615|\n|Business/Business...| 6181|\n|Business/Consumer...| 6109|\n+--------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-542738763","id":"paragraph_1608227692708_1584297442","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:98"},{"text":"%pyspark\ndfCat2 = dfCat2.select(\"subgroups\")","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-2129230004","id":"paragraph_1608228218347_-786557312","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:99"},{"text":"%pyspark\ndfCat2.show()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|           subgroups|\n+--------------------+\n|Society/Religion_...|\n|          Arts/Music|\n| Reference/Education|\n|         Arts/Movies|\n|  Computers/Software|\n|     Science/Biology|\n|   Games/Video_Games|\n|     Arts/Literature|\n|         Society/Law|\n|Arts/Performing_Arts|\n|  Computers/Internet|\n|Business/Construc...|\n|Science/Social_Sc...|\n|Computers/Program...|\n|     Recreation/Pets|\n|Business/Industri...|\n| Recreation/Outdoors|\n|Business/Arts_and...|\n|Business/Business...|\n|Business/Consumer...|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-419620142","id":"paragraph_1608231990402_-414782832","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:100"},{"text":"%pyspark\ndf2 = spark.sql(\"SELECT maincategory,regexp_replace(categories, 'Top/([^/]+)(/[^/]+)?/?.*?$', '$1$2') as categories,title,url,cleaned_content FROM CCCC\")","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_2056923253","id":"paragraph_1608230604656_1124494246","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:101"},{"text":"%pyspark\ndf2.createOrReplaceTempView(\"DF2\")\ndfCat2.createOrReplaceTempView(\"DFCAT2\")","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_1059451863","id":"paragraph_1608231434538_1346543958","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:102"},{"text":"%pyspark\ndf3 = spark.sql(\"SELECT * FROM DFCAT2 c, DF2 e WHERE c.subgroups == e.categories\")\ndf3.show()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+------------+-------------------+--------------------+--------------------+--------------------+\n|          subgroups|maincategory|         categories|               title|                 url|     cleaned_content|\n+-------------------+------------+-------------------+--------------------+--------------------+--------------------+\n|Shopping/Recreation|    Shopping|Shopping/Recreation|FireStar Electric...|http://www.firest...|firestar electric...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|     March Brown Ltd|http://www.marchb...|fly fishing fly r...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|The Craft Pack Co...|http://www.thecra...|craft pack compan...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Antique and Colle...| http://oldguns.net/|antique collectab...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Pillar Scientific...|http://www.pillar...|pillarscientific ...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Cashmere's Collec...|http://www.cashme...|cashmere collecta...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|    A Child at Heart|http://www.achild...|child heart dollh...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Belleville Wholes...|http://www.bellev...|belleville wholes...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|            BRP Inc.|http://www.brprac...|brp radio control...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation| House of Miniatures|http://www.miniwo...|house miniature <...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|  Petit Connoisseurs|http://petitconno...|petit connoisseur...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|Dorsett Publications|http://www.dorset...|scale cabinetmake...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|           Logiblocs|http://www.logibl...|logiblocs functio...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|        Pepper Power|http://www.udap.com/|udap pepper power...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|         Snake Brand|http://www.snakeg...|snake brand fly r...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|  Expresscraft Boats|http://expresscra...|r c boating need ...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|    Wish Upon a Star|http://wish-upona...|name star service...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|      Dee's Darlings|http://www.angelf...|dee darling owner...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|       Rolf Baginski|http://www.bagins...|baginski fly rod ...|\n|Shopping/Recreation|    Shopping|Shopping/Recreation|     Bridget McCarty|http://www.bridge...|home < body { fon...|\n+-------------------+------------+-------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_1709026694","id":"paragraph_1608230623925_1952375267","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:103"},{"text":"%pyspark\ndf2.count()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"514506\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-1689999522","id":"paragraph_1608232050637_284005431","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:104"},{"text":"%pyspark\ndf3.count()","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"509082\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_-1879855985","id":"paragraph_1608232039569_373576980","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:105"},{"text":"%md\nNeeded this info to create the table in the other notebook:","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/text","fontSize":9,"editorHide":true,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Needed this info to create the table in the other notebook:</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015149_152707171","id":"paragraph_1607868765835_-122944139","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:106"},{"text":"%pyspark\nspark.sql(\"describe table CCCC\").show(100,False)","user":"lisa","dateUpdated":"2020-12-30T15:26:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"runOnSelectionChange":true,"title":false,"checkEmpty":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------------+---------+-------+\n|col_name               |data_type|comment|\n+-----------------------+---------+-------+\n|categories             |string   |null   |\n|title                  |string   |null   |\n|url                    |string   |null   |\n|cleaned_content        |string   |null   |\n|maincategory           |string   |null   |\n|# Partition Information|         |       |\n|# col_name             |data_type|comment|\n|maincategory           |string   |null   |\n+-----------------------+---------+-------+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609342015150_1464388270","id":"paragraph_1607816072241_-1925446779","dateCreated":"2020-12-30T15:26:55+0000","status":"READY","$$hashKey":"object:107"}],"name":"Lisa_Thesis1_getWebContent","id":"2FTXHT5DY","defaultInterpreterGroup":"spark","version":"0.9.0-SNAPSHOT","permissions":{"owners":["lisa"]},"noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/Lisa_Thesis1_getWebContent"}