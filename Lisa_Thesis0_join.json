{"paragraphs":[{"text":"%md\n### ODP dataset","user":"lisa","dateUpdated":"2020-12-30T14:30:36+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>ODP dataset</h3>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609338622330_-225144721","id":"paragraph_1609338622330_-225144721","dateCreated":"2020-12-30T14:30:22+0000","dateStarted":"2020-12-30T14:30:34+0000","dateFinished":"2020-12-30T14:30:34+0000","status":"FINISHED","focus":true,"$$hashKey":"object:62"},{"text":"val urls = s\"hdfs:/user/lisa/urls.csv\"\nval dfU = spark.read.option(\"header\",true).option(\"inferSchema\",true).csv(urls)\ndfU.printSchema()\ndfU.createOrReplaceTempView(\"odp\")","user":"lisa","dateUpdated":"2020-12-11T10:46:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _c0: integer (nullable = true)\n |-- maincategory: string (nullable = true)\n |-- categories: string (nullable = true)\n |-- url: string (nullable = true)\n |-- title: string (nullable = true)\n\n\u001b[1m\u001b[34murls\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = hdfs:/user/lisa/urls.csv\n\u001b[1m\u001b[34mdfU\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [_c0: int, maincategory: string ... 3 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607428904617_1126348753","id":"paragraph_1607428904617_1126348753","dateCreated":"2020-12-08T12:01:44+0000","dateStarted":"2020-12-11T10:46:30+0000","dateFinished":"2020-12-11T10:46:31+0000","status":"FINISHED","$$hashKey":"object:63"},{"text":"dfU.createGlobalTempView(\"odp\")","user":"lisa","dateUpdated":"2020-12-11T09:56:50+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607509968668_1310278094","id":"paragraph_1607509968668_1310278094","dateCreated":"2020-12-09T10:32:48+0000","dateStarted":"2020-12-11T09:56:50+0000","dateFinished":"2020-12-11T09:56:50+0000","status":"FINISHED","$$hashKey":"object:64"},{"text":"dfU.count()","user":"lisa","dateUpdated":"2020-12-11T10:46:36+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres18\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1002735\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607509442163_1090922638","id":"paragraph_1607509442163_1090922638","dateCreated":"2020-12-09T10:24:02+0000","dateStarted":"2020-12-11T10:46:36+0000","dateFinished":"2020-12-11T10:46:36+0000","status":"FINISHED","$$hashKey":"object:65"},{"text":"dfU.show()","user":"lisa","dateUpdated":"2020-12-09T10:25:13+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+------------+--------------------+--------------------+--------------------+\n|_c0|maincategory|          categories|                 url|               title|\n+---+------------+--------------------+--------------------+--------------------+\n|  0|        Arts|  Top/Arts/Animation| http://www.awn.com/|Animation World N...|\n|  1|        Arts|  Top/Arts/Animation|http://animation....|About.com: Animat...|\n|  2|        Arts|  Top/Arts/Animation|http://www.toonho...|           Toonhound|\n|  3|        Arts|  Top/Arts/Animation|http://www.digita...|Digital Media FX:...|\n|  4|        Arts|  Top/Arts/Animation|http://www.animat...|Richard's Animate...|\n|  5|        Arts|Top/Arts/Animatio...|http://www.angelf...|Nini's Bishonen D...|\n|  6|        Arts|Top/Arts/Animatio...|http://www.angelf...|Site for Liz's An...|\n|  7|        Arts|Top/Arts/Animatio...|http://valleyofaz...|        Azure Valley|\n|  8|        Arts|Top/Arts/Animatio...|http://www.angelf...|        Neko Central|\n|  9|        Arts|Top/Arts/Animatio...|http://www.angelf...|Chibi Hime's Magi...|\n| 10|        Arts|Top/Arts/Animatio...|http://shotani.ww...|              AniMen|\n| 11|        Arts|Top/Arts/Animatio...|http://www.angelf...|American High Sch...|\n| 12|        Arts|Top/Arts/Animatio...|http://www.nnanim...|No-Name Anime Soc...|\n| 13|        Arts|Top/Arts/Animatio...|http://www.unc.ed...|Carolina Otaku Up...|\n| 14|        Arts|Top/Arts/Animatio...|http://uranime.ne...|University of Ric...|\n| 15|        Arts|Top/Arts/Animatio...|http://carleton.o...|    Anime @ Carleton|\n| 16|        Arts|Top/Arts/Animatio...|http://soap.ottaw...|Society for Ottaw...|\n| 17|        Arts|Top/Arts/Animatio...|http://www.jaco.org/|Japanese Animatio...|\n| 18|        Arts|Top/Arts/Animatio...|http://www.yorku....|York University A...|\n| 19|        Arts|Top/Arts/Animatio...|http://www.emeral...|Emerald Tokyo Ent...|\n+---+------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607509510166_1409643866","id":"paragraph_1607509510166_1409643866","dateCreated":"2020-12-09T10:25:10+0000","dateStarted":"2020-12-09T10:25:13+0000","dateFinished":"2020-12-09T10:25:13+0000","status":"FINISHED","$$hashKey":"object:66"},{"text":"%md\n### Common crawl data","user":"lisa","dateUpdated":"2020-12-30T14:30:18+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Common crawl data</h3>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609338597593_-566714254","id":"paragraph_1609338597593_-566714254","dateCreated":"2020-12-30T14:29:57+0000","dateStarted":"2020-12-30T14:30:13+0000","dateFinished":"2020-12-30T14:30:13+0000","status":"FINISHED","$$hashKey":"object:67"},{"text":"// Setup CC-INDEX Table in Spark SQL to identify a subset to analyze in more detail\nval df = spark.read\n  .option(\"mergeSchema\", \"true\")\n  .option(\"enable.summary-metadata\", \"false\")\n  .option(\"enable.dictionary\", \"true\")\n  .option(\"filterPushdown\", \"true\")\n  .parquet(\"s3://commoncrawl/cc-index/table/cc-main/warc/crawl=CC-MAIN-2017-04/subset=warc/\")\n  .drop(\"url_host_name\",\"url_host_tld\", \"url_host_2nd_last_part\",\"url_host_3rd_last_part\", \"url_host_4th_last_part\", \"url_host_5th_last_part\", \"url_host_registry_suffix\",\"url_host_registered_domain\", \"url_host_private_suffix\", \"url_host_private_domain\", \"url_protocol\", \"url_port\", \"url_path\", \"url_query\", \"fetch_time\", \"fetch_status\", \"content_digest\", \"content_mime_type\", \"content_mime_detected\",\"warc_segment\")\ndf.printSchema()\ndf.createOrReplaceTempView(\"ccindex\")","user":"lisa","dateUpdated":"2020-12-15T17:19:39+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- url_surtkey: string (nullable = true)\n |-- url: string (nullable = true)\n |-- warc_filename: string (nullable = true)\n |-- warc_record_offset: integer (nullable = true)\n |-- warc_record_length: integer (nullable = true)\n\n\u001b[1m\u001b[34mdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [url_surtkey: string, url: string ... 3 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607428956353_1471766066","id":"paragraph_1607428956353_1471766066","dateCreated":"2020-12-08T12:02:36+0000","dateStarted":"2020-12-15T17:19:39+0000","dateFinished":"2020-12-15T17:19:52+0000","status":"FINISHED","$$hashKey":"object:68"},{"text":"df.createGlobalTempView(\"cc\")","user":"lisa","dateUpdated":"2020-12-11T09:57:12+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607509476856_-1946260195","id":"paragraph_1607509476856_-1946260195","dateCreated":"2020-12-09T10:24:36+0000","dateStarted":"2020-12-11T09:57:12+0000","dateFinished":"2020-12-11T09:57:12+0000","status":"FINISHED","$$hashKey":"object:69"},{"text":"df.count()","user":"lisa","dateUpdated":"2020-12-09T10:26:52+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres68\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 3146467312\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607509609193_-1490624423","id":"paragraph_1607509609193_-1490624423","dateCreated":"2020-12-09T10:26:49+0000","dateStarted":"2020-12-09T10:26:52+0000","dateFinished":"2020-12-09T10:27:03+0000","status":"FINISHED","$$hashKey":"object:70"},{"text":"df.show()","user":"lisa","dateUpdated":"2020-12-15T17:19:43+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+------------------+------------------+\n|         url_surtkey|                 url|       warc_filename|warc_record_offset|warc_record_length|\n+--------------------+--------------------+--------------------+------------------+------------------+\n|0,124,148,146)/in...|http://146.148.12...|crawl-data/CC-MAI...|            807983|             16410|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          29703001|              1669|\n|0,186,31,176)/web...|http://176.31.186...|crawl-data/CC-MAI...|            908457|            107704|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          32262713|              1686|\n|       0,19,243,92)/| http://92.243.19.0/|crawl-data/CC-MAI...|           4171705|              3268|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          29311219|              1687|\n|       0,19,243,92)/| http://92.243.19.0/|crawl-data/CC-MAI...|           5026222|              3267|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          34026451|              2177|\n|0,206,122,174)/3y...|http://174.122.20...|crawl-data/CC-MAI...|            704596|            118394|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          29990978|              2134|\n|     0,216,178,107)/|http://107.178.21...|crawl-data/CC-MAI...|            404798|             10933|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          30879323|              2236|\n|0,237,237,192:9000)/|http://192.237.23...|crawl-data/CC-MAI...|            974873|              6811|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          31372853|              1630|\n|0,237,237,192:900...|http://192.237.23...|crawl-data/CC-MAI...|            666154|              9853|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          31395395|              1935|\n|0,237,237,192:900...|http://192.237.23...|crawl-data/CC-MAI...|            986685|             28312|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          29328154|              2263|\n|0,237,237,192:900...|http://192.237.23...|crawl-data/CC-MAI...|            758155|             15987|\n|at,ac,tuwien,ims,...|http://bhutan.ims...|crawl-data/CC-MAI...|          31411191|              2250|\n+--------------------+--------------------+--------------------+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607509615561_1742639612","id":"paragraph_1607509615561_1742639612","dateCreated":"2020-12-09T10:26:55+0000","dateStarted":"2020-12-15T17:19:43+0000","dateFinished":"2020-12-15T17:19:55+0000","status":"FINISHED","$$hashKey":"object:71"},{"text":"%md\n### Execute join","user":"lisa","dateUpdated":"2020-12-30T14:30:53+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Execute join</h3>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609338645108_692822872","id":"paragraph_1609338645108_692822872","dateCreated":"2020-12-30T14:30:45+0000","dateStarted":"2020-12-30T14:30:50+0000","dateFinished":"2020-12-30T14:30:50+0000","status":"FINISHED","$$hashKey":"object:72"},{"text":"%md\nJoin with odp and cc2017-04 resulting in 575,745 matches\n","user":"lisa","dateUpdated":"2020-12-30T14:36:11+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Join with odp and cc2017-04 resulting in 575,745 matches</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609338942607_34777280","id":"paragraph_1609338942607_34777280","dateCreated":"2020-12-30T14:35:42+0000","dateStarted":"2020-12-30T14:36:09+0000","dateFinished":"2020-12-30T14:36:09+0000","status":"FINISHED","$$hashKey":"object:73"},{"text":"val joinDF = spark.sql(\"SELECT maincategory, categories, title, c.url, warc_filename, warc_record_offset, warc_record_length \"+\n                    \"FROM global_temp.odp o INNER JOIN global_temp.cc c WHERE o.url == c.url\").cache()","user":"lisa","dateUpdated":"2020-12-11T10:46:55+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mjoinDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [maincategory: string, categories: string ... 5 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607428995584_-66857811","id":"paragraph_1607428995584_-66857811","dateCreated":"2020-12-08T12:03:15+0000","dateStarted":"2020-12-11T10:46:55+0000","dateFinished":"2020-12-11T10:46:55+0000","status":"FINISHED","$$hashKey":"object:74"},{"text":"// Write to filesystem\njoinDF.write.format(\"csv\").option(\"header\",true).mode(\"overwrite\").option(\"sep\", \",\").save(s\"hdfs:/user/lisa/joinDataset.csv\")","user":"lisa","dateUpdated":"2020-12-30T14:32:01+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607429001169_-2143184442","id":"paragraph_1607429001169_-2143184442","dateCreated":"2020-12-08T12:03:21+0000","dateStarted":"2020-12-09T11:44:22+0000","dateFinished":"2020-12-09T12:08:00+0000","status":"FINISHED","$$hashKey":"object:75"},{"text":"joinDF.explain(extended=true)","user":"lisa","dateUpdated":"2020-12-09T11:44:25+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Parsed Logical Plan ==\n'Project ['maincategory, 'categories, 'title, 'c.url, 'warc_filename, 'warc_record_offset, 'warc_record_length]\n+- 'Filter ('o.url = 'c.url)\n   +- 'Join Inner\n      :- 'SubqueryAlias `o`\n      :  +- 'UnresolvedRelation `global_temp`.`odp`\n      +- 'SubqueryAlias `c`\n         +- 'UnresolvedRelation `global_temp`.`cc`\n\n== Analyzed Logical Plan ==\nmaincategory: string, categories: string, title: string, url: string, warc_filename: string, warc_record_offset: int, warc_record_length: int\nProject [maincategory#4273, categories#4274, title#4276, url#4445, warc_filename#4465, warc_record_offset#4466, warc_record_length#4467]\n+- Filter (url#4275 = url#4445)\n   +- Join Inner\n      :- SubqueryAlias `o`\n      :  +- SubqueryAlias `global_temp`.`odp`\n      :     +- Relation[_c0#4272,maincategory#4273,categories#4274,url#4275,title#4276] csv\n      +- SubqueryAlias `c`\n         +- SubqueryAlias `global_temp`.`cc`\n            +- Project [url#4445, warc_filename#4465, warc_record_offset#4466, warc_record_length#4467]\n               +- Relation[url_surtkey#4444,url#4445,url_host_name#4446,url_host_tld#4447,url_host_2nd_last_part#4448,url_host_3rd_last_part#4449,url_host_4th_last_part#4450,url_host_5th_last_part#4451,url_host_registry_suffix#4452,url_host_registered_domain#4453,url_host_private_suffix#4454,url_host_private_domain#4455,url_protocol#4456,url_port#4457,url_path#4458,url_query#4459,fetch_time#4460,fetch_status#4461,content_digest#4462,content_mime_type#4463,content_mime_detected#4464,warc_filename#4465,warc_record_offset#4466,warc_record_length#4467,warc_segment#4468] parquet\n\n== Optimized Logical Plan ==\nInMemoryRelation [maincategory#4273, categories#4274, title#4276, url#4445, warc_filename#4465, warc_record_offset#4466, warc_record_length#4467], StorageLevel(disk, memory, deserialized, 1 replicas)\n   +- *(5) Project [maincategory#4273, categories#4274, title#4276, url#4445, warc_filename#4465, warc_record_offset#4466, warc_record_length#4467]\n      +- *(5) SortMergeJoin [url#4275], [url#4445], Inner\n         :- *(2) Sort [url#4275 ASC NULLS FIRST], false, 0\n         :  +- Exchange hashpartitioning(url#4275, 200)\n         :     +- *(1) Project [maincategory#4273, categories#4274, url#4275, title#4276]\n         :        +- *(1) Filter isnotnull(url#4275)\n         :           +- *(1) FileScan csv [maincategory#4273,categories#4274,url#4275,title#4276] Batched: false, Format: CSV, Location: InMemoryFileIndex[hdfs://ip-10-192-10-185.ec2.internal:8020/user/lisa/urls.csv], PartitionFilters: [], PushedFilters: [IsNotNull(url)], ReadSchema: struct<maincategory:string,categories:string,url:string,title:string>\n         +- *(4) Sort [url#4445 ASC NULLS FIRST], false, 0\n            +- Exchange hashpartitioning(url#4445, 200)\n               +- *(3) Project [url#4445, warc_filename#4465, warc_record_offset#4466, warc_record_length#4467]\n                  +- *(3) Filter isnotnull(url#4445)\n                     +- *(3) FileScan parquet [url#4445,warc_filename#4465,warc_record_offset#4466,warc_record_length#4467] Batched: true, Format: Parquet, Location: InMemoryFileIndex[s3://commoncrawl/cc-index/table/cc-main/warc/crawl=CC-MAIN-2017-04/subset=warc], PartitionFilters: [], PushedFilters: [IsNotNull(url)], ReadSchema: struct<url:string,warc_filename:string,warc_record_offset:int,warc_record_length:int>\n\n== Physical Plan ==\nInMemoryTableScan [maincategory#4273, categories#4274, title#4276, url#4445, warc_filename#4465, warc_record_offset#4466, warc_record_length#4467]\n   +- InMemoryRelation [maincategory#4273, categories#4274, title#4276, url#4445, warc_filename#4465, warc_record_offset#4466, warc_record_length#4467], StorageLevel(disk, memory, deserialized, 1 replicas)\n         +- *(5) Project [maincategory#4273, categories#4274, title#4276, url#4445, warc_filename#4465, warc_record_offset#4466, warc_record_length#4467]\n            +- *(5) SortMergeJoin [url#4275], [url#4445], Inner\n               :- *(2) Sort [url#4275 ASC NULLS FIRST], false, 0\n               :  +- Exchange hashpartitioning(url#4275, 200)\n               :     +- *(1) Project [maincategory#4273, categories#4274, url#4275, title#4276]\n               :        +- *(1) Filter isnotnull(url#4275)\n               :           +- *(1) FileScan csv [maincategory#4273,categories#4274,url#4275,title#4276] Batched: false, Format: CSV, Location: InMemoryFileIndex[hdfs://ip-10-192-10-185.ec2.internal:8020/user/lisa/urls.csv], PartitionFilters: [], PushedFilters: [IsNotNull(url)], ReadSchema: struct<maincategory:string,categories:string,url:string,title:string>\n               +- *(4) Sort [url#4445 ASC NULLS FIRST], false, 0\n                  +- Exchange hashpartitioning(url#4445, 200)\n                     +- *(3) Project [url#4445, warc_filename#4465, warc_record_offset#4466, warc_record_length#4467]\n                        +- *(3) Filter isnotnull(url#4445)\n                           +- *(3) FileScan parquet [url#4445,warc_filename#4465,warc_record_offset#4466,warc_record_length#4467] Batched: true, Format: Parquet, Location: InMemoryFileIndex[s3://commoncrawl/cc-index/table/cc-main/warc/crawl=CC-MAIN-2017-04/subset=warc], PartitionFilters: [], PushedFilters: [IsNotNull(url)], ReadSchema: struct<url:string,warc_filename:string,warc_record_offset:int,warc_record_length:int>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607429011343_1065495843","id":"paragraph_1607429011343_1065495843","dateCreated":"2020-12-08T12:03:31+0000","dateStarted":"2020-12-09T11:44:25+0000","dateFinished":"2020-12-09T12:08:00+0000","status":"FINISHED","$$hashKey":"object:76"},{"text":"joinDF.count()","user":"lisa","dateUpdated":"2020-12-09T11:44:28+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres83\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 575745\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607429025533_-752037244","id":"paragraph_1607429025533_-752037244","dateCreated":"2020-12-08T12:03:45+0000","dateStarted":"2020-12-09T12:08:00+0000","dateFinished":"2020-12-09T12:08:01+0000","status":"FINISHED","$$hashKey":"object:77"},{"text":"import org.apache.spark.sql.functions.countDistinct\n\n// Amount of distinct urls\njoinDF.select(countDistinct(\"url\")).show()","user":"lisa","dateUpdated":"2020-12-30T14:33:56+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|count(DISTINCT url)|\n+-------------------+\n|             438445|\n+-------------------+\n\nimport org.apache.spark.sql.functions.countDistinct\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607684575924_-1972411359","id":"paragraph_1607684575924_-1972411359","dateCreated":"2020-12-11T11:02:55+0000","dateStarted":"2020-12-11T11:03:04+0000","dateFinished":"2020-12-11T11:03:04+0000","status":"FINISHED","$$hashKey":"object:78"},{"text":"joinDF.show()","user":"lisa","dateUpdated":"2020-12-09T11:44:33+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|maincategory|          categories|               title|                 url|       warc_filename|warc_record_offset|warc_record_length|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|     Society|Top/Society/Histo...|23rd North Caroli...|http://6thnjvol.h...|crawl-data/CC-MAI...|           3222345|              4853|\n|     Science|Top/Science/Math/...|            AAECC-16|http://aaecc.free...|crawl-data/CC-MAI...|           4593198|              1257|\n|    Business|Top/Business/Publ...|Association of Ar...|http://aaronline....|crawl-data/CC-MAI...|           4338583|             10668|\n|    Business|Top/Business/Publ...|Association of Ar...|http://aaronline....|crawl-data/CC-MAI...|           5852612|             10668|\n|      Sports|Top/Sports/Events...|ABC News: Summer ...|http://abcnews.go...|crawl-data/CC-MAI...|           5520785|             12465|\n|     Society|Top/Society/Relig...|Addyston Baptist ...|http://addystonba...|crawl-data/CC-MAI...|           7364793|              5939|\n|     Society|Top/Society/Relig...|Addyston Baptist ...|http://addystonba...|crawl-data/CC-MAI...|           5870186|              5939|\n|   Reference|Top/Reference/Edu...|  Administrators.Net|http://administra...|crawl-data/CC-MAI...|           7269974|             10457|\n|        Arts|Top/Arts/Literatu...|Akilan: Tamil aut...|http://akilan6.tr...|crawl-data/CC-MAI...|           7480160|             10037|\n|     Society|Top/Society/Histo...|  Schom, Alan Morris|http://alanschom....|crawl-data/CC-MAI...|           7851843|              2701|\n|      Health|Top/Health/Medici...|Alaska Regional H...|http://alaskaregi...|crawl-data/CC-MAI...|           8750178|             33807|\n|  Recreation|Top/Recreation/Fo...|       Ed's Ale Haus|http://alehaus.ed...|crawl-data/CC-MAI...|           9170278|              2313|\n|        Arts|Top/Arts/Movies/T...|Allreaders Review...|http://allreaders...|crawl-data/CC-MAI...|          10948176|             26290|\n|        Arts|Top/Arts/Movies/T...|Allreaders Review...|http://allreaders...|crawl-data/CC-MAI...|          11443671|             26203|\n|        Home|Top/Home/Cooking/...|   Becca's Taco Soup|http://allrecipes...|crawl-data/CC-MAI...|          10859696|             40971|\n|        Home|Top/Home/Cooking/...|   Becca's Taco Soup|http://allrecipes...|crawl-data/CC-MAI...|          10946621|             40998|\n|        Arts|Top/Arts/Music/St...|  Yale Alumni Chorus|http://alumninet....|crawl-data/CC-MAI...|          13147296|              4608|\n|     Society|Top/Society/Peopl...|      Atiya, Amir F.|http://alumnus.ca...|crawl-data/CC-MAI...|          12263990|              3331|\n|    Business|Top/Business/Ener...|Ammini Energy Sys...|  http://ammini.com/|crawl-data/CC-MAI...|          13760990|              3530|\n|    Shopping|Top/Shopping/Publ...|American Hospital...|http://ams.aha.or...|crawl-data/CC-MAI...|          12412826|             13867|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607429166434_-1056883460","id":"paragraph_1607429166434_-1056883460","dateCreated":"2020-12-08T12:06:06+0000","dateStarted":"2020-12-09T12:08:01+0000","dateFinished":"2020-12-09T12:08:01+0000","status":"FINISHED","$$hashKey":"object:79"},{"text":"%md\nJoin with odp and cc2017-04 on url_surtkey only retrieves 166,207 matches, so not useful","user":"lisa","dateUpdated":"2020-12-30T14:33:27+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Join with odp and cc2017-04 on url_surtkey only retrieves 166,207 matches, so not useful</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607682284575_1239374375","id":"paragraph_1607682284575_1239374375","dateCreated":"2020-12-11T10:24:44+0000","dateStarted":"2020-12-30T14:33:27+0000","dateFinished":"2020-12-30T14:33:27+0000","status":"FINISHED","$$hashKey":"object:80"},{"text":"val urls = s\"hdfs:/user/lisa/N_urls.csv\"\nval dfUN = spark.read.option(\"header\",true).option(\"inferSchema\",true).csv(urls)\ndfUN.printSchema()","user":"lisa","dateUpdated":"2020-12-11T10:25:47+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _c0: integer (nullable = true)\n |-- maincategory: string (nullable = true)\n |-- categories: string (nullable = true)\n |-- url: string (nullable = true)\n |-- title: string (nullable = true)\n |-- url_normalized: string (nullable = true)\n\n\u001b[1m\u001b[34murls\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = hdfs:/user/lisa/N_urls.csv\n\u001b[1m\u001b[34mdfUN\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [_c0: int, maincategory: string ... 4 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607682310480_340353331","id":"paragraph_1607682310480_340353331","dateCreated":"2020-12-11T10:25:10+0000","dateStarted":"2020-12-11T10:25:47+0000","dateFinished":"2020-12-11T10:25:50+0000","status":"FINISHED","$$hashKey":"object:81"},{"text":"dfUN.show()","user":"lisa","dateUpdated":"2020-12-11T10:25:49+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+------------+--------------------+--------------------+--------------------+--------------------+\n|_c0|maincategory|          categories|                 url|               title|      url_normalized|\n+---+------------+--------------------+--------------------+--------------------+--------------------+\n|  0|        Arts|  Top/Arts/Animation| http://www.awn.com/|Animation World N...|            com,awn)|\n|  1|        Arts|  Top/Arts/Animation|http://animation....|About.com: Animat...|com,about,animation)|\n|  2|        Arts|  Top/Arts/Animation|http://www.toonho...|           Toonhound|      com,toonhound)|\n|  3|        Arts|  Top/Arts/Animation|http://www.digita...|Digital Media FX:...|com,digitalmediaf...|\n|  4|        Arts|  Top/Arts/Animation|http://www.animat...|Richard's Animate...|net,animated-divots)|\n|  5|        Arts|Top/Arts/Animatio...|http://www.angelf...|Nini's Bishonen D...|com,angelfire)/an...|\n|  6|        Arts|Top/Arts/Animatio...|http://www.angelf...|Site for Liz's An...|com,angelfire)/an...|\n|  7|        Arts|Top/Arts/Animatio...|http://valleyofaz...|        Azure Valley|com,tripod,valley...|\n|  8|        Arts|Top/Arts/Animatio...|http://www.angelf...|        Neko Central|com,angelfire)/nv...|\n|  9|        Arts|Top/Arts/Animatio...|http://www.angelf...|Chibi Hime's Magi...|com,angelfire)/gr...|\n| 10|        Arts|Top/Arts/Animatio...|http://shotani.ww...|              AniMen|com,50megs,www2,s...|\n| 11|        Arts|Top/Arts/Animatio...|http://www.angelf...|American High Sch...|com,angelfire)/yt...|\n| 12|        Arts|Top/Arts/Animatio...|http://www.nnanim...|No-Name Anime Soc...|        com,nnanime)|\n| 13|        Arts|Top/Arts/Animatio...|http://www.unc.ed...|Carolina Otaku Up...|       edu,unc)/coup|\n| 14|        Arts|Top/Arts/Animatio...|http://uranime.ne...|University of Ric...|net,nekomusume,ur...|\n| 15|        Arts|Top/Arts/Animatio...|http://carleton.o...|    Anime @ Carleton|org,ottawa-anime,...|\n| 16|        Arts|Top/Arts/Animatio...|http://soap.ottaw...|Society for Ottaw...|org,ottawa-anime,...|\n| 17|        Arts|Top/Arts/Animatio...|http://www.jaco.org/|Japanese Animatio...|           org,jaco)|\n| 18|        Arts|Top/Arts/Animatio...|http://www.yorku....|York University A...|     ca,yorku)/anime|\n| 19|        Arts|Top/Arts/Animatio...|http://www.emeral...|Emerald Tokyo Ent...|   com,emeraldtokyo)|\n+---+------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607682343669_251983895","id":"paragraph_1607682343669_251983895","dateCreated":"2020-12-11T10:25:43+0000","dateStarted":"2020-12-11T10:25:49+0000","dateFinished":"2020-12-11T10:25:50+0000","status":"FINISHED","$$hashKey":"object:82"},{"text":"dfUN.createGlobalTempView(\"odpN\")","user":"lisa","dateUpdated":"2020-12-11T10:26:44+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607682375298_2088250607","id":"paragraph_1607682375298_2088250607","dateCreated":"2020-12-11T10:26:15+0000","dateStarted":"2020-12-11T10:26:44+0000","dateFinished":"2020-12-11T10:26:44+0000","status":"FINISHED","$$hashKey":"object:83"},{"text":"val joinDFNormalized = spark.sql(\"SELECT maincategory, categories, title, o.url, o.url_normalized, warc_filename, warc_record_offset, warc_record_length \"+\n                    \"FROM global_temp.odpN o INNER JOIN global_temp.cc c WHERE o.url_normalized == c.url_surtkey\").cache()","user":"lisa","dateUpdated":"2020-12-11T10:29:59+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mjoinDFNormalized\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [maincategory: string, categories: string ... 6 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607682411539_1938158226","id":"paragraph_1607682411539_1938158226","dateCreated":"2020-12-11T10:26:51+0000","dateStarted":"2020-12-11T10:29:59+0000","dateFinished":"2020-12-11T10:30:00+0000","status":"FINISHED","$$hashKey":"object:84"},{"text":"joinDFNormalized.count()","user":"lisa","dateUpdated":"2020-12-11T10:30:12+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres15\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 166207\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607682585758_3343095","id":"paragraph_1607682585758_3343095","dateCreated":"2020-12-11T10:29:45+0000","dateStarted":"2020-12-11T10:30:12+0000","dateFinished":"2020-12-11T10:40:59+0000","status":"FINISHED","$$hashKey":"object:85"},{"text":"joinDFNormalized.show()","user":"lisa","dateUpdated":"2020-12-11T10:30:14+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|maincategory|          categories|               title|                 url|      url_normalized|       warc_filename|warc_record_offset|warc_record_length|\n+------------+--------------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|        Arts|Top/Arts/Crafts/K...|Aussie Jean's Toy...|http://home.alpha...|au,com,alphalink,...|crawl-data/CC-MAI...|         130516145|              1877|\n|   Computers|Top/Computers/Spe...|      Express Scribe|http://www.nch.co...|au,com,nch)/scrib...|crawl-data/CC-MAI...|         618773902|              6835|\n|   Computers|Top/Computers/Spe...|      Express Scribe|http://www.nch.co...|au,com,nch)/scrib...|crawl-data/CC-MAI...|         206595392|              6865|\n|     Society|Top/Society/Histo...|Bellum Vobiscum -...|http://www.skarbe...|  au,com,skarbek)/bv|crawl-data/CC-MAI...|         677946756|              2823|\n|     Science|Top/Science/Socia...|Australian Pidgin...|http://www.anu.ed...|au,edu,anu)/lingu...|crawl-data/CC-MAI...|         339562450|             10025|\n|        Arts|Top/Arts/Literatu...|  Gone With The Wind|http://gutenberg....|au,net,gutenberg)...|crawl-data/CC-MAI...|         128318410|            402553|\n|     Science|Top/Science/Physi...|Gravitational Lenses|http://vela.astro...|be,ac,ulg,astro,v...|crawl-data/CC-MAI...|         289854079|              2859|\n|     Society|Top/Society/Peopl...|       Doomen, Peter|http://users.skyn...|be,skynet,users)/...|crawl-data/CC-MAI...|         300879072|               865|\n|    Business|Top/Business/Arts...|             Prompt!|http://www.moviec...|biz,movieclip)/pr...|crawl-data/CC-MAI...|         589875693|             12216|\n|      Health|Top/Health/Condit...|Definition - Deme...|http://penta.ufrg...|br,ufrgs,penta)/e...|crawl-data/CC-MAI...|         218042319|              1594|\n|     Science|Top/Science/Socia...|Bibliography of M...|http://plato.acad...|ca,acadiau,plato)...|crawl-data/CC-MAI...|         228121838|              2947|\n|     Science|Top/Science/Socia...|Bibliography of M...|http://plato.acad...|ca,acadiau,plato)...|crawl-data/CC-MAI...|         228121838|              2947|\n|        Arts|Top/Arts/Animatio...|Matthew Skala's R...|http://ansuz.sook...|ca,bc,sooke,ansuz...|crawl-data/CC-MAI...|          17217895|              1526|\n|        Arts|Top/Arts/Televisi...|            CBC News|http://www.cbc.ca...|        ca,cbc)/news|crawl-data/CC-MAI...|         394150829|             30605|\n|        News|            Top/News|            CBC News|http://www.cbc.ca...|        ca,cbc)/news|crawl-data/CC-MAI...|         394150829|             30605|\n|        News|Top/News/Breaking...|            CBC News|http://www.cbc.ca...|        ca,cbc)/news|crawl-data/CC-MAI...|         394150829|             30605|\n|        News|Top/News/Journali...|Kootnikoff, Lawrence|http://mypage.dir...|ca,direct,mypage)...|crawl-data/CC-MAI...|         198656106|              4172|\n|   Reference|Top/Reference/Edu...|Durham College Co...|http://www.durham...|ca,durhamcollege)...|crawl-data/CC-MAI...|         438548885|             12608|\n|      Health|Top/Health/Medici...|KT Clearinghouse:...|http://ktclearing...|ca,ktclearinghous...|crawl-data/CC-MAI...|         159042984|              8784|\n|      Health|Top/Health/Medici...|KT Clearinghouse:...|http://ktclearing...|ca,ktclearinghous...|crawl-data/CC-MAI...|         159736763|              8782|\n+------------+--------------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607682605837_764405296","id":"paragraph_1607682605837_764405296","dateCreated":"2020-12-11T10:30:05+0000","dateStarted":"2020-12-11T10:30:14+0000","dateFinished":"2020-12-11T10:40:59+0000","status":"FINISHED","$$hashKey":"object:86"},{"text":"%md\nJoin with odp and cc2017-13 resulting in 589,022 matches","user":"lisa","dateUpdated":"2020-12-30T14:34:26+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Join with odp and cc2017-13 resulting in 589,022 matches</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607682219052_-1079405237","id":"paragraph_1607682219052_-1079405237","dateCreated":"2020-12-11T10:23:39+0000","dateStarted":"2020-12-30T14:34:24+0000","dateFinished":"2020-12-30T14:34:24+0000","status":"FINISHED","$$hashKey":"object:87"},{"text":"// Setup CC-INDEX Table in Spark SQL to identify a subset to analyze in more detail\nval dfCC = spark.read\n  .option(\"mergeSchema\", \"true\")\n  .option(\"enable.summary-metadata\", \"false\")\n  .option(\"enable.dictionary\", \"true\")\n  .option(\"filterPushdown\", \"true\")\n  .parquet(\"s3://commoncrawl/cc-index/table/cc-main/warc/crawl=CC-MAIN-2017-13/subset=warc/\")\n  .drop(\"url_surtkey\",\"url_host_name\",\"url_host_tld\", \"url_host_2nd_last_part\",\"url_host_3rd_last_part\", \"url_host_4th_last_part\", \"url_host_5th_last_part\", \"url_host_registry_suffix\",\"url_host_registered_domain\", \"url_host_private_suffix\", \"url_host_private_domain\", \"url_protocol\", \"url_port\", \"url_path\", \"url_query\", \"fetch_time\", \"fetch_status\", \"content_digest\", \"content_mime_type\", \"content_mime_detected\",\"warc_segment\")\ndfCC.printSchema()","user":"lisa","dateUpdated":"2020-12-11T09:57:57+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- url: string (nullable = true)\n |-- warc_filename: string (nullable = true)\n |-- warc_record_offset: integer (nullable = true)\n |-- warc_record_length: integer (nullable = true)\n\n\u001b[1m\u001b[34mdfCC\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [url: string, warc_filename: string ... 2 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607512139369_1799930503","id":"paragraph_1607512139369_1799930503","dateCreated":"2020-12-09T11:08:59+0000","dateStarted":"2020-12-11T09:57:57+0000","dateFinished":"2020-12-11T09:57:59+0000","status":"FINISHED","$$hashKey":"object:88"},{"text":"dfCC.createGlobalTempView(\"cc2017\")","user":"lisa","dateUpdated":"2020-12-11T09:58:02+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607512142556_1507743359","id":"paragraph_1607512142556_1507743359","dateCreated":"2020-12-09T11:09:02+0000","dateStarted":"2020-12-11T09:58:02+0000","dateFinished":"2020-12-11T09:58:02+0000","status":"FINISHED","$$hashKey":"object:89"},{"text":"dfCC.count()","user":"lisa","dateUpdated":"2020-12-09T23:29:41+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres93\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 3070663610\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607512143797_1982145547","id":"paragraph_1607512143797_1982145547","dateCreated":"2020-12-09T11:09:03+0000","dateStarted":"2020-12-09T23:29:41+0000","dateFinished":"2020-12-09T23:29:50+0000","status":"FINISHED","$$hashKey":"object:90"},{"text":"val joinDF2017 = spark.sql(\"SELECT maincategory, categories, title, c.url, warc_filename, warc_record_offset, warc_record_length \"+\n                    \"FROM global_temp.odp o INNER JOIN global_temp.cc2017 c WHERE o.url == c.url\").cache()","user":"lisa","dateUpdated":"2020-12-11T09:58:10+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mjoinDF2017\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [maincategory: string, categories: string ... 5 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607512205984_-314948272","id":"paragraph_1607512205984_-314948272","dateCreated":"2020-12-09T11:10:05+0000","dateStarted":"2020-12-11T09:58:10+0000","dateFinished":"2020-12-11T09:58:10+0000","status":"FINISHED","$$hashKey":"object:91"},{"text":"joinDF2017.count()","user":"lisa","dateUpdated":"2020-12-11T09:58:22+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres9\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 589022\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607512213937_-1236990706","id":"paragraph_1607512213937_-1236990706","dateCreated":"2020-12-09T11:10:13+0000","dateStarted":"2020-12-11T09:58:22+0000","dateFinished":"2020-12-11T10:14:27+0000","status":"FINISHED","$$hashKey":"object:92"},{"text":"import org.apache.spark.sql.functions.countDistinct\n\njoinDF2017.select(countDistinct(\"url\")).show()","user":"lisa","dateUpdated":"2020-12-11T11:02:16+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|count(DISTINCT url)|\n+-------------------+\n|             400307|\n+-------------------+\n\nimport org.apache.spark.sql.functions.countDistinct\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607684527332_534580780","id":"paragraph_1607684527332_534580780","dateCreated":"2020-12-11T11:02:07+0000","dateStarted":"2020-12-11T11:02:16+0000","dateFinished":"2020-12-11T11:02:17+0000","status":"FINISHED","$$hashKey":"object:93"},{"text":"joinDF2017.show()","user":"lisa","dateUpdated":"2020-12-11T09:58:43+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|maincategory|          categories|               title|                 url|       warc_filename|warc_record_offset|warc_record_length|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|     Science|Top/Science/Math/...|            AAECC-16|http://aaecc.free...|crawl-data/CC-MAI...|           4837764|              1261|\n|    Business|Top/Business/Publ...|Association of Ar...|http://aaronline....|crawl-data/CC-MAI...|           4196817|             10776|\n|      Sports|Top/Sports/Events...|ABC News: Summer ...|http://abcnews.go...|crawl-data/CC-MAI...|           5628016|             12688|\n|      Sports|Top/Sports/Events...|ABC News: Summer ...|http://abcnews.go...|crawl-data/CC-MAI...|           4814331|             12678|\n|        Arts|Top/Arts/Literatu...|                Miwu|http://absurdism....|crawl-data/CC-MAI...|           7158904|              1311|\n|     Society|Top/Society/Relig...|Addyston Baptist ...|http://addystonba...|crawl-data/CC-MAI...|           8342299|              5940|\n|        Arts|Top/Arts/Literatu...|Akilan: Tamil aut...|http://akilan6.tr...|crawl-data/CC-MAI...|          12857033|              8263|\n|      Health|Top/Health/Medici...|Alaska Regional H...|http://alaskaregi...|crawl-data/CC-MAI...|          12771101|             34545|\n|        Arts|Top/Arts/Literatu...|The Astrid Lindgr...|http://alassociat...|crawl-data/CC-MAI...|          14449004|              6733|\n|  Recreation|Top/Recreation/Ou...|      Albany Hunting|http://albanytexa...|crawl-data/CC-MAI...|          14461904|             10473|\n|      Sports|Top/Sports/Cricke...|Aldenham Cricket ...|http://aldenhamcr...|crawl-data/CC-MAI...|          13344353|             23321|\n|      Health|Top/Health/Altern...|    Aligned Coaching|http://alignedcoa...|crawl-data/CC-MAI...|          12401431|              2896|\n|        Arts|Top/Arts/Movies/T...|AllReaders.com Re...|http://allreaders...|crawl-data/CC-MAI...|          14999392|             24538|\n|        Arts|Top/Arts/Movies/T...|Allreaders.com: S...|http://allreaders...|crawl-data/CC-MAI...|          12973935|             24429|\n|        Arts|Top/Arts/Movies/T...|Allreaders.com: T...|http://allreaders...|crawl-data/CC-MAI...|          11683455|             25374|\n|        Home|Top/Home/Cooking/...|   Becca's Taco Soup|http://allrecipes...|crawl-data/CC-MAI...|          12114187|             43072|\n|        Home|Top/Home/Cooking/...|   Becca's Taco Soup|http://allrecipes...|crawl-data/CC-MAI...|          13376395|             41232|\n|     Society|Top/Society/Organ...|Alpha Xi Delta - ...|http://alphaxidel...|crawl-data/CC-MAI...|          12194361|             13223|\n|     Society|Top/Society/Peopl...|      Atiya, Amir F.|http://alumnus.ca...|crawl-data/CC-MAI...|          14908102|              3331|\n|     Society|Top/Society/Peopl...|      Atiya, Amir F.|http://alumnus.ca...|crawl-data/CC-MAI...|          15888123|              3331|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607512215121_-219566969","id":"paragraph_1607512215121_-219566969","dateCreated":"2020-12-09T11:10:15+0000","dateStarted":"2020-12-11T09:58:43+0000","dateFinished":"2020-12-11T10:14:27+0000","status":"FINISHED","$$hashKey":"object:94"},{"text":"joinDF2017.write.format(\"csv\").option(\"header\",true).mode(\"overwrite\").option(\"sep\", \",\").save(s\"hdfs:/user/lisa/join2017Dataset.csv\")","user":"lisa","dateUpdated":"2020-12-11T09:58:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607525759220_-500031169","id":"paragraph_1607525759220_-500031169","dateCreated":"2020-12-09T14:55:59+0000","dateStarted":"2020-12-11T10:14:27+0000","dateFinished":"2020-12-11T10:14:30+0000","status":"FINISHED","$$hashKey":"object:95"},{"text":"%md\nUnion of joinDF and joinDF2017 to create a bigger dataset","user":"lisa","dateUpdated":"2020-12-30T14:34:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","runOnSelectionChange":true,"title":false,"checkEmpty":true,"editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Union of joinDF and joinDF2017 to create a bigger dataset</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607557948439_1802497829","id":"paragraph_1607557948439_1802497829","dateCreated":"2020-12-09T23:52:28+0000","dateStarted":"2020-12-30T14:34:50+0000","dateFinished":"2020-12-30T14:34:50+0000","status":"FINISHED","$$hashKey":"object:96"},{"text":"val joinDFunion = joinDF.union(joinDF2017)","user":"lisa","dateUpdated":"2020-12-11T10:47:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mjoinDFunion\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [maincategory: string, categories: string ... 5 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607683478808_-636111402","id":"paragraph_1607683478808_-636111402","dateCreated":"2020-12-11T10:44:38+0000","dateStarted":"2020-12-11T10:47:16+0000","dateFinished":"2020-12-11T10:47:16+0000","status":"FINISHED","$$hashKey":"object:97"},{"text":"joinDFunion.count()","user":"lisa","dateUpdated":"2020-12-11T10:47:19+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres20\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1164767\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607683518086_-2073249554","id":"paragraph_1607683518086_-2073249554","dateCreated":"2020-12-11T10:45:18+0000","dateStarted":"2020-12-11T10:47:19+0000","dateFinished":"2020-12-11T10:58:29+0000","status":"FINISHED","$$hashKey":"object:98"},{"text":"val join = joinDFunion.distinct()","user":"lisa","dateUpdated":"2020-12-11T10:52:18+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mjoin\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [maincategory: string, categories: string ... 5 more fields]\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607683518976_1986063298","id":"paragraph_1607683518976_1986063298","dateCreated":"2020-12-11T10:45:18+0000","dateStarted":"2020-12-11T10:52:18+0000","dateFinished":"2020-12-11T10:58:30+0000","status":"FINISHED","$$hashKey":"object:99"},{"text":"join.count()","user":"lisa","dateUpdated":"2020-12-11T10:52:19+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mres21\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 1164767\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607683519959_427436976","id":"paragraph_1607683519959_427436976","dateCreated":"2020-12-11T10:45:19+0000","dateStarted":"2020-12-11T10:58:30+0000","dateFinished":"2020-12-11T10:58:33+0000","status":"FINISHED","$$hashKey":"object:100"},{"text":"join.show()","user":"lisa","dateUpdated":"2020-12-11T10:52:21+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|maincategory|          categories|               title|                 url|       warc_filename|warc_record_offset|warc_record_length|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|     Society|Top/Society/Gover...|   Günther Oettinger|http://ec.europa....|crawl-data/CC-MAI...|          82259257|             11754|\n|    Business|Top/Business/Tran...|     The Subway Page|http://people.ree...|crawl-data/CC-MAI...|         224825804|             37773|\n|   Reference|Top/Reference/Mus...|The Adirondack Mu...|http://www.adkmus...|crawl-data/CC-MAI...|         325316307|              5265|\n|        Arts|Top/Arts/Organiza...|               BRBAC|http://www.brbac....|crawl-data/CC-MAI...|         383341805|              3930|\n|     Society|Top/Society/Peopl...|     Cowboy Showcase|http://www.cowboy...|crawl-data/CC-MAI...|         398945061|             18366|\n|  Recreation|Top/Recreation/Pe...|Dallas Koi Kichi ...|http://www.dallas...|crawl-data/CC-MAI...|         406011973|              4925|\n|     Society|Top/Society/Relig...| Diocese of Scranton|http://www.dioces...|crawl-data/CC-MAI...|         433616700|              8858|\n|        Arts|Top/Arts/Literatu...|Astrocartography ...|http://www.domina...|crawl-data/CC-MAI...|         417113219|              5305|\n|      Sports|Top/Sports/Soccer...|ESPN FC: Brechin ...|http://www.espnfc...|crawl-data/CC-MAI...|         444526907|             12314|\n|    Shopping|Top/Shopping/Gift...|The Gallery Colle...|http://www.galler...|crawl-data/CC-MAI...|         480731953|             21755|\n|    Shopping|Top/Shopping/Gift...|The Gallery Colle...|http://www.galler...|crawl-data/CC-MAI...|         475621931|             21771|\n|    Shopping|Top/Shopping/Trav...|       Luggage Works|http://www.luggag...|crawl-data/CC-MAI...|         561437519|             13136|\n|    Shopping|Top/Shopping/Food...|    Mayorga Organics|http://www.mayorg...|crawl-data/CC-MAI...|         575902185|             11132|\n|   Computers|Top/Computers/Int...| Origami Studio, LLC|http://www.origam...|crawl-data/CC-MAI...|         611355925|               867|\n|  Recreation|Top/Recreation/Av...|Axis Paragliding ...|http://www.paragl...|crawl-data/CC-MAI...|         615088897|             11557|\n|     Society|Top/Society/Law/S...|       Anthony Brady|http://www.probat...|crawl-data/CC-MAI...|         648638589|              7864|\n|     Society|Top/Society/Genea...|ROOTS-L Resources...|http://www.rootsw...|crawl-data/CC-MAI...|         660739345|              2760|\n|    Business|Top/Business/Publ...|Sherwood Digital ...|http://www.sherwo...|crawl-data/CC-MAI...|         658961522|             18394|\n|     Society|Top/Society/Subcu...|Steampunk Fashion...|http://www.steamp...|crawl-data/CC-MAI...|         697278194|             19751|\n|      Health|Top/Health/Beauty...|International Ins...|http://www.studyh...|crawl-data/CC-MAI...|         690630841|             11085|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607683932551_550489621","id":"paragraph_1607683932551_550489621","dateCreated":"2020-12-11T10:52:12+0000","dateStarted":"2020-12-11T10:58:30+0000","dateFinished":"2020-12-11T10:58:35+0000","status":"FINISHED","$$hashKey":"object:101"},{"text":"import org.apache.spark.sql.functions.countDistinct\n\nval join2 = join.select(countDistinct(\"url\")).show()","user":"lisa","dateUpdated":"2020-12-11T11:01:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|count(DISTINCT url)|\n+-------------------+\n|             514506|\n+-------------------+\n\nimport org.apache.spark.sql.functions.countDistinct\n\u001b[1m\u001b[34mjoin2\u001b[0m: \u001b[1m\u001b[32mUnit\u001b[0m = ()\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607683941210_-1344143757","id":"paragraph_1607683941210_-1344143757","dateCreated":"2020-12-11T10:52:21+0000","dateStarted":"2020-12-11T11:01:28+0000","dateFinished":"2020-12-11T11:01:31+0000","status":"FINISHED","$$hashKey":"object:102"},{"text":"join2.show()","user":"lisa","dateUpdated":"2020-12-11T11:01:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|count(DISTINCT url)|\n+-------------------+\n|             514506|\n+-------------------+\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607684448421_400746498","id":"paragraph_1607684448421_400746498","dateCreated":"2020-12-11T11:00:48+0000","dateStarted":"2020-12-11T11:01:01+0000","dateFinished":"2020-12-11T11:01:05+0000","status":"FINISHED","$$hashKey":"object:103"},{"text":"val dropped = join.dropDuplicates(\"url\")\ndropped.count()","user":"lisa","dateUpdated":"2020-12-11T11:05:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\u001b[1m\u001b[34mdropped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [maincategory: string, categories: string ... 5 more fields]\n\u001b[1m\u001b[34mres27\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 514506\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607684461829_86544152","id":"paragraph_1607684461829_86544152","dateCreated":"2020-12-11T11:01:01+0000","dateStarted":"2020-12-11T11:05:01+0000","dateFinished":"2020-12-11T11:05:05+0000","status":"FINISHED","$$hashKey":"object:104"},{"text":"%md \nWrite final dataset to filesystem","user":"lisa","dateUpdated":"2020-12-30T14:36:52+0000","config":{"runOnSelectionChange":true,"title":false,"checkEmpty":true,"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Write final dataset to filesystem</p>\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1609339001437_-756545466","id":"paragraph_1609339001437_-756545466","dateCreated":"2020-12-30T14:36:41+0000","dateStarted":"2020-12-30T14:36:50+0000","dateFinished":"2020-12-30T14:36:50+0000","status":"FINISHED","$$hashKey":"object:105"},{"text":"dropped.write.format(\"csv\").option(\"header\",true).mode(\"overwrite\").option(\"sep\", \",\").save(s\"hdfs:/user/lisa/join.csv\")","user":"lisa","dateUpdated":"2020-12-11T11:05:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607684701844_1644024479","id":"paragraph_1607684701844_1644024479","dateCreated":"2020-12-11T11:05:01+0000","dateStarted":"2020-12-11T11:05:41+0000","dateFinished":"2020-12-11T11:05:47+0000","status":"FINISHED","$$hashKey":"object:106"},{"text":"dropped.show()","user":"lisa","dateUpdated":"2020-12-15T17:28:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":511.9,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","runOnSelectionChange":true,"title":false,"checkEmpty":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|maincategory|          categories|               title|                 url|       warc_filename|warc_record_offset|warc_record_length|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\n|     Society|Top/Society/Histo...|23rd North Caroli...|http://6thnjvol.h...|crawl-data/CC-MAI...|           3222345|              4853|\n|     Science|Top/Science/Math/...|            AAECC-16|http://aaecc.free...|crawl-data/CC-MAI...|           4593198|              1257|\n|    Business|Top/Business/Publ...|Association of Ar...|http://aaronline....|crawl-data/CC-MAI...|           4196817|             10776|\n|      Sports|Top/Sports/Events...|ABC News: Summer ...|http://abcnews.go...|crawl-data/CC-MAI...|           5520785|             12465|\n|        Arts|Top/Arts/Literatu...|                Miwu|http://absurdism....|crawl-data/CC-MAI...|           7158904|              1311|\n|     Society|Top/Society/Relig...|Addyston Baptist ...|http://addystonba...|crawl-data/CC-MAI...|           8342299|              5940|\n|   Reference|Top/Reference/Edu...|  Administrators.Net|http://administra...|crawl-data/CC-MAI...|           7269974|             10457|\n|        Arts|Top/Arts/Literatu...|Akilan: Tamil aut...|http://akilan6.tr...|crawl-data/CC-MAI...|          12857033|              8263|\n|     Society|Top/Society/Histo...|  Schom, Alan Morris|http://alanschom....|crawl-data/CC-MAI...|           7851843|              2701|\n|      Health|Top/Health/Medici...|Alaska Regional H...|http://alaskaregi...|crawl-data/CC-MAI...|           8750178|             33807|\n|        Arts|Top/Arts/Literatu...|The Astrid Lindgr...|http://alassociat...|crawl-data/CC-MAI...|          14449004|              6733|\n|  Recreation|Top/Recreation/Ou...|      Albany Hunting|http://albanytexa...|crawl-data/CC-MAI...|          14461904|             10473|\n|      Sports|Top/Sports/Cricke...|Aldenham Cricket ...|http://aldenhamcr...|crawl-data/CC-MAI...|          13344353|             23321|\n|  Recreation|Top/Recreation/Fo...|       Ed's Ale Haus|http://alehaus.ed...|crawl-data/CC-MAI...|           9170278|              2313|\n|      Health|Top/Health/Altern...|    Aligned Coaching|http://alignedcoa...|crawl-data/CC-MAI...|          12401431|              2896|\n|        Arts|Top/Arts/Movies/T...|Allreaders Review...|http://allreaders...|crawl-data/CC-MAI...|          10948176|             26290|\n|        Arts|Top/Arts/Movies/T...|Allreaders Review...|http://allreaders...|crawl-data/CC-MAI...|          11443671|             26203|\n|        Arts|Top/Arts/Movies/T...|AllReaders.com Re...|http://allreaders...|crawl-data/CC-MAI...|          14999392|             24538|\n|        Arts|Top/Arts/Movies/T...|Allreaders.com: S...|http://allreaders...|crawl-data/CC-MAI...|          12973935|             24429|\n|        Arts|Top/Arts/Movies/T...|Allreaders.com: T...|http://allreaders...|crawl-data/CC-MAI...|          11683455|             25374|\n+------------+--------------------+--------------------+--------------------+--------------------+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607684741430_-1994868813","id":"paragraph_1607684741430_-1994868813","dateCreated":"2020-12-11T11:05:41+0000","dateStarted":"2020-12-11T13:30:11+0000","dateFinished":"2020-12-11T13:30:14+0000","status":"FINISHED","$$hashKey":"object:107"},{"user":"lisa","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1607693411649_-1237859045","id":"paragraph_1607693411649_-1237859045","dateCreated":"2020-12-11T13:30:11+0000","status":"READY","$$hashKey":"object:108"}],"name":"Lisa_Thesis0_join","id":"2FSNBMRVP","defaultInterpreterGroup":"spark","version":"0.9.0-SNAPSHOT","permissions":{"owners":["lisa"]},"noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/Lisa_Thesis0_join"}